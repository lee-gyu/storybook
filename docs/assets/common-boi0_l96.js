import{a as O,F as Ot,j as ue}from"./jsx-runtime-KzWSGvcx.js";import{r as Ae}from"./index-DogsOklH.js";import{_ as L,g as fe}from"./timePicker.elements-Q0xqtR9Q.js";import{I as sn}from"./select-ye26dHUk.js";import{I as ln}from"./datePicker-zU491wOI.js";import{h as an,_ as Be,w as cn,d as un,k as hn,x as dn,C as fn,l as B,f as gn,o as De,i as st,e as Ke,r as $e,v as mn,y as pn,D as Cn,K as _n,Q as wn,S as Wt,c as bn,X as Rn,Y as yn,$ as vn,a0 as Sn,a1 as xn,a2 as En,a3 as In,a4 as Mn,a5 as Tn,a6 as Ln,a7 as kn,a8 as Hn,a9 as zn}from"./index-DkI8zks2.js";import{C as An}from"./clipboard-NFyc1dad.js";import{v as Pt,g as lt,a as On,b as Wn,f as Pn,s as Fn,I as Bn}from"./index--oTrqKKK.js";import{c as Ie}from"./dom-fI5bczoz.js";function D(o,e,t){return o<e?e:o>t?t:o}function Dn(o){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>e(n.result),n.onerror=()=>t(n.error),n.readAsText(o)})}const jn=3.4,Gn=.65;class Vn{constructor(){this.isInit=!1,this.context=null,this.cacheMap=new Map,this.curFontSize="",this.curFontFamily=""}init(){this.isInit||(this.isInit=!0,this.context=document.createElement("canvas").getContext("2d"))}getContext(){if(this.init(),!this.context)throw new Error("Can't create canvas context");return this.context}setFontStyle(e,t){(this.curFontSize!==e||this.curFontFamily!==t)&&(this.getContext().font=`${e} ${t}`,this.curFontSize=e,this.curFontFamily=t)}getCacheKey(e){return`${this.curFontSize}_${this.curFontFamily}_${e}`}_calculate(e){const t=e.replace(/ /g,""),n=e.length-t.length,r=t.replace(/\d/g,""),i=t.length-r.length,s=parseInt(this.curFontSize,10)*Gn;return Number.isNaN(s)&&console.error(`ir-style text calculation occurred a NaN. fontSize: ${this.curFontSize}, fontFamily: ${this.curFontFamily}`),Math.ceil(this.getContext().measureText(r).width+n*jn+i*s)}calculateWidth(e){const t=this.getCacheKey(e);let n=this.cacheMap.get(t);return n===void 0&&(n=this._calculate(e),this.cacheMap.set(t,n)),n}}let _e=null;function Nn(o,e){return _e||(_e=new Vn),_e.setFontStyle(o,e),_e}function*Kn(o,e){for(let t=0;t<o;++t)for(let n=0;n<e;++n)yield{y:t,x:n}}function he(o){return o instanceof HTMLElement}var Ue=function(o,e){return Ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},Ue(o,e)};function se(o,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ue(o,e);function t(){this.constructor=o}o.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Ye(o){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&o[e],n=0;if(t)return t.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&n>=o.length&&(o=void 0),{value:o&&o[n++],done:!o}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Me(o,e){var t=typeof Symbol=="function"&&o[Symbol.iterator];if(!t)return o;var n=t.call(o),r,i=[],s;try{for(;(e===void 0||e-- >0)&&!(r=n.next()).done;)i.push(r.value)}catch(a){s={error:a}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(s)throw s.error}}return i}function Te(o,e,t){if(t||arguments.length===2)for(var n=0,r=e.length,i;n<r;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return o.concat(i||Array.prototype.slice.call(e))}function Y(o){return typeof o=="function"}function Ft(o){var e=function(n){Error.call(n),n.stack=new Error().stack},t=o(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var je=Ft(function(o){return function(t){o(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,r){return r+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function Xe(o,e){if(o){var t=o.indexOf(e);0<=t&&o.splice(t,1)}}var Oe=function(){function o(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return o.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=Ye(s),u=a.next();!u.done;u=a.next()){var c=u.value;c.remove(this)}}catch(d){e={error:d}}finally{try{u&&!u.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else s.remove(this);var l=this.initialTeardown;if(Y(l))try{l()}catch(d){i=d instanceof je?d.errors:[d]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var f=Ye(h),R=f.next();!R.done;R=f.next()){var T=R.value;try{at(T)}catch(d){i=i!=null?i:[],d instanceof je?i=Te(Te([],Me(i)),Me(d.errors)):i.push(d)}}}catch(d){n={error:d}}finally{try{R&&!R.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}}if(i)throw new je(i)}},o.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)at(e);else{if(e instanceof o){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},o.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},o.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},o.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Xe(t,e)},o.prototype.remove=function(e){var t=this._finalizers;t&&Xe(t,e),e instanceof o&&e._removeParent(this)},o.EMPTY=function(){var e=new o;return e.closed=!0,e}(),o}(),Bt=Oe.EMPTY;function Dt(o){return o instanceof Oe||o&&"closed"in o&&Y(o.remove)&&Y(o.add)&&Y(o.unsubscribe)}function at(o){Y(o)?o():o.unsubscribe()}var jt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},qe={setTimeout:function(o,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var r=qe.delegate;return r!=null&&r.setTimeout?r.setTimeout.apply(r,Te([o,e],Me(t))):setTimeout.apply(void 0,Te([o,e],Me(t)))},clearTimeout:function(o){var e=qe.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(o)},delegate:void 0};function $n(o){qe.setTimeout(function(){throw o})}function ct(){}function xe(o){o()}var et=function(o){se(e,o);function e(t){var n=o.call(this)||this;return n.isStopped=!1,t?(n.destination=t,Dt(t)&&t.add(n)):n.destination=qn,n}return e.create=function(t,n,r){return new Ze(t,n,r)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,o.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Oe),Un=Function.prototype.bind;function Ge(o,e){return Un.call(o,e)}var Yn=function(){function o(e){this.partialObserver=e}return o.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){we(n)}},o.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){we(n)}else we(e)},o.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){we(t)}},o}(),Ze=function(o){se(e,o);function e(t,n,r){var i=o.call(this)||this,s;if(Y(t)||!t)s={next:t!=null?t:void 0,error:n!=null?n:void 0,complete:r!=null?r:void 0};else{var a;i&&jt.useDeprecatedNextContext?(a=Object.create(t),a.unsubscribe=function(){return i.unsubscribe()},s={next:t.next&&Ge(t.next,a),error:t.error&&Ge(t.error,a),complete:t.complete&&Ge(t.complete,a)}):s=t}return i.destination=new Yn(s),i}return e}(et);function we(o){$n(o)}function Xn(o){throw o}var qn={closed:!0,next:ct,error:Xn,complete:ct},Zn=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Jn(o){return o}function Qn(o){return o.length===0?Jn:o.length===1?o[0]:function(t){return o.reduce(function(n,r){return r(n)},t)}}var ut=function(){function o(e){e&&(this._subscribe=e)}return o.prototype.lift=function(e){var t=new o;return t.source=this,t.operator=e,t},o.prototype.subscribe=function(e,t,n){var r=this,i=to(e)?e:new Ze(e,t,n);return xe(function(){var s=r,a=s.operator,u=s.source;i.add(a?a.call(i,u):u?r._subscribe(i):r._trySubscribe(i))}),i},o.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},o.prototype.forEach=function(e,t){var n=this;return t=ht(t),new t(function(r,i){var s=new Ze({next:function(a){try{e(a)}catch(u){i(u),s.unsubscribe()}},error:i,complete:r});n.subscribe(s)})},o.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},o.prototype[Zn]=function(){return this},o.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Qn(e)(this)},o.prototype.toPromise=function(e){var t=this;return e=ht(e),new e(function(n,r){var i;t.subscribe(function(s){return i=s},function(s){return r(s)},function(){return n(i)})})},o.create=function(e){return new o(e)},o}();function ht(o){var e;return(e=o!=null?o:jt.Promise)!==null&&e!==void 0?e:Promise}function eo(o){return o&&Y(o.next)&&Y(o.error)&&Y(o.complete)}function to(o){return o&&o instanceof et||eo(o)&&Dt(o)}function no(o){return Y(o==null?void 0:o.lift)}function Gt(o){return function(e){if(no(e))return e.lift(function(t){try{return o(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function Vt(o,e,t,n,r){return new oo(o,e,t,n,r)}var oo=function(o){se(e,o);function e(t,n,r,i,s,a){var u=o.call(this,t)||this;return u.onFinalize=s,u.shouldUnsubscribe=a,u._next=n?function(c){try{n(c)}catch(l){t.error(l)}}:o.prototype._next,u._error=i?function(c){try{i(c)}catch(l){t.error(l)}finally{this.unsubscribe()}}:o.prototype._error,u._complete=r?function(){try{r()}catch(c){t.error(c)}finally{this.unsubscribe()}}:o.prototype._complete,u}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;o.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(et),ro=Ft(function(o){return function(){o(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Nt=function(o){se(e,o);function e(){var t=o.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var n=new dt(this,this);return n.operator=t,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new ro},e.prototype.next=function(t){var n=this;xe(function(){var r,i;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var s=Ye(n.currentObservers),a=s.next();!a.done;a=s.next()){var u=a.value;u.next(t)}}catch(c){r={error:c}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}})},e.prototype.error=function(t){var n=this;xe(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var r=n.observers;r.length;)r.shift().error(t)}})},e.prototype.complete=function(){var t=this;xe(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),o.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var n=this,r=this,i=r.hasError,s=r.isStopped,a=r.observers;return i||s?Bt:(this.currentObservers=null,a.push(t),new Oe(function(){n.currentObservers=null,Xe(a,t)}))},e.prototype._checkFinalizedStatuses=function(t){var n=this,r=n.hasError,i=n.thrownError,s=n.isStopped;r?t.error(i):s&&t.complete()},e.prototype.asObservable=function(){var t=new ut;return t.source=this,t},e.create=function(t,n){return new dt(t,n)},e}(ut),dt=function(o){se(e,o);function e(t,n){var r=o.call(this)||this;return r.destination=t,r.source=n,r}return e.prototype.next=function(t){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,t)},e.prototype.error=function(t){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,t)},e.prototype.complete=function(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)},e.prototype._subscribe=function(t){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&r!==void 0?r:Bt},e}(Nt),io=function(o){se(e,o);function e(t){var n=o.call(this)||this;return n._value=t,n}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var n=o.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},e.prototype.getValue=function(){var t=this,n=t.hasError,r=t.thrownError,i=t._value;if(n)throw r;return this._throwIfClosed(),i},e.prototype.next=function(t){o.prototype.next.call(this,this._value=t)},e}(Nt);function Ve(o,e){return Gt(function(t,n){var r=0;t.subscribe(Vt(n,function(i){n.next(o.call(e,i,r++))}))})}function so(){return Gt(function(o,e){var t,n=!1;o.subscribe(Vt(e,function(r){var i=t;t=r,n&&e.next([i,r]),n=!0}))})}class tt{constructor(e,t){this._subscriptionList=[],this._state=new io(e),this._pipe=t?t(this._state):this._state,this._value=e,this._pipe.pipe(so()).subscribe(([n,r])=>{this._value=r,this._subscriptionList.forEach(i=>{try{i(n,r)}catch(s){console.error("ReactiveState Subscription Error",this.constructor.name,s)}})})}addSubscription(e){this._subscriptionList.push(e)}removeSubscription(e){const t=this._subscriptionList.indexOf(e);t>=0?this._subscriptionList.splice(t,1):console.warn("ReactiveState.removeSubscription: subscriber not found")}next(e){this._state.next(e)}get value(){return this._value}}class ge{constructor(e,...t){this._label=e,this._commands=t}pushCommand(e){this._commands.push(e)}execute(){const e=[];try{let t=0;for(;t<this._commands.length;){const n=this._commands[t];if(!n.canExecute)throw console.error(n),new Error("Can't execute this command");n.execute(),e.push(n),++t}}catch(t){return console.error("execute error!",t),e.reverse().forEach(n=>n.undo()),!1}return!0}undo(){const e=[];try{let t=this._commands.length-1;for(;t>=0;){const n=this._commands[t];if(!n.canUndo)throw console.error(n),new Error("Can't undo this command");n.undo(),e.push(n),--t}}catch(t){return console.error("undo error!",t),e.forEach(n=>n.execute()),!1}return!0}get label(){return this._label}}const lo=1024;class ao{constructor({context:e,undoStackLength:t=lo,disabled:n=!1}){this._isPreventedUIRecording=!0,this._undoCommandStack=[],this._redoCommandStack=[],this._stackLength=t,this._disabled=n,this._context=e}doRecording(e="",t){if(this.isDisabled)return t();if(this.isRecording)throw new Error("Already doing record!");try{return this._currentRecordingBlock=new ge(e),t(),this.pushCommandBlock(this._currentRecordingBlock),this._currentRecordingBlock}catch(n){console.error("Got an error during recording!"),console.error(n)}finally{this._currentRecordingBlock=void 0}}undo(){const e=this._undoCommandStack.pop();e&&e.undo()&&(this._redoCommandStack.push(e),this._context.onUndo(e))}redo(){const e=this._redoCommandStack.pop();e&&e.execute()&&(this._undoCommandStack.push(e),this._context.onRedo(e))}pushCommandBlock(e){this.isDisabled||(this._undoCommandStack.length>=this._stackLength&&this._undoCommandStack.shift(),this._undoCommandStack.push(e),this._redoCommandStack=[])}pushCommand(e){if(!this._currentRecordingBlock)throw new Error("Not recording!");this._currentRecordingBlock.pushCommand(e)}clearCommands(){this._undoCommandStack=[],this._redoCommandStack=[]}pauseUIRecording(){this._isPreventedUIRecording=!1}startUIRecording(){this._isPreventedUIRecording=!0}get canRecord(){return!this.isDisabled&&this.isRecording&&!this.isPreventedUIRecording}get isRecording(){return this._currentRecordingBlock!==void 0}get isPreventedUIRecording(){return this._isPreventedUIRecording}get isDisabled(){return this._disabled}get stackLength(){return this._stackLength}set stackLength(e){this._stackLength=e}set isDisabled(e){this._disabled=e}}function co(o){var e=o.match(/^var\((.*)\)$/);return e?e[1]:o}function uo(o,e){var t=o;for(var n of e){if(!(n in t))throw new Error("Path ".concat(e.join(" -> ")," does not exist in object"));t=t[n]}return t}function Kt(o,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],n=o.constructor();for(var r in o){var i=o[r],s=[...t,r];typeof i=="string"||typeof i=="number"||i==null?n[r]=e(i,s):typeof i=="object"&&!Array.isArray(i)?n[r]=Kt(i,e,s):console.warn('Skipping invalid key "'.concat(s.join("."),'". Should be a string, number, null or object. Received: "').concat(Array.isArray(i)?"Array":typeof i,'"'))}return n}function ft(o,e,t){o.style.setProperty(co(e),t)}function Z(o,e,t){if(typeof t=="object"){var n=e;Kt(t,(s,a)=>{ft(o,uo(n,a),String(s))})}else{var r=e;for(var i in r)ft(o,i,r[i])}}function gt(o,e,t){return $t(o,t)&&Ut(e,t)}function Je(o){const e=parseInt(o.getAttribute("data-row")||"-1"),t=parseInt(o.getAttribute("data-col")||"-1");if(e===-1||t===-1)throw new Error("Invalid cell");return{row:e,col:t}}function $t(o,e){return o>=e.top&&o<=e.bottom}function Ut(o,e){return o>=e.left&&o<=e.right}function be(o,e,t){t?o.classList.add(e):o.classList.remove(e)}function ho(o){let e=o.firstChild,t=0;for(;e;){let n=e.firstChild;for(;n;)t=Math.max(n.offsetHeight,t),n=n.nextSibling;e=e.nextSibling}return t}function fo(o){let e=o.target,t=o.offsetX,n=o.offsetY;for(;e!==o.currentTarget;){if(!(e instanceof HTMLElement))throw new Error("invalid event target!");if(e.tagName==="TR")break;t+=e.offsetLeft,n+=e.offsetTop,e=e.parentElement}return{x:t,y:n}}const go=20,mo=5;class Qe{render(e,t,n){throw new Error("Not implemented")}getHorizontalCellPadding(e){var t,n;return((t=e.paddingLeft)!==null&&t!==void 0?t:e.getGridStore().cellPadding.left)+((n=e.paddingRight)!==null&&n!==void 0?n:e.getGridStore().cellPadding.right)}getCellInnerWidth(e,t,n){var r,i;const s=Nn(e,t),a=[n.icon,n.sortOrder].reduce((l,h)=>h?l+1:l,0)*(go+mo),u=`${(r=n.text)!==null&&r!==void 0?r:""}`.split(`
`),c=a+s.calculateWidth((i=u[0])!==null&&i!==void 0?i:"");return this.getHorizontalCellPadding(n)+L(u).drop(1).reduce((l,h)=>Math.max(l,s.calculateWidth(h)),c)}getRendererInnerWidth(e,t,n){return 0}getCellInnerHeight(e,t){var n,r;const i=t.getGridStore(),s=(n=t.paddingTop)!==null&&n!==void 0?n:i.cellPadding.top,a=(r=t.paddingBottom)!==null&&r!==void 0?r:i.cellPadding.bottom;return s+a+ho(e)}get renderType(){return"unknown"}get editable(){return!0}}class po{constructor(e,t){this._args=t,this._instance=e,this._undoContext=this._getUndoContext()}_getUndoContext(){throw new Error("Not implemented")}_execute(){throw new Error("Not implemented")}_undo(){throw new Error("Not implemented")}get canUndo(){throw new Error("Not implemented")}get canExecute(){throw new Error("Not implemented")}execute(){if(!this.canExecute)throw new Error("Can't execute command");this._execute(),this.onExecute()}undo(){if(!this.canUndo)throw new Error("Can't undo command");this._undo(),this.onUndo()}onUndo(){}onExecute(){}}class N extends po{}class Yt extends N{_execute(){this._instance.setCell(...this._args)}_getUndoContext(){const[e,t,n]=this._args;return{beforeValue:L.pick(this._instance.getCell(e,t),Object.keys(n))}}_undo(){this._instance.setCell(this._args[0],this._args[1],this._undoContext.beforeValue)}get canExecute(){return this._instance.cell(this._args[0],this._args[1])!==void 0}get canUndo(){return this._instance.cell(this._args[0],this._args[1])!==void 0}}function Co(o){const e=document.createElement("div");if(e.className=an,o.sortOrder!==void 0){const t=o.sortOrder==="ASC"?"sort-ascending":"sort-descending",n=document.createElement("i");n.className=`ir-icon ir-icon--${t}`,e.appendChild(n)}if(o.icon){const t=document.createElement("i");t.classList.add("ir-icon",`ir-icon--${o.icon}`),o.iconColor&&t.style.setProperty("--ir-icon-foreground-color",o.iconColor),e.appendChild(t)}if(o.text){const t=document.createElement("span");t.innerText=o.text,e.appendChild(t)}return e}class Xt extends Qe{render(e,t,n){return Co(n)}get renderType(){return"default"}}const mt=new WeakMap;class _o extends Xt{constructor(e){super(),this.render=e.bind(this)}get renderType(){return"custom"}}function wo(o){const e=mt.get(o);if(e)return e;const t=new _o(o);return mt.set(o,t),t}function bo(o,e){function t(i,s){if(s.length===0)throw new Error("No pasting data.");const a=Object.assign({},i),u=s.length,c=s[0].length,l=a.top+u,h=a.left+c;for(let f=i.bottom+1;f<l;++f)(o.hasRow(f)||o.onAutoInsertRow(f))&&(a.bottom=f);for(let f=i.right+1;f<h;++f)(o.hasColumn(f)||o.onAutoInsertColumn(f))&&(a.right=f);return a}function n(i,s){if(s.length===0)throw new Error("No pasting data.");const a=s.length,u=s[0].length,c=[],l=i.bottom-i.top+1,h=i.right-i.left+1;function f(R,T){const[d,w]=[R%a,T%u];return s[d][w]}for(const{y:R,x:T}of Kn(l,h)){const[d,w]=[R+i.top,T+i.left];if(!o.hasRow(d)&&o.onAutoInsertRow(d)&&o.addRow(),!o.hasColumn(w)&&o.onAutoInsertColumn(w)&&o.addColumn(),!o.hasRow(d)||!o.hasColumn(w))continue;const H=o.cell(d,w),b=f(R,T);b.cellVisible&&o.onCheckPasteCell(H,b.text)&&c.push({cell:H,cellMetaInfo:{text:b.text,cellVisible:b.cellVisible,rowSpan:e.rowSpan?b.rowSpan:1,colSpan:e.colSpan?b.colSpan:1,isFormatted:!1}})}return c}function r(i){for(const{cell:s,cellMetaInfo:a}of i){const{rowSpan:u,colSpan:c,cellVisible:l}=a;if(!l)continue;const{row:h,col:f}=s;if(u>1||c>1){const T={top:h,left:f,bottom:h+u-1,right:f+c-1};o.mergeCells(T.top,T.left,T.bottom,T.right)}o.setCell(h,f,{text:a.text}),o.onClipboardAfterPasteCell(s)}}return{getPastingRange:t,beforePastingList:n,pasteTask:r}}function Ro(o){return JSON.stringify(o)}function yo(o){return JSON.parse(o)}function vo(o){const e=new Document,t=e.createElement("table");return o.forEach(n=>{const r=e.createElement("tr");n.filter(i=>i.cellVisible).forEach(i=>{const s=e.createElement("td");s.textContent=i.text,s.setAttribute("rowSpan",`${i.rowSpan}`),s.setAttribute("colSpan",`${i.colSpan}`),r.appendChild(s)}),t.appendChild(r)}),e.appendChild(t),e.documentElement.outerHTML}function So(o){const n=new DOMParser().parseFromString(o,"text/html").querySelectorAll("tr");if(n.length===0)return console.warn("No tr element in clipboard data"),[];const r=Array(n.length).fill(void 0).map(()=>[]);function i(u,c,l,h){for(let f=u;f<u+l;++f)for(let R=c;R<c+h;++R)r[f][R]={text:"",rowSpan:1,colSpan:1,cellVisible:!1,isFormatted:!1}}function s(u){let c=u;for(;r[a][c]!==void 0;)++c;return c}let a=0;for(const u of n){const c=u.querySelectorAll("td");let l=s(0);for(const h of c)(h.rowSpan>1||h.colSpan>1)&&i(a,l,h.rowSpan,h.colSpan),r[a][l]={text:h.innerText,rowSpan:h.rowSpan,colSpan:h.colSpan,cellVisible:!0,isFormatted:h.hasAttribute("class")},l=s(l);++a}return r}function xo(o){if(o.length===0)return!0;const e=o[0].length;return o.every(t=>t.length===e)}const qt="	",Zt=`
`;function Eo(o){if(!xo(o))throw new Error("Wrong text matrix dimension");return o.map(e=>e.map(({text:t})=>t).join(qt)).join(Zt)}function Io(o){if(o.length===0)return[];const e=[],t=[],n=[];function r(){n.push({text:t.join(""),rowSpan:1,colSpan:1,cellVisible:!0,isFormatted:!1}),t.length=0}function i(){var s;r(),(e.length===0||n.length===((s=e[0])===null||s===void 0?void 0:s.length))&&e.push([...n]),n.length=0}for(const s of o)s!=="\r"&&(s===qt?r():s===Zt?i():t.push(s));return(t.length>0||n.length>0)&&i(),e}const Ee=[{format:"ir-grid/cell",parseFunc:yo,payloadFunc:Ro},{format:"text/html",parseFunc:So,payloadFunc:vo},{format:"text/plain",parseFunc:Io,payloadFunc:Eo}];function Mo(o,e){Ee.forEach(({format:t,payloadFunc:n})=>o.setData(t,n(e)))}function Jt(o){return o.isFormatted&&o.text.startsWith("#")}function To(o){return o.some(e=>e.some(t=>Jt(t)))}function Lo(o,e){var t,n;for(let r=0;r<o.length;++r){const i=o[r].length;for(let s=0;s<i;++s)!((n=(t=e[r])===null||t===void 0?void 0:t[s])===null||n===void 0)&&n.text&&Jt(o[r][s])&&(o[r][s].text=e[r][s].text)}return o}function pt(o){for(const{format:e,parseFunc:t}of Ee){const n=o.getData(e);if(n!==""){const r=t(n);if(!To(r))return r;const i=o.getData(Ee[2].format);return Lo(r,Ee[2].parseFunc(i))}}return console.warn("No relevant data format in clipboard!"),[]}class ko extends tt{constructor(){super([])}}class Ho extends tt{constructor(){super({mode:"idle",contextParam:{}})}get isIdle(){return this.value.mode==="idle"}}class le{constructor(e){this._grid=e}*getSelectionGenerator({top:e,left:t,bottom:n,right:r}){r=Math.min(r,this._grid.getColCount()-1),n=Math.min(n,this._grid.getRowCount()-1);for(let i=e;i<=n;i++)for(let s=t;s<=r;s++)yield this._grid.cell(i,s)}*getSelectionHeaderIterator({top:e,left:t,bottom:n,right:r}){r=Math.min(r,this._grid.getColCount()-1),n=Math.min(n,this._grid.getRowCount()-1);for(let i=0;i<this._grid.headerRows;++i)for(let s=t;s<=r;++s)yield this._grid.cell(i,s);for(let i=e;i<=n;++i)for(let s=0;s<this._grid.headerColumns;++s)yield this._grid.cell(i,s)}getCanClearCellCount(e){let t=0;for(const n of this.getSelectionGenerator(e))n.canClear&&t++;return t}}class We{constructor(e){this._grid=e,this._generator=new le(e)}adjustRange(e){const[t,n]=[this._grid.headerRows,this._grid.getRowCount()-1],[r,i]=[this._grid.headerColumns,this._grid.getColCount()-1],s={top:D(e.top,t,n),left:D(e.left,r,i),bottom:D(e.bottom,t,n),right:D(e.right,r,i)};return s.top>n||s.bottom<t||s.left>i||s.right<r?null:s}extendRange(e){const t=this._generator,n=Object.assign({},e),r=[...t.getSelectionGenerator(e)];for(;r.length;){const i=r.pop();if(!i.isMerged&&!i.mergeMain)continue;const s=i.mergeMain?i.mergeMain.mergeArea:i.mergeArea;if(s.top<n.top){const a=t.getSelectionGenerator({top:s.top,left:n.left,bottom:n.top-1,right:n.right});for(const u of a)r.push(u);n.top=s.top}if(s.left<n.left){const a=t.getSelectionGenerator({top:n.top,left:s.left,bottom:n.bottom,right:n.left-1});for(const u of a)r.push(u);n.left=s.left}if(n.bottom<s.bottom){const a=t.getSelectionGenerator({top:n.bottom+1,left:n.left,bottom:s.bottom,right:n.right});for(const u of a)r.push(u);n.bottom=s.bottom}if(n.right<s.right){const a=t.getSelectionGenerator({top:n.top,left:n.right+1,bottom:n.bottom,right:s.right});for(const u of a)r.push(u);n.right=s.right}}return n}getTextMatrixByRange(e){const t=[];for(let n=e.top;n<=e.bottom;++n)t.push(L.range(e.left,e.right+1).map(r=>this._grid.cell(n,r).text));return t}getCellMatrixByRange(e){const t=[];for(let n=e.top;n<=e.bottom;++n)t.push(L.range(e.left,e.right+1).map(r=>this._grid.cell(n,r)));return t}getCellListByColumn(e,t){const r=this._grid.getRowCount()-1;return[...this._generator.getSelectionGenerator({top:0,left:e,bottom:r,right:t})]}getColumnListByColumn(e,t){return L.range(e,t+1).map(n=>this._grid.getColumn(n))}}class zo extends tt{constructor(e){super(null,t=>{const n=new We(e);return t.pipe(Ve(r=>{if(!r||e.getRowCount()===e.headerRows&&e.getColCount()===e.headerColumns)return null;const{activeCell:i,range:s}=r;return i.element.isConnected&&i.row>=s.top&&i.row<=s.bottom&&i.col>=s.left&&i.col<=s.right?r:{activeCell:e.cell(s.top,s.left),range:r.range}}),Ve(r=>{if(!r)return null;const i=n.adjustRange(r.range);return i?{activeCell:r.activeCell,range:i}:null}),Ve(r=>r?{activeCell:r.activeCell,range:n.extendRange(r.range)}:null))})}}class Ao{constructor(e){this._selectionState=new zo(e),this._gridModeState=new Ho,this._headerCellListState=new ko}setIdle(){this.setMode({mode:"idle",contextParam:{}})}setMode(e){this.gridModeState.next(e)}get isIdle(){return this._gridModeState.isIdle}get selectionRangeState(){return this._selectionState}get gridModeState(){return this._gridModeState}get activateHeaderCellState(){return this._headerCellListState}}const Oo=[B.zLevel0,B.zLevel1,B.zLevel2,B.zLevel3,B.zLevel4,B.zLevel5,B.zLevel6,B.zLevel7,B.zLevel8,B.zLevel9],U={lv9:9,lv8:8,lv7:7,lv6:6,lv5:5,lv4:4,lv3:3};class Wo{constructor({row:e,col:t,tag:n,metaInfo:r,cellRenderer:i}){this._row=-1,this._col=-1,this._element=null,this._cellType="body-cell",this._lastEditSelection={start:0,end:0},this._metaInfo=Object.assign({},r),this._tag=n,this._cellRenderer=i,this._uuid=Pt(),this._row=e,this._col=t}get isFreezed(){return this.element.classList.contains(Be)||this.element.tagName==="TH"}get uuid(){return this._uuid}get renderType(){return this._getRenderInstance().renderType}get dropDisabled(){return this._metaInfo.dropDisabled}get isHeaderCell(){return this.element.tagName==="TH"}get isMerged(){return this.mergeInfo.rowSpan>1||this.mergeInfo.colSpan>1}get isSelected(){return this.element.classList.contains("is-selected")}get innerHeight(){return this._getRenderInstance().getCellInnerHeight(this.element,this._metaInfo)}get fontSize(){return this._metaInfo.fontSize||fe().getStoreValue("grid.defaultFontSize")}get fontFamily(){return this._metaInfo.fontFamily||fe().getStoreValue("grid.defaultFontFamily")}get mergeArea(){return{top:this.row,left:this.col,bottom:this.row+this.element.rowSpan-1,right:this.col+this.element.colSpan-1}}get innerWidth(){return this._getRenderInstance().getCellInnerWidth(this.fontSize,this.fontFamily,this._metaInfo)}get rendererInnerWidth(){return this._getRenderInstance().getRendererInnerWidth(this.fontSize,this.fontFamily,this._metaInfo)}get mergeInfo(){return{rowSpan:this.element.rowSpan,colSpan:this.element.colSpan}}get mergeMain(){return this._mergeMain}get row(){return this._row}get col(){return this._col}get bottom(){return this.row+this.mergeInfo.rowSpan-1}get right(){return this.col+this.mergeInfo.colSpan-1}get visible(){return this.element.style.display!=="none"}get cellRenderer(){return this._cellRenderer}get canClear(){const{disabled:e,readonly:t,text:n}=this.metaInfo;return e!==!0&&t!==!0&&this.renderType==="default"&&n!==""}get text(){const{text:e}=this._metaInfo;return e==null?"":e}get cellType(){return this._cellType}get value(){return this._metaInfo.value}get cellAddress(){return`${this.row},${this.col}`}get object(){return this._metaInfo.object}get metaInfo(){return this._metaInfo}initElement(){const e=document.createElement(this._tag);return e.rowSpan=1,e.colSpan=1,e.classList.add(cn,this._tag==="th"?un:hn),e.setAttribute("data-row",this._row.toString()),e.setAttribute("data-col",this._col.toString()),e.setAttribute("data-type",this._cellType),e.onclick=()=>this.onClick(this),e.onmouseup=t=>{t.button===2&&this.onRightClick(this,t)},e.ondblclick=t=>{he(t.target)&&t.target.tagName!=="I"&&t.target.tagName!=="TEXTAREA"&&this.onDblClick(this)},e}get element(){return this._element===null&&(this._element=this.initElement()),this._element}get editable(){return!(this._metaInfo.editable===!1||this._metaInfo.disabled||this.onCheckReadonly()||this._getRenderInstance().editable===!1)}get lastSelectionStart(){return this._lastEditSelection.start}get lastSelectionEnd(){return this._lastEditSelection.end}get cellInfo(){return this._metaInfo}get zIndexVariant(){return this.element.style.getPropertyValue("--grid-sticky-cell-z-index")}set visible(e){e&&!this.mergeMain?(this.element.style.removeProperty("display"),this.render()):this.element.style.display="none"}set isDragOver(e){e?this.element.classList.add("is-dragging"):this.element.classList.remove("is-dragging")}set text(e){this.cellInfo={text:e}}set cellInfo(e){Object.assign(this._metaInfo,e),this.render(),this._metaInfo.emitter.emit("onCellInfoChanged",{row:this.row,col:this.col})}set cellType(e){this._cellType=e}set height(e){e?Z(this.element,{[B.cellHeight]:`${e}px`}):Z(this.element,{[B.cellHeight]:""})}set mergeInfo({rowSpan:e=1,colSpan:t=1}){e===1&&(this.height=null),this.element.rowSpan=e,this.element.colSpan=t,this.render()}set mergeMain(e){this._mergeMain=e,this.visible=e===void 0}set row(e){this._row=e,this.element.setAttribute("data-row",e.toString())}set col(e){this._col=e,this.element.setAttribute("data-col",e.toString())}set cellRenderer(e){this._cellRenderer=e,this.render()}select(){this.isSelected||(this.element.classList.add("is-selected"),this.onSelect(this))}updateCellMetaInfo(e,t){Object.assign(this._metaInfo,e),t&&Object.assign(this._metaInfo,{text:t}),this.render()}release(){this.element.classList.remove("is-selected"),this.deactivate()}setLastSelection(e,t){this._lastEditSelection={start:e,end:t}}activate(){this._mergeMain?this._mergeMain.element.classList.add("is-active"):this.element.classList.add("is-active")}deactivate(){this.syncClassRemoveWithMergeMain("is-active")}updateReadonlyStatus(){be(this.element,"is-readonly",this.onCheckReadonly())}setStickyLeft(e){this.element.style.left=`${e}px`}removeStickyLeft(){this.element.style.removeProperty("left")}setStickyTop(e){this.element.style.top=`${e}px`}removeStickyTop(){this.element.style.removeProperty("top")}setStickyZIndex(e,t,n){this.element.style.removeProperty("--grid-sticky-cell-z-index"),this.removeStickyCls(),this.removeStickyTop(),this.removeStickyLeft(),e!==null&&(Z(this.element,{[B.stickyCellZId]:Oo[e]}),this.addStickyCls(),e>=U.lv5&&this.setStickyTop(t),(e===U.lv9||e===U.lv7||e===U.lv6||e===U.lv4||e===U.lv3)&&this.setStickyLeft(n))}updateCellStatus(){be(this.element,"is-disabled",this._metaInfo.disabled===!0),be(this.element,"is-asc",this._metaInfo.sortOrder==="ASC"),be(this.element,"is-desc",this._metaInfo.sortOrder==="DESC"),this.updateReadonlyStatus(),this._metaInfo.isError?this.addMark(dn):this._metaInfo.hasMemo?this.addMark(fn):this._mark&&this.removeMark(),this.element.style.textAlign=this._metaInfo.horizontalAlign||"",this.element.style.verticalAlign=this._metaInfo.verticalAlign||"",this.element.style.fontSize=this.fontSize,this.element.style.fontFamily=this.fontFamily,this.element.style.color=this._metaInfo.textColor||"",this.element.style.backgroundColor=this._metaInfo.backColor||""}_getRenderInstance(){if(this._cellRenderer instanceof Qe)return this._cellRenderer;if(typeof this._cellRenderer=="function"){const e=this._cellRenderer(this.row,this.col,this._metaInfo);if(e instanceof Qe)return e;if(e instanceof HTMLElement)return wo(()=>e)}throw new Error("Invalid cell renderer")}_getRenderElement(){return this._getRenderInstance().render(this.row,this.col,this._metaInfo)}replaceElement(e){this.removeChildren(),this.element.appendChild(e)}checkInputValidation(e){return this.metaInfo.enabledPatternCheck&&this.metaInfo.allowedRegExpPattern?this.metaInfo.allowedRegExpPattern.test(e):!0}render(){this._element!==null&&this.visible&&(this.removeChildren(),this.updateCellStatus(),this.element.appendChild(this._getRenderElement()))}clear(){this.cellInfo={text:""},this.onClear(this)}addStickyCls(){this.element.classList.add(Be)}removeStickyCls(){this.element.classList.remove(Be)}onClick(e){}onDblClick(e){}onRightClick(e,t){}onSelect(e){}onClear(e){}onCheckReadonly(){return this._metaInfo.readonly===!0}removeChildren(){for(;this.element.lastChild;)this.element.lastChild.remove()}syncClassRemoveWithMergeMain(...e){this.mergeMain?this.mergeMain.element.classList.remove(...e):this.element.classList.remove(...e)}addMark(e){this._mark||(this._mark=document.createElement("span")),this._mark.className=e,this.element.appendChild(this._mark)}removeMark(){this._mark&&(this._mark.remove(),this._mark=void 0)}}const Re=-1,Po=["nothing","updateColumnId","updateRowId","updateTop","updateLeft","updateRowsStickyLeft","virtualRender","resizeGridWrapperHeight","generateScrollBarClass","adjustSelection","updateSelection","updateSelectionByScroll"];class Fo{constructor(e,t,n,r,i,s){this._scheduledTaskSet=new Set,this._afterRenderCallbackList=[],this._rafHandler=Re,this._grid=e,this._gridContext=t,this._wrapperElement=n,this._tbody=r,this._contextElement=i,this._selector=s,this._gridRangeUtil=new We(e),this._emptyRow=document.createElement("tr"),this._emptyRow.className=gn,this._emptyRow.dataset.hidden="true",Z(this._emptyRow,{[B.emptyRowHeight]:"0"}),this._tbody.appendChild(this._emptyRow),e.addGlobalEventListener(i,"scroll",a=>{this.addTask("virtualRender").addTask("updateSelectionByScroll"),a.preventDefault()})}renderTask(){const e=new Set(this._scheduledTaskSet);this._scheduledTaskSet.clear(),this._rafHandler=Re,L(Po).filter(t=>e.has(t)).forEach(t=>{try{t!=="nothing"&&this[t].call(this)}catch(n){console.error(t,n)}}),this._afterRenderCallbackList.forEach(t=>t()),this._afterRenderCallbackList.length=0}forceRunTasks(){this._rafHandler!==Re&&cancelAnimationFrame(this._rafHandler),this.renderTask()}addTask(e){return this._scheduledTaskSet.add(e),this._rafHandler===Re&&(this._rafHandler=requestAnimationFrame(()=>this.renderTask())),this}scheduleAddRowTasks(){this.addTask("virtualRender").addTask("resizeGridWrapperHeight").addTask("generateScrollBarClass")}getActualBodyRowsInfo(){var e,t;const n=this._grid.getRowCount()-1,r=Math.min(this._grid.getFreezedRowCount(),n),{fixedRowHeight:i}=this._grid,{scrollTop:s,clientHeight:a}=this._contextElement,u=(e=this._grid.getRowByTop(i+s+1))!==null&&e!==void 0?e:this._grid.firstRow,c=(t=this._grid.getRowByTop(s+a))!==null&&t!==void 0?t:this._grid.lastRow,l=L.range(0,r);if(!u||!c)return{emptyRowHeight:0,viewRowList:l};const h=u.getTopRowId(),f=c.getBottomRowId(),R=this._grid.getRow(Math.max(h-2,r)),T=this._grid.getRow(Math.min(f+2,n));return{emptyRowHeight:R.top-i,viewRowList:l.concat(L.range(R.rowId,T.rowId+1))}}getGridRow(e){var t;const n=parseInt((t=e.dataset.row)!==null&&t!==void 0?t:"",10);return n!==n?null:this._grid.getRow(n)}virtualRender(){const{emptyRowHeight:e,viewRowList:t}=this.getActualBodyRowsInfo(),n=new Set(t),r=this._grid.getFreezedRowCount(),{headerRows:i}=this._grid;let s=this._tbody.lastElementChild;for(;s;){const c=this.getGridRow(s);s=s.previousElementSibling,c&&!n.has(c.rowId)&&c.unmount()}e===0?this._emptyRow.dataset.hidden="true":(this._emptyRow.dataset.hidden="false",Z(this._emptyRow,{[B.emptyRowHeight]:`${e}px`}));let a=null,u=!1;for(const c of t){const l=this._grid.getRow(c);if(c<r?!l.isFreezed&&l.freeze(c<i):u===!1&&(a===null?this._tbody.insertAdjacentElement("afterbegin",this._emptyRow):a.insertAdjacentElement("afterend",this._emptyRow),u=!0,a=this._emptyRow),l.isMounted){a=l.element;continue}a===null?l.mount(this._tbody,"afterbegin"):l.mount(a,"afterend"),a=l.element}}updateRowsStickyLeft(){for(let e=0;e<this._grid.getRowCount();e++)this._grid.getRow(e).updateStickyStatus()}updateSelection(){this._selector.update()}updateLeft(){const e=this._grid.getColCount();let t=0,n=0;for(;t<e;){const r=this._grid.getColumn(t);r.left=n,r.visible&&(n=r.right),++t}}updateTop(){const e=this._grid.getRowCount();let t=0,n=0;for(;t<e;){const r=this._grid.getRow(t);r.top=n,r.visible&&(n=r.bottom),++t}}updateColumnId(){const e=this._grid.getColCount();let t=0;for(;t<e;){const n=this._grid.getColumn(t);n.columnId=t,++t}this._grid.render()}updateRowId(){const e=this._grid.getRowCount(),t=this._grid.getFreezedRowCount();let n=0;for(;n<e;){const r=this._grid.getRow(n);r.rowId=n,r.isFreezed&&n>=t?r.unfreeze():!r.isFreezed&&n<t&&r.freeze(),r.render(),++n}}adjustSelection(){const e=this._gridContext.selectionRangeState.value;if(!e)return this._grid.releaseCells();const t=this._gridRangeUtil.adjustRange(e.range);if(!t)return this._grid.releaseCells();this._grid.select(this._gridRangeUtil.extendRange(t))}updateSelectionByScroll(){this._selector.updateScroll()}resizeGridWrapperHeight(){this._wrapperElement.style.height=`${this._grid.height}px`}generateScrollBarClass(){this._grid.generateScrollBarClass()}addAfterRenderTask(e){this._afterRenderCallbackList.push(e)}get isScheduled(){return this._scheduledTaskSet.size>0}}const re=1,ie=1;class Bo{constructor({grid:e,rowId:t,height:n,top:r,rowType:i}){this._rowElement=null,this._top=-1,this._maxCellHeight=0,this._uuid=Pt(),this._stickyColumns=0,this._height=0,this._isCalledOnMounted=!1,this._grid=e,this._cells=[],this._rowType=i,this._rowId=t,this._maxCellHeight=n,this._isMounted=!1,this._height=n,this._top=r}get rowInnerHeight(){return this._cells.filter(e=>e.visible&&e.mergeInfo.rowSpan===1).reduce((e,t)=>Math.max(e,t.innerHeight),0)}get isFreezed(){return this.element.classList.contains(De)}get uuid(){return this._uuid}get isMounted(){return this._isMounted}get rowId(){return this._rowId}get isHeaderRow(){return this.element.classList.contains(st)}get cellCounts(){return this._cells.length}get rowType(){return this._rowType}initRowElement(){const e=document.createElement("tr");Z(e,{[B.cellHeight]:`${this._height}px`}),e.setAttribute("data-top",this._top.toString()),e.dataset.row=this._rowId.toString(),this._rowElement=e;for(const t of this._cells)e.appendChild(t.element),t.setStickyZIndex(this.getFreezedCellType(t.col),this._top,this._grid.getColumnLeft(t.col)),this.isMounted&&t.render();return e}get element(){return this._rowElement===null&&(this._rowElement=this.initRowElement()),this._rowElement}get textColor(){return this.element.style.color}get height(){return this._height}get heightWithBorder(){return this._height+re}get bottom(){return this.visible?this._top+this.heightWithBorder:this._top}get bottomByCellHeight(){return this._top+this._maxCellHeight}get stickyColumns(){return this._stickyColumns}get top(){return this._top}get visible(){return this.element.style.display!=="none"}set rowId(e){this._rowElement&&(this._rowElement.dataset.row=e.toString()),this._rowId=e,this._cells.forEach(t=>t.row=e),this.render()}set textColor(e){this.element.style.color=e}set height(e){this._height=e,Z(this.element,{[B.cellHeight]:`${e}px`}),this.onChangedHeight(this,e)}set top(e){this._top=e,this.element.setAttribute("data-top",e.toString()),this.updateStickyStatus()}set visible(e){e?(this.element.style.removeProperty("display"),this.render()):this.element.style.display="none"}unmount(){this._isMounted=!1,this.element.remove()}updateMaxCellHeight(){const e=this.height;this._maxCellHeight=this._cells.reduce((t,n)=>{var r;return Math.max(t,(r=n.height)!==null&&r!==void 0?r:e)},e)}removeCells(e,t){L.range(e,t+1).forEach(r=>this._cells[r].element.remove());const n=1+t-e;this._cells.splice(e,n),L.range(e,this._cells.length).forEach(r=>{this._cells[r].col-=n,this._cells[r].render()})}getTopRowId(){let e=this._rowId;for(const t of this._cells)t.mergeMain&&(e=Math.min(e,t.mergeMain.row));return e}getBottomRowId(){let e=this._rowId;for(const t of this._cells)t.mergeMain&&(e=Math.max(e,t.mergeMain.bottom));return e}getFreezedCellType(e){const t=e<this._grid.getFreezedColumnCount();return this.isHeaderRow?t?U.lv9:U.lv8:this.isFreezed?t?e<this._grid.headerColumns?U.lv7:U.lv6:U.lv5:t?e<this._grid.headerColumns?U.lv4:U.lv3:null}addCell(e){this._cells.push(e),this._rowElement&&(this._rowElement.appendChild(e.element),e.setStickyZIndex(this.getFreezedCellType(e.col),this._top,this._grid.getColumnLeft(e.col)),e.render())}insertCells(e,t){if(this._cells.length<t)throw new Error(`Out of length at the row. the length is ${this._cells.length} and you tried inserting with ${t}`);const n=this._cells[t].element;L.range(t,this._cells.length).forEach(r=>{this._cells[r].col+=e.length,this._cells[r].render()}),this._cells.splice(t,0,...e),L(e).forEach(r=>{r.setStickyZIndex(this.getFreezedCellType(r.col),this._top,this._grid.getColumnLeft(r.col)),n.insertAdjacentElement("beforebegin",r.element),this.isMounted&&r.render()})}render(){this.visible&&this._cells.forEach(e=>e.render())}getCell(e){const t=this._cells[e];if(!t)throw new Error(`Not found cell ${this._rowId}, ${e}`);return t}setRowInfo(e){const{textData:t,cellMetaInfo:n}=e;this._cells.forEach((r,i)=>r.updateCellMetaInfo(n,t==null?void 0:t[i]))}*getCellGenerator(e=0,t=this._cells.length-1){for(let n=e;n<=t;++n)yield this._cells[n]}setColumnVisible(e,t){this._cells[e].visible=t}getColumnVisible(e){return this._cells[e].visible}setAutoHeight(e,t){const n=Math.ceil(this.rowInnerHeight),r=D(isNaN(n)?0:n,e,t);return this.height!==r?(this.height=r,!0):!1}mount(e,t){this.isMounted||(e.insertAdjacentElement(t,this.element),this.render(),this._isMounted=!0,this._isCalledOnMounted||(this._isCalledOnMounted=!0,this.onMounted(this)))}freeze(e=!1){e&&this.element.classList.add(st),this.element.classList.add(De),this.updateStickyStatus()}isBetweenTop(e){return e>=this.top&&e<=this.bottom}updateStickyStatus(){this._cells.reduce((e,t,n)=>(t.setStickyZIndex(this.getFreezedCellType(n),this._top,e),e+(this._grid.getColumnVisible(n)?this._grid.getColumnWidth(n)+1:0)),0)}updateCellMetaInfo(e){this._cells.forEach(t=>t.cellInfo=e)}freezeColumns(e){this._stickyColumns=e,this.updateStickyStatus()}unfreeze(){if(this.isHeaderRow)throw new Error("Can not freeze header row!");this.element.classList.remove(De),this.updateStickyStatus()}onMounted(e){}onChangedHeight(e,t){}}class Do{constructor(e,t){this._rowList=[],this._visibleRowList=[],this._headerRows=e,this._freezedRows=t,this._rowsHeight=0,this._headerRowsHeight=0,this._freezedRowsHeight=0}getRow(e){const t=this._rowList[e];if(!t)throw new Error(`Not found row ${e}`);return t}addRow(e){this._rowList.push(e),this._visibleRowList.push(e),this.updateRowHeight(e,"add"),e.rowId<this.freezedRows&&this.updateFixedHeight()}clearRows(){L(this._rowList).drop(this.headerRows).forEach(e=>e.unmount()),this._rowList.length=this.headerRows,this._rowsHeight=this.headerRowsHeight,this._freezedRowsHeight=this.headerRowsHeight,this.updateVisibleRowList()}addColumn(e){this._rowList.forEach(t=>t.addCell(e(t)))}setColumnVisible(e,t){this._rowList.forEach(n=>n.getCell(e).visible=t)}insertColumns(e,t,n){this._rowList.forEach(r=>{const i=L.range(t).map(s=>n(r.rowId,e+s));r.insertCells(i,e)})}removeRows(e,t){const n=this._rowList.splice(e,t-e+1);n.length!==0&&(n.forEach(r=>{this.updateRowHeight(r,"remove"),r.unmount()}),this.updateVisibleRowList(),this.updateFixedHeight())}removeColumns(e,t){this._rowList.forEach(n=>n.removeCells(e,t))}insertRows(e,t){let n=this._rowList[e].top;this._rowList.splice(e,0,...t),this.updateVisibleRowList();for(let r=0;r<t.length;r++){const i=t[r];i.top=n,this.updateRowHeight(i,"add"),n=i.bottom}this.updateFixedHeight()}addFixedHeight(e,t,n=1){t<this.headerRows&&(this._headerRowsHeight+=e.heightWithBorder*n),t<this.freezedRows&&(this._freezedRowsHeight+=e.heightWithBorder*n)}updateFixedHeight(){this._headerRowsHeight=0,this._freezedRowsHeight=0;let e=0;const t=Math.min(this.length,this.freezedRows);for(const n of this._rowList)if(n.visible&&(this.addFixedHeight(n,e),++e),e>=t)break}updateCellReadonlyStatus(){this._rowList.forEach(e=>{const t=e.cellCounts;for(let n=0;n<t;n++)e.getCell(n).updateReadonlyStatus()})}setRowHeight(e,t){const n=this.getRow(e),r=n.height-t;r!==0&&(n.height=t,this.changeRowHeight(n,r))}setRowVisible(e,t){const n=this.getRow(e);t!==n.visible&&(n.visible=t,this.updateRowHeight(n,t?"show":"hide"),this.updateVisibleRowList(),this.updateFixedHeight())}updateVisibleRowList(){this._visibleRowList=this._rowList.filter(e=>e.visible)}changeRowHeight(e,t){this._rowsHeight-=t,e.rowId<this.headerRows&&(this._headerRowsHeight-=t),e.rowId<this.freezedRows&&(this._freezedRowsHeight-=t)}updateRowHeight(e,t){if(t==="remove"&&!e.visible)return;const n=e.height+re,r=t==="add"||t==="show"?n:-n;this._rowsHeight+=r}sort(e,t,n,r){const i=this._rowList.slice(0,n),s=this._rowList.slice(n,r),a=this._rowList.slice(r);s.forEach(u=>u.unmount()),s.sort((u,c)=>t==="ASC"?e(u,c):-e(u,c)),this._rowList=[...i,...s,...a],this.updateVisibleRowList()}freezeRows(e){this._freezedRows=e,L(this._rowList).drop(this.headerRows).takeWhile(t=>t.isFreezed).forEach(t=>{t.unfreeze()}),L(this._rowList).drop(this.headerRows).take(e).forEach(t=>t.freeze()),this.updateFixedHeight()}renderRows(){this._visibleRowList.forEach(e=>e.render())}getTopByRowId(e){return this.getRow(e).top}getBottomByRowId(e){return this.getRow(e).bottom}getNextRowId(){return this._rowList.length}getRowByTop(e){const t=this.visibleRowList;let n=0,r=t.length-1;for(;n<=r;){const i=n+Math.floor((r-n)/2),s=t[i];if(s.isBetweenTop(e))return s;e<s.top?r=i-1:n=i+1}return null}get visibleRowList(){return this._visibleRowList}get freezedRowsHeight(){return this._freezedRowsHeight}get headerRowsHeight(){return this._headerRowsHeight}get rowLodash(){return L(this._rowList)}get rowsHeight(){return this._rowsHeight}get length(){return this._rowList.length}get headerRows(){return this._headerRows}get freezedRows(){return this._headerRows+this._freezedRows}get bodyFreezedRows(){return this._freezedRows}get firstRow(){return this._rowList[0]}get lastRow(){return this._rowList[this._rowList.length-1]}}class Ct{constructor({columnId:e,width:t,left:n}){this._left=0,this._columnId=0,this._width=0,this._visible=!0,this._colElement=document.createElement("col"),this.columnId=e,this.width=t,this.left=n}get columnId(){return this._columnId}get left(){return this._left}get width(){return this._width}get widthWithBorder(){return this._width+ie}get colElement(){return this._colElement}get visible(){return this._visible}get right(){return this.visible?this.left+this.widthWithBorder:this.left}set visible(e){this._visible=e,e?this._colElement.style.removeProperty("display"):this._colElement.style.display="none"}set columnId(e){this._columnId=e,this._colElement.dataset.column=e.toString()}set left(e){this._left=e,this._colElement.dataset.left=e.toString()}set width(e){this._width=e,this._colElement.style.width=`${this.widthWithBorder}px`,this._colElement.dataset.width=e.toString()}remove(){this._colElement.remove()}isBetweenLeft(e){return e>=this.left&&e<=this.right}}class jo{constructor(e,t){this._columnsList=[],this._visibleColumnsList=[],this._columnsWidth=0,this._rowHeaderColumnsWidth=0,this._freezedColumnsWidth=0,this._colGroup=document.createElement("colgroup"),this._rowHeaderColumns=e,this._freezedColumns=t}addColumn(e){const t=new Ct({columnId:this._columnsList.length,width:e,left:this._columnsWidth});return this._colGroup.appendChild(t.colElement),this._columnsList.push(t),this._visibleColumnsList.push(t),this.updateColumnWidth(t,"add"),this.addFixedWidth(t),t}updateVisibleColumnList(){this._visibleColumnsList=this._columnsList.filter(e=>e.visible)}updateColumnWidth(e,t){if(t==="remove"&&!e.visible)return;const n=t==="add"||t==="show"?e.widthWithBorder:-e.widthWithBorder;this._columnsWidth+=n}removeColumns(e,t){this._columnsList.splice(e,t-e+1).forEach(r=>{this.updateColumnWidth(r,"remove"),r.remove()}),this.updateVisibleColumnList(),this.updateFixedWidth()}freezeColumns(e){this._freezedColumns=e,this.updateFixedWidth()}changeColumnWidth(e,t){this._columnsWidth-=t,e.columnId<this.headerColumns&&(this._rowHeaderColumnsWidth-=t),e.columnId<this.freezedColumns&&(this._freezedColumnsWidth-=t)}insertColumns(e,t,n){const r=this.getColumn(e),i=r.left,s=L.range(t).map(a=>new Ct({columnId:e+a,width:n,left:i+(n+ie)*a}));this._columnsList.splice(e,0,...s),s.forEach(a=>{r.colElement.insertAdjacentElement("beforebegin",a.colElement),this.updateColumnWidth(a,"add")}),this.updateVisibleColumnList(),this.updateFixedWidth()}addFixedWidth(e,t=1){e.columnId<this.headerColumns&&(this._rowHeaderColumnsWidth+=e.widthWithBorder*t),e.columnId<this.freezedColumns&&(this._freezedColumnsWidth+=e.widthWithBorder*t)}updateFixedWidth(){this._rowHeaderColumnsWidth=0,this._freezedColumnsWidth=0;let e=0;const t=Math.min(this.freezedColumns,this._columnsList.length);for(;e<t;){const n=this.getColumn(e);n.visible&&this.addFixedWidth(n),++e}}setColumnWidth(e,t){const n=this.getColumn(e),r=n.width-t;r!==0&&(n.width=t,this.changeColumnWidth(n,r))}setColumnVisible(e,t){const n=this.getColumn(e);n.visible!==t&&(n.visible=t,this.updateColumnWidth(n,t?"show":"hide"),this.updateVisibleColumnList(),this.addFixedWidth(n,t?1:-1))}getColumnLeft(e){return this.getColumn(e).left}getColumnRight(e){return this.getColumn(e).right}getColumnWidth(e){return this.getColumn(e).width}getColumn(e){const t=this._columnsList[e];if(!t)throw new Error("No column");return t}updateColumnsLeftFrom(e){L(this._columnsList).drop(e).reduce((t,n)=>(n.left=t,n.visible?t+n.width+ie:t),this.getColumn(e).left)}get colgroup(){return this._colGroup}get visibleColumnList(){return this._visibleColumnsList}get columnsWidth(){return this._columnsWidth}get rowHeaderColumnsWidth(){return this._rowHeaderColumnsWidth}get length(){return this._columnsList.length}get fixedColumnsWidth(){return this._freezedColumnsWidth}get headerColumns(){return this._rowHeaderColumns}get freezedColumns(){return this._rowHeaderColumns+this._freezedColumns}get bodyFreezedColumns(){return this._freezedColumns}}class Go{constructor(e){var t;const n=fe();this._cellPadding=Object.freeze((t=e.cellPadding)!==null&&t!==void 0?t:{top:n.getStoreValue("grid.paddingTop"),left:n.getStoreValue("grid.paddingLeft"),bottom:n.getStoreValue("grid.paddingBottom"),right:n.getStoreValue("grid.paddingRight")}),this._defaultRowHeight=n.getStoreValue("grid.defaultRowHeight"),this._defaultColumnWidth=n.getStoreValue("grid.defaultColumnWidth"),this._defaultRowMinSize=n.getStoreValue("grid.defaultRowMinSize"),this._defaultRowMaxSize=n.getStoreValue("grid.defaultRowMaxSize"),this._defaultColumnMinSize=n.getStoreValue("grid.defaultColumnMinSize"),this._defaultColumnMaxSize=n.getStoreValue("grid.defaultColumnMaxSize"),this._rowManager=new Do(e.headerRowCount,e.freezedRowCount),this._columnManager=new jo(e.headerColumnCount,e.freezedColumnCount)}get cellPadding(){return this._cellPadding}get defaultRowHeight(){return this._defaultRowHeight}get defaultColumnWidth(){return this._defaultColumnWidth}get defaultRowMinSize(){return this._defaultRowMinSize}get defaultRowMaxSize(){return this._defaultRowMaxSize}get defaultColumnMinSize(){return this._defaultColumnMinSize}get defaultColumnMaxSize(){return this._defaultColumnMaxSize}get rowManager(){return this._rowManager}get columnManager(){return this._columnManager}}class Qt extends N{_execute(){this._instance.setColumnWidth(...this._args)}_getUndoContext(){return{latestWidth:this._instance.getColumnWidth(this._args[0])}}_undo(){this._instance.setColumnWidth(this._args[0],this._undoContext.latestWidth)}get canExecute(){return this._args[0]<this._instance.getColCount()}get canUndo(){return this._args[0]<this._instance.getColCount()}}class en extends N{_execute(){this._instance.setRowHeight(...this._args)}_getUndoContext(){return{latestHeight:this._instance.getRowHeight(this._args[0])}}_undo(){this._instance.setRowHeight(this._args[0],this._undoContext.latestHeight)}get canExecute(){return this._args[0]<this._instance.getRowCount()}get canUndo(){return this._args[0]<this._instance.getRowCount()}}class me{constructor(){this._mountRollbackStack=[],this._isMounted=!1}_mountTask(e){throw new Error("unmount method not implemented.")}mount(e){if(this.isMounted)throw new Error("Already mounted plugin!");try{this._mountTask(e),this._isMounted=!0}catch(t){console.error("Plugin mount error!",t),this.unmount()}}unmount(){if(!this.isMounted)throw new Error("Already unmounted plugin!");try{for(const e of this._mountRollbackStack)e();this._mountRollbackStack.length=0,this._isMounted=!1}catch(e){console.error("Plugin unmount error!",e)}}get isMounted(){return this._isMounted}}const Vo=12,No=8,Ko={"col-resizing":Ke,"row-resizing":$e},_t={"col-resizing":Cn,"row-resizing":_n},wt=o=>o.mergeInfo?o.col+o.mergeInfo.colSpan-1:o.col,bt=o=>o.mergeInfo?o.row+o.mergeInfo.rowSpan-1:o.row,$o=500,Rt=4;class Uo extends me{constructor(e){super(),this._options=e}_mountTask({grid:e,wrapperElement:t,gridContext:n,contextElement:r}){const{enabledColResizer:i,enabledRowResizer:s}=this._options,a=(h,f,R)=>{e.commandManager.pushCommandBlock(new ge(h,new Qt(e,[f,R])))},u=(h,f,R)=>{e.commandManager.pushCommandBlock(new ge(h,new en(e,[f,R])))};(function(){const f=document.createElement("div");let R=!1,T=null,d=0;const w=()=>{r.classList.remove(Ke),r.classList.remove($e),r.classList.remove("is-resizing"),T&&r.removeEventListener("mousedown",T)},H=(y,M)=>{T&&r.removeEventListener("mousedown",T),r.classList.remove(Ke),r.classList.remove($e),r.classList.add(Ko[M]),r.classList.add("is-resizing");let z=0,j=0,G=0,g=0,m=0;const _=()=>y.col<e.getFreezedColumnCount()?e.scrollLeft+g:g,C=()=>y.row<e.getFreezedRowCount()?e.scrollTop+g:g;T=E=>{const S=new Date().getTime();if(n.setMode({mode:M,contextParam:{}}),S-d<=$o){M==="col-resizing"?e.commandManager.doRecording("Autosize column",()=>{e.autoSizeColumn(y.col)}):e.commandManager.doRecording("Autosize row",()=>{e.autoSizeRow(y.row)}),d=0;return}R=!0,d=S,y.element.classList.add(_t[M]),M==="col-resizing"?(f.className=mn,m=e.getColumnWidth(wt(y)),z=E.pageX,j=z-m+e.minColWidth,G=z-m+e.maxColWidth,g=e.getColumnLeft(y.col)+e.getCellWidth(y),f.style.top="0px",f.style.width="0px",f.style.height=`${e.height}px`,f.style.left=`${_()}px`):(f.className=pn,m=e.getRowHeight(bt(y)),z=E.pageY,j=z-m+e.minRowHeight,G=z-m+e.maxRowHeight,g=e.getRow(y.row).top+e.getCellHeight(y),f.style.top=`${C()}px`,f.style.width=`${e.width}px`,f.style.height="0px",f.style.left="0px"),t.appendChild(f),e.addGlobalEventListener(document,"keydown",x),e.addGlobalEventListener(document,"mouseup",p),e.addGlobalEventListener(document,"mousemove",I)};const I=E=>{if(M==="col-resizing"){const S=D(E.pageX,j,G)-z;f.style.left=`${_()+S}px`}else{const S=D(E.pageY,j,G)-z;f.style.top=`${C()+S}px`}},p=E=>{if(M==="col-resizing"){const F=D(E.pageX,j,G)-z;if(Math.abs(F)>Rt){const W=wt(y),A=m+F;a("Resize column",W,A),e.setColumnWidth(W,A),d=0}}else{const F=D(E.pageY,j,G)-z;if(Math.abs(F)>Rt){const W=bt(y),A=m+F;u("Resize row",W,A),e.setRowHeight(W,A),d=0}}v(),n.setIdle();const S=c(E);if(!S)return;const P=l(E,S);P!==null&&H(S,P)};function v(){R=!1,f.remove(),w(),y.element.classList.remove(_t[M]),document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",p),document.removeEventListener("keydown",x)}const x=E=>{E.key==="Escape"&&v()};e.addGlobalEventListener(r,"mousedown",T)},b=y=>{if(R)return;const M=c(y);if(M===null){w();return}const z=l(y,M);z===null?w():H(M,z)},k=y=>{w()};e.addGlobalEventListener(r,"mousemove",b),e.addGlobalEventListener(r,"mouseout",k)})();const c=h=>{const f=Ie("th","tr",h.target);if(!f)return null;const[R,T]=[parseInt(f.getAttribute("data-row")||"-1"),parseInt(f.getAttribute("data-col")||"-1")];return e.cell(R,T)},l=(h,f)=>f.cellType==="body-cell"?null:i&&Math.abs(e.getCellWidth(f)-h.offsetX)<=Vo?"col-resizing":s&&Math.abs(e.getCellHeight(f)-h.offsetY)<=No?"row-resizing":null}get pluginKey(){return"resizer"}}class Yo extends me{_mountTask({grid:e,gridContext:t,contextElement:n}){let r=null;const i=(u,c)=>{const l=[u.row,u.bottom,c.row,c.bottom],h=[u.col,u.right,c.col,c.right],f={top:Math.min(...l),left:Math.min(...h),bottom:Math.max(...l),right:Math.max(...h)};L.isEqual(f,e.getSelection())||(e.select(f,r),this.onChangedSelection(f))};e.addGlobalEventListener(n,"mousedown",u=>{if(!he(u.target)||u.button!==0||u.target instanceof HTMLTextAreaElement||Ie(".button","tr",u.target))return;const c=Ie("td","tr",u.target);if(!c)return;const l=Je(c),h=e.activeCell;u.shiftKey&&h?(r=h,i(h,e.cell(l.row,l.col))):(r=e.cell(l.row,l.col),e.selectRange(r.row,r.col,r.bottom,r.right,r),this.onChangedSelection({top:r.row,left:r.col,bottom:r.bottom,right:r.right})),t.setMode({mode:"selecting-mouse",contextParam:{}})});function s(u,c){const l=c.closest("td");if(!l)return;const h=Je(l),f=e.cell(h.row,h.col);i(u,f)}function a(u,c){const{offsetX:l,offsetY:h,target:f}=u;if(!he(f))return;const R=l+f.scrollLeft,T=h+f.scrollTop,d=R>e.width?e.width:R,w=T>e.height?e.height:T,H=e.findCellOrNull(w,d);H&&i(c,H)}e.addGlobalEventListener(n,"mousemove",u=>{r&&he(u.target)&&(u.target===n?a(u,r):s(r,u.target))}),e.addGlobalEventListener(document,"mouseup",()=>{r&&(r=null,t.setIdle())}),e.onDoubleClickCell=u=>t.isIdle&&e.doEditMode(u),e.onColumnClick=u=>e.selectColumn(u.col),e.onRowClick=u=>e.selectRow(u.row)}get pluginKey(){return"cell-selector"}onChangedSelection(e){}}class tn extends N{_getUndoContext(){const[e]=this._args,t=[],n=new le(this._instance);for(const r of n.getSelectionGenerator(e))r.canClear&&t.push({row:r.row,col:r.col,text:r.text});return{textSnapshot:t}}_undo(){const{textSnapshot:e}=this._undoContext;e.forEach(({row:t,col:n,text:r})=>{this._instance.setCell(t,n,{text:r}),this._instance.onEditCellDone(this._instance.cell(t,n),!0,"","",0,0)})}_execute(){const[e]=this._args;this._instance.clearCells(e)}get canUndo(){return!0}get canExecute(){return!0}}function nn(o,e){const t=(g,m,_)=>{var C;const I=o.headerRows;let p=_,v=g;for(;p!==0;){const x=o.cell(v,m),S=((C=x.mergeMain)!==null&&C!==void 0?C:x).row-1;if(S<I)break;o.getRowVisible(S)&&++p,v=S}return v},n=(g,m,_)=>{var C;const I=o.getRowCount()-1;let p=_,v=g;for(;p!==0;){const x=o.cell(v,m),S=((C=x.mergeMain)!==null&&C!==void 0?C:x).bottom+1;if(S>I)break;o.getRowVisible(S)&&--p,v=S}return v},r=(g,m,_)=>{var C;const I=o.headerColumns;let p=_,v=m;for(;p!==0;){const x=o.cell(g,v),S=((C=x.mergeMain)!==null&&C!==void 0?C:x).col-1;if(S<I)break;o.getColumnVisible(S)&&++p,v=S}return v},i=(g,m,_)=>{var C;const I=o.getColCount()-1;let p=_,v=m;for(;p!==0;){const x=o.cell(g,v),S=((C=x.mergeMain)!==null&&C!==void 0?C:x).right+1;if(S>I)break;o.getColumnVisible(S)&&--p,v=S}return v},s=()=>{let g=o.headerColumns;for(;!o.getColumnVisible(g);)++g;return g},a=()=>{let g=o.getColCount()-1;for(;!o.getColumnVisible(g);)--g;return g},u=()=>{let g=o.headerRows;for(;!o.getRowVisible(g);)++g;return g},c=()=>{let g=o.getRowCount()-1;for(;!o.getRowVisible(g);)--g;return g},l=g=>{if(o.getRowCount()-1===g)return g;let _=g+1;for(;!o.getRowVisible(_);)++_;return _},h=g=>{const m=o.headerRows;if(g===m)return g;let _=g-1;for(;!o.getRowVisible(_);)++_;return _},f=()=>{var g;const{activeCell:m}=o;if(!m){console.warn("No active cell warning.");return}const _=c(),C=a(),I=(g=m.mergeMain)!==null&&g!==void 0?g:m;if(I.right===C){if(m.row===_)return;const p=s(),v=l(m.row);e?o.selectRow(v,o.cell(v,p)):o.selectCell(v,p),o.scrollInView(v,p)}else{const p=i(m.row,I.right,1);e?o.selectRow(m.row,o.cell(m.row,p)):o.selectCell(m.row,p),o.scrollOnCol(p)}},R=()=>{var g;const{activeCell:m}=o;if(!m){console.warn("No active cell warning.");return}const _=u(),C=s(),I=(g=m.mergeMain)!==null&&g!==void 0?g:m;if(I.col===C){if(m.row===_)return;const p=a(),v=h(m.row);e?o.selectRow(v,o.cell(v,p)):o.selectCell(v,p),o.scrollInView(v,p)}else{const p=r(m.row,I.col,-1);e?o.selectRow(m.row,o.cell(m.row,p)):o.selectCell(m.row,p),o.scrollOnCol(p)}},T=(g,m,_)=>{var C;let I=-1,p=-1;for(let v=m;v<=_;v++){const x=o.cell(g,v),E=(C=x.mergeMain)!==null&&C!==void 0?C:x,{rowSpan:S}=E.mergeInfo;S>I&&(I=S,p=v)}return p},d=(g,m,_)=>{var C;let I=-1;for(let p=m;p<=_;p++){const v=o.cell(g,p),x=(C=v.mergeMain)!==null&&C!==void 0?C:v,{bottom:E}=x;E>I&&(I=E)}return I},w=(g,m,_)=>{var C;let I=999999999;for(let p=m;p<=_;p++){const v=o.cell(g,p),x=(C=v.mergeMain)!==null&&C!==void 0?C:v;I>x.row&&(I=x.row)}return I},H=(g,m,_)=>{var C;let I=-1,p=-1;for(let v=m;v<=_;v++){const x=o.cell(v,g),E=(C=x.mergeMain)!==null&&C!==void 0?C:x,{colSpan:S}=E.mergeInfo;S>I&&(I=S,p=v)}return p},b=(g,m,_)=>{var C;let I=-1;for(let p=m;p<=_;p++){const v=o.cell(p,g),x=(C=v.mergeMain)!==null&&C!==void 0?C:v,{right:E}=x;E>I&&(I=E)}return I},k=(g,m,_)=>{var C;let I=999999999;for(let p=m;p<=_;p++){const v=o.cell(p,g),x=(C=v.mergeMain)!==null&&C!==void 0?C:v;I>x.col&&(I=x.col)}return I};return{getNextYAbove:t,getNextYBelow:n,getNextXLeft:r,getNextXRight:i,selectNextActiveCell:f,selectBeforeActiveCell:R,selectNextSelection:(g,m,_)=>{var C;const I=o.getSelection(),{activeCell:p}=o;if(I==null||p==null){console.warn("No selection warning");return}const v=(C=p.mergeMain)!==null&&C!==void 0?C:p;if(_&&e)return;if(!_){if(g!==0){const F=g<0?t(v.row,p.col,g):n(v.bottom,p.col,g);e?o.selectRow(F,o.cell(F,p.col)):o.selectCell(F,p.col),o.scrollOnRow(F)}else{const F=m<0?r(p.row,v.col,m):i(p.row,v.right,m);e?o.selectRow(p.row,o.cell(p.row,F)):o.selectCell(p.row,F),o.scrollOnCol(F)}return}const{top:x,bottom:E,left:S,right:P}=I;if(g!==0)if(g<0)if(d(p.row,S,P)===E){const W=T(x,S,P),A=t(x,W,g);o.selectRange(A,S,E,P,p),o.scrollOnRow(A)}else{const W=T(E,S,P),A=t(E,W,g);o.selectRange(x,S,A,P,p),o.scrollOnRow(A)}else if(w(p.row,S,P)===x){const W=T(E,S,P),A=n(E,W,g);o.selectRange(x,S,A,P,p),o.scrollOnRow(A)}else{const W=T(x,S,P),A=n(x,W,g);o.selectRange(A,S,E,P,p),o.scrollOnRow(A)}else if(m<0)if(b(p.col,x,E)===P){const W=H(S,x,E),A=r(W,S,m);o.selectRange(x,A,E,P,p),o.scrollOnCol(A)}else{const W=H(P,x,E),A=r(W,P,m);o.selectRange(x,S,E,A,p),o.scrollOnCol(A)}else if(k(p.col,x,E)===S){const W=H(P,x,E),A=i(W,P,m);o.selectRange(x,S,E,A,p),o.scrollOnCol(A)}else{const W=H(S,x,E),A=i(W,S,m);o.selectRange(x,A,E,P,p),o.scrollOnCol(A)}},selectMoveToLastColumn:g=>{const m=o.getSelection(),{activeCell:_}=o;if(m==null||_==null){console.warn("No selection warning");return}const C=a();g&&e||(g?o.selectRange(m.top,_.col,m.bottom,C,_):e?o.selectRow(_.row,o.cell(_.row,C)):o.selectCell(_.row,C),o.scrollOnCol(C))},selectMoveToFirstColumn:g=>{const m=o.getSelection(),{activeCell:_}=o;if(m==null||_==null){console.warn("No selection warning");return}const C=s();g&&e||(g?o.selectRange(m.top,C,m.bottom,_.col,_):e?o.selectRow(_.row,o.cell(_.row,C)):o.selectCell(_.row,C),o.scrollOnCol(C))},selectMoveToLastRow:g=>{const m=o.getSelection(),{activeCell:_}=o;if(m==null||_==null){console.warn("No selection warning");return}const C=c();g&&e||(g?o.selectRange(_.row,m.left,C,m.right,_):o.selectCell(C,_.col),o.scrollOnRow(C))},selectMoveToFirstRow:g=>{const m=o.getSelection(),{activeCell:_}=o;if(m==null||_==null){console.warn("No selection warning");return}const C=u();g&&e||(g?o.selectRange(C,m.left,_.bottom,m.right,_):o.selectCell(C,_.col),o.scrollOnRow(C))}}}class Xo{constructor(){this.keyMap={}}addKeyAction(e,t){this.keyMap[e]||(this.keyMap[e]=[]),this.keyMap[e].push(t)}hasKeyAction(e){return this.keyMap[e]&&this.keyMap[e].length>0}startKeyAction(e){this.hasKeyAction(e.key)&&(this.onStartKeyActionHook(e),L(this.keyMap[e.key]).forEach(t=>{try{return t(e)}catch(n){return console.error(n),!1}}),this.onEndKeyActionHook(e))}onStartKeyActionHook(e){}onEndKeyActionHook(e){}}const yt=10;class qo extends me{constructor({keyMiddleware:e=[],rowSelection:t=!1}){super(),this._keyMiddleware=e,this._rowSelection=t}_mountTask({grid:e,gridContext:t,contextElement:n}){const r=new Xo;r.onEndKeyActionHook=d=>{d.key.match(/^[\w\d]$/)||d.preventDefault()};const i=(d,w=!1)=>{var H,b;if(!t.isIdle)return;const k=(b=(H=e.activeCell)===null||H===void 0?void 0:H.mergeMain)!==null&&b!==void 0?b:e.activeCell;k&&e.doEditMode(k,d,w)};this._keyMiddleware.forEach(([d,w])=>r.addKeyAction(d,w));const s=document.createElement("textarea"),a=new le(e),{selectNextActiveCell:u,selectNextSelection:c,selectBeforeActiveCell:l,selectMoveToFirstRow:h,selectMoveToFirstColumn:f,selectMoveToLastColumn:R,selectMoveToLastRow:T}=nn(e,this._rowSelection);s.className=wn,n.appendChild(s),e.addCoreElement(s),e.addGlobalEventListener(n,"focus",()=>{document.activeElement!==s&&s.focus()}),e.addGlobalEventListener(n,"mouseup",d=>{var w;d.target instanceof HTMLTextAreaElement||!((w=document.activeElement)===null||w===void 0)&&w.classList.contains(Wt)||s.focus()}),e.addGlobalEventListener(n,"input",d=>{var w;if(d.target===s)return i((w=d.data)!==null&&w!==void 0?w:void 0,!0),!0}),s.addEventListener("copy",d=>e.onNativeCopy(d)),s.addEventListener("cut",d=>e.onNativeCut(d)),s.addEventListener("paste",d=>e.onNativePaste(d)),r.addKeyAction("Tab",d=>(d.shiftKey?l():u(),!0)),r.addKeyAction("ArrowRight",d=>(d.ctrlKey?R(d.shiftKey):c(0,1,d.shiftKey),!0)),r.addKeyAction("ArrowUp",d=>(d.ctrlKey?h(d.shiftKey):c(-1,0,d.shiftKey),!0)),r.addKeyAction("ArrowLeft",d=>(d.ctrlKey?f(d.shiftKey):c(0,-1,d.shiftKey),!0)),r.addKeyAction("ArrowDown",d=>(d.ctrlKey?T(d.shiftKey):c(1,0,d.shiftKey),!0)),r.addKeyAction("Home",d=>(f(d.shiftKey),!0)),r.addKeyAction("End",d=>(R(d.shiftKey),!0)),r.addKeyAction("PageUp",d=>(c(-yt,0,d.shiftKey),!0)),r.addKeyAction("PageDown",d=>(c(yt,0,d.shiftKey),!0)),r.addKeyAction("Enter",d=>(c(1,0,!1),!0)),r.addKeyAction("a",d=>d.ctrlKey?(e.selectAll(),d.preventDefault(),!1):!0),r.addKeyAction("z",d=>d.ctrlKey?(e.undo(),d.preventDefault(),!1):!0),r.addKeyAction("y",d=>d.ctrlKey?(e.redo(),d.preventDefault(),!1):!0),r.addKeyAction("F2",d=>(i(),!0)),r.addKeyAction("Delete",d=>{const w=e.getSelection();if(!w||a.getCanClearCellCount(w)===0)return!0;const H=new tn(e,[w]);return e.commandManager.pushCommandBlock(new ge("Clear cells",H)),e.clearCells(w),!0}),r.addKeyAction(" ",d=>{var w;const H=e.getSelection();if(!H)return!0;for(const b of a.getSelectionGenerator(H))b.onCheckReadonly()||b.metaInfo.disabled||b.renderType==="checkbox"&&((w=b.element.querySelector("input"))===null||w===void 0||w.click());return!0}),e.addGlobalEventListener(n,"keydown",d=>{t.isIdle&&d.target===s&&(s.value="",r.startKeyAction(d))})}get pluginKey(){return"default-key"}}class Zo extends me{constructor({enabledOnHeader:e=!1}){super(),this._enabledOnHeader=e}_mountTask({grid:e,gridContext:t,table:n}){const{_enabledOnHeader:r}=this,i={latestDragOverCell:null},s=()=>{t.setIdle(),n.classList.remove("is-dragging"),a()},a=()=>{i.latestDragOverCell&&(i.latestDragOverCell.isDragOver=!1)},u=l=>{a(),i.latestDragOverCell=l,l.isDragOver=!0},c=()=>n.classList.contains("is-dragging");n.addEventListener("mouseup",()=>c()&&s()),n.addEventListener("dragenter",()=>{t.setMode({mode:"dragging",contextParam:{}}),n.classList.add("is-dragging")}),n.addEventListener("dragover",l=>{if(!n.classList.contains("is-dragging"))return;const h=e.findCellOrNull(l.offsetY,l.offsetX);if(!h)return null;if(h.dropDisabled!==!1&&(h.isHeaderCell&&r===!1||h.metaInfo.disabled===!0||h.onCheckReadonly()===!0||h.dropDisabled===!0))return a(),null;e.onDragOverCell(h,l)===!0&&(u(h),l.preventDefault())}),n.addEventListener("dragleave",l=>{l.target===n?s():a()}),n.addEventListener("drop",l=>{try{i.latestDragOverCell&&e.onDropOnCell(i.latestDragOverCell.row,i.latestDragOverCell.col,l)}finally{s()}})}get pluginKey(){return"cell-drop"}}const on=8,Jo={normal:yn,error:vn},vt=(o,e,t,n)=>{o.isConnected===!1||o.offsetParent===null||On(o,e,{placement:t,strategy:"fixed",middleware:[Wn({mainAxis:on,crossAxis:n!=null?n:0}),Pn(),Fn({padding:5})]}).then(({x:r,y:i,placement:s})=>{e.style.left=`${r}px`,e.style.top=`${i}px`,e.dataset.placement=s})},Qo=o=>{var e,t;return(t=(e=o.cellInfo.tooltip)!==null&&e!==void 0?e:o.cellInfo.text)!==null&&t!==void 0?t:""},er=o=>{var e;return(e=o.cellInfo.memo)!==null&&e!==void 0?e:""};class tr extends me{constructor(e){super(),this.options=e,this.context=null,this._tooltipElement=document.createElement("div"),this._memoElement=document.createElement("div"),this._tooltipElement.className=bn}hideMemo(){this._memoElement.remove()}hideTooltip(){this._tooltipElement.remove()}createContext(e){var t,n,r,i,s,a;const{memoInterval:u,tooltipInterval:c,hideTooltipWhenHasMemo:l}=this.options,{hasMemo:h,memoIntent:f="normal",tooltipDisabled:R=!1}=e.cellInfo,T=(r=(n=(t=this.options).getTooltipText)===null||n===void 0?void 0:n.call(t,e))!==null&&r!==void 0?r:Qo(e),d=(a=(s=(i=this.options).getMemoText)===null||s===void 0?void 0:s.call(i,e))!==null&&a!==void 0?a:er(e),w=()=>{this._tooltipElement.textContent=T,lt("popover").appendChild(this._tooltipElement),vt(e.element,this._tooltipElement,"bottom")},H=()=>{this._memoElement.textContent=d!=null?d:"",this._memoElement.className=`${Rn} ${Jo[f]}`,lt("popover").appendChild(this._memoElement),vt(e.element,this._memoElement,"right-start",on)},b=!(h&&l)&&R===!1&&T?window.setTimeout(()=>w(),c):-1,k=h&&d?window.setTimeout(()=>H(),u):-1;return{targetCell:e,tooltipTimeoutHandler:b,memoTimeoutHandler:k,cleanup:()=>{clearTimeout(b),clearTimeout(k),this.hideTooltip(),this.hideMemo(),this.context=null}}}_mountTask({grid:e,gridContext:t,contextElement:n}){const r=i=>{var s,a,u;if(!he(i.target))return;const c=Ie("td,th","tr",i.target);if(!c){(s=this.context)===null||s===void 0||s.cleanup();return}const l=Je(c),h=e.cell(l.row,l.col);((a=this.context)===null||a===void 0?void 0:a.targetCell)!==h&&((u=this.context)===null||u===void 0||u.cleanup(),this.context=this.createContext(h))};e.addGlobalEventListener(n,"mouseleave",()=>{var i;return(i=this.context)===null||i===void 0?void 0:i.cleanup()}),t.gridModeState.addSubscription((i,{mode:s})=>{var a;n.removeEventListener("mousemove",r),(a=this.context)===null||a===void 0||a.cleanup(),(s==="idle"||s==="edit-cell")&&e.addGlobalEventListener(n,"mousemove",r)}),e.addGlobalEventListener(n,"scroll",()=>{var i;return(i=this.context)===null||i===void 0?void 0:i.cleanup()})}get pluginKey(){return"popover"}}const nr=128;class or{constructor(e){this._cell=e}createTextAreaWrapper(e,t=!1){var n;const r=document.createElement("div"),i=document.createElement("textarea"),s=(n=this._cell.metaInfo.text)!==null&&n!==void 0?n:"";i.className=Wt,i.value=s,this._cell.metaInfo.maxLength?i.maxLength=this._cell.metaInfo.maxLength:i.maxLength=1e4,t&&(i.value=""),e&&e.charCodeAt(0)<nr&&(i.value+=e);const a=(l,h,f)=>{if(i.removeEventListener("blur",u),r.remove(),h&&this._cell.checkInputValidation(l)){const R=new Yt(this._cell.metaInfo.commandManager,[this._cell.row,this._cell.col,{text:l}]);R.onUndo=()=>{this.onEditDone(this._cell,h,s,f,i.selectionStart,i.selectionEnd)},R.onExecute=()=>{this.onEditDone(this._cell,h,s,f,i.selectionStart,i.selectionEnd)},this._cell.metaInfo.commandManager.commandManager.pushCommandBlock(new ge(`Edit cell (${this._cell.row}, ${this._cell.col}) `,R)),this._cell.cellInfo={text:l}}this._cell.render(),this._cell.setLastSelection(i.selectionStart,i.selectionEnd),this.onEditDone(this._cell,h,s,f,i.selectionStart,i.selectionEnd)},u=l=>{a(i.value,s!==i.value,"")},c=l=>l.key==="ArrowLeft"&&i.selectionStart===0&&i.selectionEnd===0?(this.onMoveLeftOnEdit(l.ctrlKey,l.shiftKey),!0):l.key==="ArrowUp"&&i.selectionStart===0&&i.selectionEnd===0?(this.onMoveUpOnEdit(l.ctrlKey,l.shiftKey),!0):l.key==="ArrowRight"&&i.selectionStart===i.textLength&&i.selectionEnd===i.textLength?(this.onMoveRightOnEdit(l.ctrlKey,l.shiftKey),!0):l.key==="ArrowDown"&&i.selectionStart===i.textLength&&i.selectionEnd===i.textLength?(this.onMoveDownOnEdit(l.ctrlKey,l.shiftKey),!0):l.key==="Tab"?(this.onTabOnEdit(l.ctrlKey,l.shiftKey),l.preventDefault(),!0):!1;return i.onkeydown=l=>{if(c(l)){a(i.value,s!==i.value,l.key);return}if(l.key==="Escape")a(i.value,!1,l.key);else if(l.key==="Enter"){if(!l.altKey){l.preventDefault(),a(i.value,s!==i.value,l.key),this.onEnterOnEdit(l.ctrlKey,l.shiftKey);return}i.readOnly=!0;const h=i.value.substring(0,i.selectionStart);i.value=[i.value.substring(0,i.selectionStart),`
`,i.value.substring(i.selectionEnd)].join(""),i.readOnly=!1,i.selectionEnd=h.length+1}else this.onEditKeyDown(l,this._cell.row,this._cell.col,this._cell.metaInfo)},i.addEventListener("blur",u),r.appendChild(i),{textareaWrapper:r,textarea:i}}runEditMode(e,t=!1){const{textareaWrapper:n,textarea:r}=this.createTextAreaWrapper(e,t);this._cell.replaceElement(n),r.focus()}onMoveLeftOnEdit(e,t){}onMoveRightOnEdit(e,t){}onMoveUpOnEdit(e,t){}onMoveDownOnEdit(e,t){}onTabOnEdit(e,t){}onEnterOnEdit(e,t){}onEdit(){}onError(){}onEditDone(e,t,n,r,i,s){}onEditKeyDown(e,t,n,r){}}const q=new WeakMap,Q=new WeakMap,X=new WeakMap;var rr={};const Le=Symbol("anyProducer"),St=Promise.resolve(),ke=Symbol("listenerAdded"),He=Symbol("listenerRemoved");let ze=!1,Ne=!1;function te(o){if(typeof o!="string"&&typeof o!="symbol"&&typeof o!="number")throw new TypeError("`eventName` must be a string, symbol, or number")}function ye(o){if(typeof o!="function")throw new TypeError("listener must be a function")}function ne(o,e){const t=Q.get(o);if(t.has(e))return t.get(e)}function de(o,e){const t=typeof e=="string"||typeof e=="symbol"||typeof e=="number"?e:Le,n=X.get(o);if(n.has(t))return n.get(t)}function ir(o,e,t){const n=X.get(o);if(n.has(e))for(const r of n.get(e))r.enqueue(t);if(n.has(Le)){const r=Promise.all([e,t]);for(const i of n.get(Le))i.enqueue(r)}}function xt(o,e){e=Array.isArray(e)?e:[e];let t=!1,n=()=>{},r=[];const i={enqueue(s){r.push(s),n()},finish(){t=!0,n()}};for(const s of e){let a=de(o,s);a||(a=new Set,X.get(o).set(s,a)),a.add(i)}return{async next(){return r?r.length===0?t?(r=void 0,this.next()):(await new Promise(s=>{n=s}),this.next()):{done:!1,value:await r.shift()}:{done:!0}},async return(s){r=void 0;for(const a of e){const u=de(o,a);u&&(u.delete(i),u.size===0&&X.get(o).delete(a))}return n(),arguments.length>0?{done:!0,value:await s}:{done:!0}},[Symbol.asyncIterator](){return this}}}function Et(o){if(o===void 0)return It;if(!Array.isArray(o))throw new TypeError("`methodNames` must be an array of strings");for(const e of o)if(!It.includes(e))throw typeof e!="string"?new TypeError("`methodNames` element must be a string"):new Error(`${e} is not Emittery method`);return o}const oe=o=>o===ke||o===He;function ve(o,e,t){if(oe(e))try{ze=!0,o.emit(e,t)}finally{ze=!1}}class ee{static mixin(e,t){return t=Et(t),n=>{if(typeof n!="function")throw new TypeError("`target` must be function");for(const s of t)if(n.prototype[s]!==void 0)throw new Error(`The property \`${s}\` already exists on \`target\``);function r(){return Object.defineProperty(this,e,{enumerable:!1,value:new ee}),this[e]}Object.defineProperty(n.prototype,e,{enumerable:!1,get:r});const i=s=>function(...a){return this[e][s](...a)};for(const s of t)Object.defineProperty(n.prototype,s,{enumerable:!1,value:i(s)});return n}}static get isDebugEnabled(){var t;if(typeof rr!="object")return Ne;const{env:e}=(t=globalThis.process)!=null?t:{env:{}};return e.DEBUG==="emittery"||e.DEBUG==="*"||Ne}static set isDebugEnabled(e){Ne=e}constructor(e={}){var t;q.set(this,new Set),Q.set(this,new Map),X.set(this,new Map),X.get(this).set(Le,new Set),this.debug=(t=e.debug)!=null?t:{},this.debug.enabled===void 0&&(this.debug.enabled=!1),this.debug.logger||(this.debug.logger=(n,r,i,s)=>{try{s=JSON.stringify(s)}catch{s=`Object with the following keys failed to stringify: ${Object.keys(s).join(",")}`}(typeof i=="symbol"||typeof i=="number")&&(i=i.toString());const a=new Date,u=`${a.getHours()}:${a.getMinutes()}:${a.getSeconds()}.${a.getMilliseconds()}`;console.log(`[${u}][emittery:${n}][${r}] Event Name: ${i}
	data: ${s}`)})}logIfDebugEnabled(e,t,n){(ee.isDebugEnabled||this.debug.enabled)&&this.debug.logger(e,this.debug.name,t,n)}on(e,t){ye(t),e=Array.isArray(e)?e:[e];for(const n of e){te(n);let r=ne(this,n);r||(r=new Set,Q.get(this).set(n,r)),r.add(t),this.logIfDebugEnabled("subscribe",n,void 0),oe(n)||ve(this,ke,{eventName:n,listener:t})}return this.off.bind(this,e,t)}off(e,t){ye(t),e=Array.isArray(e)?e:[e];for(const n of e){te(n);const r=ne(this,n);r&&(r.delete(t),r.size===0&&Q.get(this).delete(n)),this.logIfDebugEnabled("unsubscribe",n,void 0),oe(n)||ve(this,He,{eventName:n,listener:t})}}once(e){let t;const n=new Promise(r=>{t=this.on(e,i=>{t(),r(i)})});return n.off=t,n}events(e){e=Array.isArray(e)?e:[e];for(const t of e)te(t);return xt(this,e)}async emit(e,t){var a;if(te(e),oe(e)&&!ze)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emit",e,t),ir(this,e,t);const n=(a=ne(this,e))!=null?a:new Set,r=q.get(this),i=[...n],s=oe(e)?[]:[...r];await St,await Promise.all([...i.map(async u=>{if(n.has(u))return u(t)}),...s.map(async u=>{if(r.has(u))return u(e,t)})])}async emitSerial(e,t){var a;if(te(e),oe(e)&&!ze)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emitSerial",e,t);const n=(a=ne(this,e))!=null?a:new Set,r=q.get(this),i=[...n],s=[...r];await St;for(const u of i)n.has(u)&&await u(t);for(const u of s)r.has(u)&&await u(e,t)}onAny(e){return ye(e),this.logIfDebugEnabled("subscribeAny",void 0,void 0),q.get(this).add(e),ve(this,ke,{listener:e}),this.offAny.bind(this,e)}anyEvent(){return xt(this)}offAny(e){ye(e),this.logIfDebugEnabled("unsubscribeAny",void 0,void 0),ve(this,He,{listener:e}),q.get(this).delete(e)}clearListeners(e){e=Array.isArray(e)?e:[e];for(const t of e)if(this.logIfDebugEnabled("clear",t,void 0),typeof t=="string"||typeof t=="symbol"||typeof t=="number"){const n=ne(this,t);n&&n.clear();const r=de(this,t);if(r){for(const i of r)i.finish();r.clear()}}else{q.get(this).clear();for(const[n,r]of Q.get(this).entries())r.clear(),Q.get(this).delete(n);for(const[n,r]of X.get(this).entries()){for(const i of r)i.finish();r.clear(),X.get(this).delete(n)}}}listenerCount(e){var n,r,i,s,a,u;e=Array.isArray(e)?e:[e];let t=0;for(const c of e){if(typeof c=="string"){t+=q.get(this).size+((r=(n=ne(this,c))==null?void 0:n.size)!=null?r:0)+((s=(i=de(this,c))==null?void 0:i.size)!=null?s:0)+((u=(a=de(this))==null?void 0:a.size)!=null?u:0);continue}typeof c<"u"&&te(c),t+=q.get(this).size;for(const l of Q.get(this).values())t+=l.size;for(const l of X.get(this).values())t+=l.size}return t}bindMethods(e,t){if(typeof e!="object"||e===null)throw new TypeError("`target` must be an object");t=Et(t);for(const n of t){if(e[n]!==void 0)throw new Error(`The property \`${n}\` already exists on \`target\``);Object.defineProperty(e,n,{enumerable:!1,value:this[n].bind(this)})}}}const It=Object.getOwnPropertyNames(ee.prototype).filter(o=>o!=="constructor");Object.defineProperty(ee,"listenerAdded",{value:ke,writable:!1,enumerable:!0,configurable:!1});Object.defineProperty(ee,"listenerRemoved",{value:He,writable:!1,enumerable:!0,configurable:!1});const sr=o=>{const e=new ee({debug:{name:o.uuid}}),t=new Set;return e.on("updateCellStatus",n=>o.cell(n.row,n.col).updateCellStatus()),{get emitter(){return e},emit(...n){t.has(n[0])||e.emit(...n)},lockEmit(n){t.add(n)},unlockEmit(n){t.delete(n)}}};function lr(o,e){const t={text:"",ignoreCase:!0,matchAll:!1,area:"all",direction:"top-bottom"};let n=!1;const r=()=>t.hasHeaderRows?0:o.headerRows,i=()=>t.hasHeaderColumns?0:o.headerColumns;function*s(){let c=r(),l=i();const h=o.getSelection();for(n=!1;;){switch(t.area){case"all":yield o.cell(c,l);break;case"selected-col":if(!h)throw new Error("No selection in finding");Ut(l,h)&&(yield o.cell(c,l));break;case"selected-row":if(!h)throw new Error("No selection in finding");$t(c,h)&&(yield o.cell(c,l));break;case"selection":if(!h)throw new Error("No selection in finding");gt(c,l,h)&&(yield o.cell(c,l));break;case"custom":if(!t.customRange)throw new Error("Please call with customRange in 'custom' finding.");gt(c,l,t.customRange)&&(yield o.cell(c,l));break}if(t.direction==="top-bottom"){if(++c,c===o.getRowCount()&&(++l,c=r()),l===o.getColCount())if(n)n=!1,c=r(),l=i();else break}else if(++l,l===o.getColCount()&&(++c,l=i()),c===o.getRowCount())if(n)n=!1,c=r(),l=i();else break}}function a(c){const l=t.text.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),h=t.matchAll?`^${l}$`:l,f=t.ignoreCase?"i":"",R=new RegExp(h,f);return e.onCellCheck?e.onCellCheck(R,c):R.test(c.text)}let u=s();return{resetCursor(){u=s()},findNext(c){for(L.isEqual(t,c)||(u=s()),Object.assign(t,c);;){const l=u.next();if(!l.done&&a(l.value))return n=!0,l.value;if(l.done)break}return null},getAllMatchedCell(c){const l=[];c&&Object.assign(t,c);for(const h of s())a(h)&&l.push(h);return l}}}function ar(o){return o.top===o.bottom&&o.left===o.right}function cr(o){return o.top>o.bottom||o.left>o.right}function ur(o){const e=[],t=new le(o),n=({top:c,left:l,bottom:h,right:f})=>L(e).some(({mergeArea:R})=>l<=R.right&&f>=R.left&&c<=R.bottom&&h>=R.top)===!1,r=(c,l)=>L.range(c,l+1).filter(h=>o.getRowVisible(h)).reduce(h=>h+1,0),i=(c,l)=>L.range(c,l+1).filter(h=>o.getColumnVisible(h)).reduce(h=>h+1,0),s=({top:c,left:l,bottom:h,right:f})=>!!(L.range(c,h+1).some(R=>o.getRowVisible(R)===!1)||L.range(l,f+1).some(R=>o.getColumnVisible(R)===!1)),a=(c,l)=>{const h=o.cell(c,l),f=e.indexOf(h);return f<0?null:e[f]},u=c=>new Set([...t.getSelectionGenerator(c)].map(l=>l.zIndexVariant)).size>1;return{isValidatedMerging:n,getMergedRowHeight(c,l){const h=(l-c)*re;return L.range(c,l+1).filter(f=>o.getRowVisible(f)).reduce((f,R)=>f+o.getRowHeight(R),0)+h},mergeCells(c){if(cr(c))throw new Error("Invalid range");if(n(c)===!1)throw new Error("Could not merging with Conflicted cells!");if(s(c))throw new Error("Could not merging with hidden cells!");if(ar(c))throw new Error("Could not merging with single cell!");if(u(c))throw new Error("Could not merging with different z-index!");const l=o.cell(c.top,c.left);l.height=this.getMergedRowHeight(c.top,c.bottom),l.mergeInfo={rowSpan:r(c.top,c.bottom),colSpan:i(c.left,c.right)},e.push(l),o.getRow(c.top).updateMaxCellHeight();for(const f of t.getSelectionGenerator(c))(f.row!==c.top||f.col!==c.left)&&(f.mergeMain=l,f.metaInfo.text="")},splitCells(c,l){const h=a(c,l);if(!h)throw new Error("Could not split on a not merged cell!");for(const f of t.getSelectionGenerator(h.mergeArea))f.mergeMain=void 0,f.mergeInfo={rowSpan:1,colSpan:1};this.removeMergeCell(c,l),o.getRow(c).updateMaxCellHeight()},isMerged(c,l){return!n({top:c,left:l,bottom:c,right:l})},*getMergedCellGenerator(c){for(const l of t.getSelectionGenerator(c))(l.mergeInfo.rowSpan>1||l.mergeInfo.colSpan>1)&&(yield l)},removeMergeCell(c,l){const h=a(c,l);if(!h)throw new Error("Could not split on a not merged cell!");e.splice(e.indexOf(h),1)},checkConflictingInRows(c,l){for(const{mergeArea:h}of e)if(h.top<c&&h.bottom>=c&&h.bottom<=l||h.bottom>l&&h.top>=c&&h.top<=l||h.top<c&&h.bottom>l)return!0;return!1},checkConflictingInColumns(c,l){for(const{mergeArea:h}of e)if(h.left<c&&h.right>=c&&h.right<=l||h.right>l&&h.left>=c&&h.left<=l||h.left<c&&h.right>l)return!0;return!1},checkCanInsertRow(c){for(const{mergeArea:l}of e)if(l.top<c&&l.bottom>=c)return!1;return!0},checkCanInsertColumn(c){for(const{mergeArea:l}of e)if(l.left<c&&l.right>=c)return!1;return!0}}}const hr=4,Se="is-hidden";function dr(o,e){return o.top>e.bottom||e.top>o.bottom||o.left>e.right||e.left>o.right?null:{top:Math.max(o.top,e.top),left:Math.max(o.left,e.left),bottom:Math.min(o.bottom,e.bottom),right:Math.min(o.right,e.right)}}const fr=En,gr=[In,Mn,Tn,Ln],mr=["top","left","bottom","right"];function pr(o){const e=document.createElement("div"),t=[document.createElement("div"),document.createElement("div"),document.createElement("div"),document.createElement("div")],n=[document.createElement("div"),document.createElement("div"),document.createElement("div"),document.createElement("div")],[r,i,s,a]=n,u=[r,s],c=[i,a];e.classList.add(Sn,Se),n.forEach((b,k)=>b.className=`${xn} border-line__${mr[k]}`),t.forEach(b=>e.appendChild(b)),n.forEach(b=>e.appendChild(b));function l(b){const{top:k,left:y,bottom:M,right:z}=R(b),j=b.top<o.getFreezedRowCount()?o.scrollTop:0,G=b.left<o.getFreezedColumnCount()?o.scrollLeft:0;return{top:k+j,left:y+G,width:z-y,height:M-k}}function h(b){b.classList.add(Se),delete b.dataset.y,delete b.dataset.x,delete b.dataset.width,delete b.dataset.height,delete b.dataset.visible}function f(b,k){const y=t[b],M=l(k);y.className=`${fr} ${gr[b]}`,y.dataset.top=k.top.toString(),y.dataset.left=k.left.toString(),y.dataset.bottom=k.bottom.toString(),y.dataset.right=k.right.toString(),y.dataset.y=M.top.toString(),y.dataset.x=M.left.toString(),y.dataset.width=M.width.toString(),y.dataset.height=M.height.toString(),y.dataset.visible="true",y.style.top=`${M.top}px`,y.style.left=`${M.left}px`,y.style.width=`${M.width}px`,y.style.height=`${M.height}px`}function R(b){return{top:o.getRow(b.top).top-re,left:o.getColumn(b.left).left-ie,bottom:o.getRow(b.bottom).bottom,right:o.getColumn(b.right).right}}function T(b){const k=o.getFreezedColumnCount();return L.range(b.left,b.right+1).reduce((y,M)=>{const z=o.getColumn(M);return z.visible?y+(M>=k?z.widthWithBorder:0):y},0)}function d(b){const k=o.getFreezedRowCount();return L.range(b.top,b.bottom+1).reduce((y,M)=>{const z=o.getRow(M);return z.visible?y+(M>=k?z.heightWithBorder:0):y},0)}function w(b,k,y,M){if(b<=M)return Math.min(k,y);const z=b-M;return y>z?Math.max(0,y-z):0}function H(b){const{top:k,left:y,bottom:M,right:z}=R(b),{fixedRowHeight:j,fixedColumnWidth:G,scrollTop:g,scrollLeft:m}=o,_=j+g,C=G+m,I=k<j,p=M<=j,v=y<G,x=z<=G,E=k>=_,S=M>=_,P=y>=C,F=z>=C,W=T(b),A=d(b),nt=w(y,W,m,G),ot=w(k,A,g,j),Pe=z-y-nt,Fe=M-k-ot,rt=k+(I?g:ot),it=y+(v?m:nt),pe=it<0?1:0,Ce=rt<0?1:0;(function(){u.forEach(ce=>{ce.style.left=`${it+pe}px`,ce.style.width=`${Pe-pe}px`})})(),function(){c.forEach(ce=>{ce.style.top=`${rt+Ce}px`,ce.style.height=`${Fe-Ce}px`})}(),function(){if(Pe<=1){r.style.display="none";return}r.style.removeProperty("display"),I?r.style.top=`${k+g+Ce}px`:E?r.style.top=`${k+Ce}px`:r.style.display="none"}(),function(){if(Pe<=1){s.style.display="none";return}s.style.removeProperty("display"),p?s.style.top=`${M+g-re}px`:S?s.style.top=`${M-re}px`:s.style.display="none"}(),function(){if(Fe<=1){i.style.display="none";return}i.style.removeProperty("display"),v?i.style.left=`${y+m+pe}px`:P?i.style.left=`${y+pe}px`:i.style.display="none"}(),function(){if(Fe<=1){a.style.display="none";return}a.style.removeProperty("display"),x?a.style.left=`${z+m-ie}px`:F?a.style.left=`${z-ie}px`:a.style.display="none"}()}return{get selectionRoot(){return e},updateArea(b){const k=o.headerRows,y=o.getFreezedRowCount(),M=o.headerColumns,z=o.getFreezedColumnCount(),j=o.getRowCount()-1,G=o.getColCount()-1,m=[{top:k,left:M,bottom:y-1,right:z-1},{top:k,left:z,bottom:y-1,right:G},{top:y,left:M,bottom:j,right:z-1},{top:y,left:z,bottom:j,right:G}].map(_=>dr(b,_));for(let _=0;_<hr;_++){const C=m[_];C?f(_,C):h(t[_])}H(b)},applyGridScroll(){const b=o.getSelection();b&&this.updateArea(b)},show(){e.classList.remove(Se)},hide(){e.classList.add(Se)}}}class Cr{constructor(e,t,n){this._activatedHeaderCellList=[],this._gridContext=t,this._selectionHandler=pr(e),n.appendChild(this._selectionHandler.selectionRoot)}updateScroll(){this._selectionHandler.applyGridScroll()}releaseRange(){this._selectionHandler.hide()}update(){const e=this._gridContext.selectionRangeState.value;if(!e){this.releaseRange();return}const{range:t}=e;this._selectionHandler.show(),this._selectionHandler.updateArea(t)}}class _r extends N{_execute(){return this._instance.addColumn(...this._args)}_getUndoContext(){return{addedColumn:this._instance.getColCount(),selection:this._instance.getSelection(),activeCell:this._instance.activeCell}}_undo(){this._instance.removeColumn(this._undoContext.addedColumn),this._undoContext.selection&&this._instance.select(this._undoContext.selection,this._undoContext.activeCell)}get canExecute(){return!0}get canUndo(){return this._undoContext?this._instance.getColCount()>this._undoContext.addedColumn:!1}}class wr extends N{_execute(){return this._instance.addRow(...this._args)}_undo(){this._instance.removeRow(this._undoContext.addedRow),this._undoContext.selection&&this._instance.select(this._undoContext.selection,this._undoContext.activeCell)}_getUndoContext(){return{addedRow:this._instance.getRowCount(),selection:this._instance.getSelection(),activeCell:this._instance.activeCell}}get canExecute(){return!0}get canUndo(){return this._undoContext?this._instance.getRowCount()>this._undoContext.addedRow:!1}}class br extends N{_undo(){this._instance.setColumnVisible(this._args[0],this._undoContext.visible)}_getUndoContext(){return{visible:this._instance.getColumnVisible(this._args[0])}}_execute(){return this._instance.setColumnVisible(...this._args)}get canUndo(){return!0}get canExecute(){return!0}}class Rr extends N{_undo(){const[e,t=1]=this._args;this._instance.removeColumns(e,e+t-1),this._undoContext.selection&&this._instance.select(this._undoContext.selection,this._undoContext.activeCell)}_execute(){return this._instance.insertColumns(...this._args)}_getUndoContext(){return{selection:this._instance.getSelection(),activeCell:this._instance.activeCell}}get canUndo(){return!0}get canExecute(){return!0}}class yr extends N{_undo(){const[e,t=1]=this._args;this._instance.removeRows(e,e+t-1),this._undoContext.selection&&this._instance.select(this._undoContext.selection,this._undoContext.activeCell)}_execute(){return this._instance.insertRows(...this._args)}_getUndoContext(){return{selection:this._instance.getSelection(),activeCell:this._instance.activeCell}}get canUndo(){return!0}get canExecute(){return!0}}class vr extends N{_undo(){const[e,t]=this._args;this._instance.splitCells(e,t),this._undoContext.textSnapshot.forEach(({row:n,col:r,text:i})=>{this._instance.setText(n,r,i)})}_execute(){this._instance.mergeCells(...this._args)}_getUndoContext(){const e=new le(this._instance),[t,n,r,i]=this._args,s=[];for(const a of e.getSelectionGenerator({top:t,left:n,bottom:r,right:i}))s.push({row:a.row,col:a.col,text:a.text});return{textSnapshot:s}}get canUndo(){return!0}get canExecute(){return!0}}class Sr extends N{_undo(){const e=this._args[1]-this._args[0]+1;this._instance.insertColumns(this._args[0],e),this._undoContext.columnList.forEach((t,n)=>{this._instance.setColumnWidth(n+this._args[0],t.width),this._instance.setColumnVisible(n+this._args[0],t.visible)}),this._undoContext.removedCells.forEach(t=>{this._instance.cell(t.row,t.col).cellRenderer=t.cellRenderer,this._instance.setCell(t.row,t.col,t.metaInfo),(t.mergeInfo.rowSpan>1||t.mergeInfo.colSpan>1)&&this._instance.mergeCells(t.row,t.col,t.bottom,t.right)}),this._undoContext.selection&&this._instance.select(this._undoContext.selection,this._undoContext.activeCell?this._instance.cell(this._undoContext.activeCell.row,this._undoContext.activeCell.col):null)}_getUndoContext(){const e=new We(this._instance),[t,n]=this._args;return{removedCells:e.getCellListByColumn(t,n),columnList:e.getColumnListByColumn(t,n),selection:this._instance.getSelection(),activeCell:this._instance.activeCell}}_execute(){return this._instance.removeColumns(...this._args)}get canUndo(){return!0}get canExecute(){return!0}}class xr extends N{_undo(){const e=this._args[1]-this._args[0]+1;this._instance.insertRows(this._args[0],e),this._instance.forceLayoutTask(),this._undoContext.removedRows.forEach(t=>{const n=this._instance.getRow(t.rowId);this._instance.setRowHeight(n.rowId,t.height),this._instance.setRowVisible(n.rowId,t.visible);for(let r=0;r<t.cellCounts;r++){const i=t.getCell(r);n.getCell(r).cellRenderer=i.cellRenderer,this._instance.setCell(n.rowId,r,i.metaInfo),(i.mergeInfo.rowSpan>1||i.mergeInfo.colSpan>1)&&this._instance.mergeCells(i.row,i.col,i.bottom,i.right)}this._undoContext.selection&&this._instance.select(this._undoContext.selection,this._undoContext.activeCell?this._instance.cell(this._undoContext.activeCell.row,this._undoContext.activeCell.col):null)})}_execute(){return this._instance.removeRows(...this._args)}_getUndoContext(){const[e,t]=this._args;return{removedRows:L.range(e,t+1).map(r=>this._instance.getRow(r)),selection:this._instance.getSelection(),activeCell:this._instance.activeCell}}get canUndo(){return!0}get canExecute(){return!0}}class Er extends N{_undo(){this._instance.setRowVisible(this._args[0],this._undoContext.visible)}_getUndoContext(){return{visible:this._instance.getRowVisible(this._args[0])}}_execute(){return this._instance.setRowVisible(...this._args)}get canUndo(){return!0}get canExecute(){return!0}}class Ir extends N{_undo(){const[e,t]=this._args;this._instance.mergeCells(e,t,e+this._undoContext.rowSpan-1,t+this._undoContext.colSpan-1)}_execute(){this._instance.splitCells(...this._args)}_getUndoContext(){const e=this._instance.cell(...this._args);return{rowSpan:e.mergeInfo.rowSpan,colSpan:e.mergeInfo.colSpan}}get canUndo(){return!0}get canExecute(){return!0}}const Mt={addRow:wr,addColumn:_r,setCell:Yt,clearCells:tn,setRowHeight:en,setColumnWidth:Qt,insertRows:yr,insertColumns:Rr,setRowVisible:Er,setColumnVisible:br,mergeCells:vr,splitCells:Ir,removeRows:xr,removeColumns:Sr};function Mr(o){if(!(o in Mt)){console.warn(`There is no method named ${o} in IRGridCommandMap`);return}return Mt[o]}function Tr(o){if(o===V.name)return Mr}function Lr(o,e,t,n,r){const i=Tr(e);if(!i){console.warn("No component class in COMMAND_MAP.");return}const s=i(t);if(!s){console.warn("No command class in COMMAND_MAP.");return}o.pushCommand(new s(n,r))}function K(){return function(e,t,n){const r=n.value;return n.value=function(...i){const{commandManager:s}=this;return s?s.isRecording&&Lr(s,this.constructor.name,t,this,i):console.warn("No commandManager in this context"),r.apply(this,i)},n}}const rn=new WeakMap;function kr(o,e){rn.set(o,e)}function Hr(o){return rn.get(o)}var $=function(o,e,t,n){var r=arguments.length,i=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(o,e,t,n);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(i=(r<3?s(i):r>3?s(e,t,i):s(e,t))||i);return r>3&&i&&Object.defineProperty(e,t,i),i},zr=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=o[Symbol.asyncIterator],t;return e?e.call(o):(o=typeof __values=="function"?__values(o):o[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=o[i]&&function(s){return new Promise(function(a,u){s=o[i](s),r(a,u,s.done,s.value)})}}function r(i,s,a,u){Promise.resolve(u).then(function(c){i({value:c,done:a})},s)}};const J={grid:kn,gridWrapper:Hn,gridTable:zn,gridVariants:B},Tt={},Ar=["text/html","text/plain"];class V extends Bn{constructor(e){var t,n,r,i;super({contextElement:e.contextElement}),this._gridContext=new Ao(this),this._gridRangeUtils=new We(this),this._plugins=[],this._readonly=!1;const{contextElement:s,colHeader:a,rowHeader:u,body:c,defaultColumnCellFormat:l,plugins:h,storeOptions:f}=e;if(this._multipleCellMode=(t=e.multipleCellMode)!==null&&t!==void 0?t:!1,this._cursorManager=nn(this,!1),this._commandManager=new ao({context:this}),this.contextElement.tabIndex=-1,this._defaultColumnCellFormat={all:{editable:!0,text:""}},this._copyOptions=(n=e.copyOptions)!==null&&n!==void 0?n:{rowSpan:!0,colSpan:!0},l)for(const[d,w]of Object.entries(l))this._defaultColumnCellFormat[d]=Object.assign(this._defaultColumnCellFormat[d]||{},w);const R=()=>new Xt;this._gridStore=new Go(Object.assign({freezedColumnCount:0,freezedRowCount:0,headerColumnCount:(r=u==null?void 0:u.colCount)!==null&&r!==void 0?r:0,headerRowCount:(i=a==null?void 0:a.rowCount)!==null&&i!==void 0?i:0},f)),this.initGridCellPadding(),this._colHeaderInfo=Object.assign({rowCount:0,colCount:5,cellRenderer:R,defaultSize:this._gridStore.defaultColumnWidth,minSize:this._gridStore.defaultColumnMinSize,maxSize:this._gridStore.defaultColumnMaxSize},a),this._colHeaderInfo.minSize=Math.min(this._colHeaderInfo.defaultSize,this._colHeaderInfo.minSize),this._colHeaderInfo.maxSize=Math.max(this._colHeaderInfo.defaultSize,this._colHeaderInfo.maxSize),this._rowHeaderInfo=Object.assign({colCount:0,cellRenderer:R,defaultSize:this._gridStore.defaultRowHeight,minSize:this._gridStore.defaultRowMinSize,maxSize:this._gridStore.defaultRowMaxSize},u),this._rowHeaderInfo.minSize=Math.min(this._rowHeaderInfo.defaultSize,this._rowHeaderInfo.minSize),this._rowHeaderInfo.maxSize=Math.max(this._rowHeaderInfo.defaultSize,this._rowHeaderInfo.maxSize),this._bodyInfo=Object.assign({rowCount:5,colCount:0,cellRenderer:R},c),this.contextElement.classList.add(J.grid),this._tableElement=document.createElement("table"),this._divWrapper=document.createElement("div");const T=document.createElement("tbody");this._divWrapper.className=J.gridWrapper,this._divWrapper.tabIndex=-1,this._tableElement.classList.add(J.gridTable),this._tableElement.appendChild(this.colManager.colgroup),this._tableElement.appendChild(T),this._divWrapper.appendChild(this._tableElement),this.contextElement.appendChild(this._divWrapper),this.resizeObserver=new ResizeObserver(()=>{this._emitterController.emit("onWrapperResized",{}),this._debounceManager.addTask("virtualRender").addTask("generateScrollBarClass").addTask("updateSelection"),this.onResizeContext()}),this.resizeObserver.observe(this.contextElement),this.initPlugins(h!=null?h:[new qo({}),new Yo,new Zo({}),new Uo({enabledColResizer:!0,enabledRowResizer:!0}),new tr({memoInterval:500,tooltipInterval:500,hideTooltipWhenHasMemo:!0})]),this.addCoreElement(this._divWrapper),this._mergeManager=ur(this),this._emitterController=sr(this),this._generator=new le(this),this._selector=new Cr(this,this._gridContext,this._divWrapper),this._debounceManager=new Fo(this,this._gridContext,this._divWrapper,T,s,this._selector),this._gridContext.selectionRangeState.addSubscription((d,w)=>{(d==null?void 0:d.activeCell)!==(w==null?void 0:w.activeCell)&&(d==null||d.activeCell.deactivate(),w==null||w.activeCell.activate())}),this._gridContext.activateHeaderCellState.addSubscription((d,w)=>{d.forEach(H=>H.deactivate()),w.forEach(H=>H.activate())}),this._gridContext.selectionRangeState.addSubscription((d,w)=>{w?this._gridContext.activateHeaderCellState.next([...this._generator.getSelectionHeaderIterator(w.range)]):this._gridContext.activateHeaderCellState.next([])}),this._gridContext.selectionRangeState.addSubscription((d,w)=>{w?this.onSelectCell(w.activeCell):this.onActiveCellNull()}),this._gridContext.selectionRangeState.addSubscription((d,w)=>{var H;this.onSelectChanged((H=w==null?void 0:w.range)!==null&&H!==void 0?H:null)}),this._gridContext.gridModeState.addSubscription((d,w)=>{this.contextElement.dataset.mode=w.mode}),this._gridContext.gridModeState.next({mode:"idle",contextParam:{}}),this.initTableRowCol(),this.addGlobalEventListener(this.contextElement,"contextmenu",d=>{d.preventDefault();const{x:w,y:H}=fo(d);this.onContextMenu(d,this.findCellOrNull(H,w))})}get fixedRowCount(){return this._colHeaderInfo.rowCount}get canSelectMultipleCells(){return this._multipleCellMode}get firstRow(){return this.rowManager.firstRow}get lastRow(){return this.rowManager.lastRow}get rowManager(){return this._gridStore.rowManager}get colManager(){return this._gridStore.columnManager}get fixedColumnCount(){return this.colManager.freezedColumns}get width(){return this.colManager.columnsWidth}get height(){return this.rowManager.rowsHeight}get fixedRowHeight(){return this.rowManager.freezedRowsHeight}get fixedColumnWidth(){return this.colManager.fixedColumnsWidth}get scrollArea(){return{scrollTop:this.contextElement.scrollTop,scrollLeft:this.contextElement.scrollLeft,scrollHeight:this.contextElement.scrollHeight,scrollWidth:this.contextElement.scrollWidth}}get scrollTop(){return this.contextElement.scrollTop}get scrollLeft(){return this.contextElement.scrollLeft}get scrollBottom(){return this.contextElement.scrollTop+this.contextElement.clientHeight}get scrollRight(){return this.contextElement.scrollLeft+this.contextElement.clientWidth}get minColWidth(){return this._colHeaderInfo.minSize}get maxColWidth(){return this._colHeaderInfo.maxSize}get minRowHeight(){return this._rowHeaderInfo.minSize}get maxRowHeight(){return this._rowHeaderInfo.maxSize}get commandManager(){return this._commandManager}get headerRows(){return this.rowManager.headerRows}get headerColumns(){return this.colManager.headerColumns}get headerWidth(){return this.colManager.rowHeaderColumnsWidth}get headerHeight(){return this.rowManager.headerRowsHeight}get activeCell(){var e,t;return(t=(e=this._gridContext.selectionRangeState.value)===null||e===void 0?void 0:e.activeCell)!==null&&t!==void 0?t:null}set activeCell(e){if(e===this.activeCell)return;if(!e){this._gridContext.selectionRangeState.next(null);return}const t=this.getSelection();t?this._gridContext.selectionRangeState.next({activeCell:e,range:t}):this._gridContext.selectionRangeState.next({activeCell:e,range:{top:e.row,left:e.col,bottom:e.bottom,right:e.right}})}set readonly(e){this._readonly=e,this.rowManager.updateCellReadonlyStatus()}addPlugin(e){e.mount({grid:this,table:this._tableElement,contextElement:this.contextElement,emitController:this._emitterController,wrapperElement:this._divWrapper,gridContext:this._gridContext})}getColumnByLeft(e){const t=this.colManager.visibleColumnList;let n=0,r=t.length-1;for(;n<=r;){const i=n+Math.floor((r-n)/2),s=t[i];if(s.isBetweenLeft(e))return s;e<s.left?r=i-1:n=i+1}return null}setDefaultColumnCellFormat(e,t){this._defaultColumnCellFormat[e]=Object.assign({},t)}getRowByTop(e){return this.rowManager.getRowByTop(e)}removePlugin(e){e.unmount()}getMergeArea(e,t){const n=this.cell(e,t);if(n.mergeInfo)return{rowSpan:n.mergeInfo.rowSpan,colSpan:n.mergeInfo.colSpan};throw new Error("It's not a based cell!")}isMerged(e,t){return this._mergeManager.isMerged(e,t)}splitCells(e,t){this.forceLayoutTask(),this._mergeManager.splitCells(e,t),this._debounceManager.addTask("virtualRender")}mergeCells(e,t,n,r){this.forceLayoutTask(),this._mergeManager.mergeCells({top:e,left:t,bottom:n,right:r}),this._debounceManager.addTask("virtualRender");const i=this.getSelection();i&&this.selectRange(i.top,i.left,i.bottom,i.right)}undo(){this._commandManager.undo()}redo(){this._commandManager.redo()}findRowOrNull(e){const{scrollTop:t}=this,n=e<t+this.fixedRowHeight?{startIndex:0,endIndex:this.fixedRowCount,curIndex:Math.floor(this.fixedRowCount/2),scrollTop:t}:{startIndex:0,endIndex:this.rowManager.length,curIndex:Math.floor(this.rowManager.length/2),scrollTop:0};let r=this.rowManager.getRow(n.curIndex);for(;!(e>=n.scrollTop+r.top&&e<=n.scrollTop+r.bottom);){if(e<n.scrollTop+r.top){if(n.endIndex===n.curIndex)return null;n.endIndex=n.curIndex}else{if(n.startIndex===n.curIndex)return null;n.startIndex=n.curIndex}n.curIndex=Math.floor((n.startIndex+n.endIndex)/2),r=this.rowManager.getRow(n.curIndex)}return r}findCellOrNull(e,t){var n;const{scrollTop:r,scrollLeft:i}=this,s=e<r+this.fixedRowHeight?e-r:e,a=t<i+this.fixedColumnWidth?t-i:t,u=this.getRowByTop(s);if(!u)return null;const c=this.getColumnByLeft(a);if(!c)return null;const l=this.cell(u.rowId,c.columnId);return(n=l.mergeMain)!==null&&n!==void 0?n:l}getBaseCell(e,t){const n=this.cell(e,t);if(n.isMerged)return{row:n.row,col:n.col};if(n.mergeMain)return{row:n.mergeMain.row,col:n.mergeMain.col};throw new Error("It's not a merged cell!")}releaseCells(){this._gridContext.selectionRangeState.next(null),this._selector.releaseRange()}clearRows(){this.rowManager.clearRows(),this._commandManager.clearCommands(),this._debounceManager.addTask("resizeGridWrapperHeight").addTask("generateScrollBarClass").addTask("adjustSelection").addTask("updateSelection")}getColumnLeft(e){return this.colManager.getColumnLeft(e)}select(e,t=this.activeCell){this._gridContext.selectionRangeState.next({range:e,activeCell:t||this.cell(e.top,e.left)}),this._debounceManager.addTask("updateSelection")}selectRange(e,t,n,r,i=this.activeCell){this.select({top:e,left:t,bottom:n,right:r},i)}selectAll(){var e;this.selectRange(this.headerRows,this.headerColumns,this.getRowCount()-1,this.getColCount()-1,(e=this.activeCell)!==null&&e!==void 0?e:null)}getCellWidth(e){return e.mergeInfo?L.range(e.mergeInfo.colSpan).filter(t=>this.getColumnVisible(e.col+t)).reduce((t,n)=>t+this.getColumnWidth(e.col+n),0):this.getColumnWidth(e.col)}getCellHeight(e){return e.mergeInfo?L.range(e.mergeInfo.rowSpan).filter(t=>this.getRowVisible(e.row+t)).reduce((t,n)=>t+this.getRowHeight(e.row+n),0):this.getRowHeight(e.col)}getSelection(){var e,t;return(t=(e=this._gridContext.selectionRangeState.value)===null||e===void 0?void 0:e.range)!==null&&t!==void 0?t:null}scrollOnRow(e){this._debounceManager.isScheduled?this.afterRender(()=>this.scrollOnRowTask(e)):this.scrollOnRowTask(e)}forceLayoutTask(){this._debounceManager.forceRunTasks()}scrollOnCol(e){this._debounceManager.isScheduled?this.afterRender(()=>this.scrollOnColTask(e)):this.scrollOnColTask(e)}getPlugin(e){for(const t of this._plugins)if(t instanceof e)return t;throw new Error(`not found plugin ${e}`)}resetScroll(){this.contextElement.scrollTop=0,this.contextElement.scrollLeft=0}scrollInView(e,t){this.scrollOnRow(e),this.scrollOnCol(t)}focus(){this.contextElement.focus()}afterRender(e){this._debounceManager.addAfterRenderTask(e),this._debounceManager.addTask("nothing")}setText(e,t,n){this.setCell(e,t,{text:Number.isInteger(n)?n.toString():`${n||""}`})}getText(e,t){return this.cell(e,t).text}getCellUUID(e,t){var n;return(n=this.cell(e,t))===null||n===void 0?void 0:n.uuid}getValue(e,t){return this.cell(e,t).value}getColumnWidth(e){return this.colManager.getColumnWidth(e)}setColumnWidth(e,t){const n=D(t,this._colHeaderInfo.minSize,this._colHeaderInfo.maxSize);this.colManager.setColumnWidth(e,n),this.onResizeColumn(e),this._emitterController.emit("onColumnChanged",{left:e,right:e,type:"setWidth"}),this._debounceManager.addTask("updateLeft").addTask("generateScrollBarClass").addTask("updateSelection"),e<this.colManager.freezedColumns&&this._debounceManager.addTask("updateRowsStickyLeft")}getRowHeight(e){return this.rowManager.getRow(e).height}setRowHeight(e,t){const n=D(t,this.minRowHeight,this.maxRowHeight);this.rowManager.setRowHeight(e,n),this._debounceManager.addTask("virtualRender").addTask("updateTop").addTask("resizeGridWrapperHeight").addTask("generateScrollBarClass").addTask("updateSelection")}setRowTextColor(e,t){this.rowManager.getRow(e).textColor=t}getObject(e,t){return this.cell(e,t).object}setObject(e,t,n){this.cell(e,t).cellInfo={object:n}}cell(e,t){return this.getRow(e).getCell(t)}isBased(e,t){return this.cell(e,t).mergeMain===void 0}getCell(e,t){return this.cell(e,t).metaInfo}setCell(e,t,n){this.cell(e,t).cellInfo=n}setRowInfo(e,t){this.getRow(e).setRowInfo(t)}selectCell(e,t){this.selectRange(e,t,e,t,this.cell(e,t))}getRowCount(){return this.rowManager.length}getColCount(){return this.colManager.length}getLastRow(){return this.getRow(this.getRowCount()-1)}getFreezedRowCount(){return this.rowManager.freezedRows}getFreezedColumnCount(){return this.colManager.freezedColumns}getColumn(e){return this.colManager.getColumn(e)}getRow(e){return this.rowManager.getRow(e)}getRowLodash(){return this.rowManager.rowLodash}_addRow(e=this._rowHeaderInfo.defaultSize){const t=D(e,this.minRowHeight,this.maxRowHeight),n=this.createIRGridRow(this.rowManager.getNextRowId(),this.height,t);return this.rowManager.addRow(n),n.rowId}_createBulkRows(e,t){for(let n=0;n<e;n++)this._addRow(t);this._debounceManager.scheduleAddRowTasks()}addRow(e){return this._debounceManager.scheduleAddRowTasks(),this._addRow(e)}removeRow(e){return this.removeRows(e,e)}removeColumn(e){return this.removeColumns(e,e)}removeRows(e,t){if(e<this.headerRows)throw new Error("Could not remove rows in header rows!");if(t>=this.getRowCount())throw new Error(`Out of index. maximum bottom values is ${this.getRowCount()-1}. If you wanna clear all rows, please call clearRows()`);if(this._mergeManager.checkConflictingInRows(e,t))return!1;for(let n=e;n<=t;n++){const r=this.getRow(n);for(const i of r.getCellGenerator())i.isMerged&&this._mergeManager.removeMergeCell(i.row,i.col)}return this.rowManager.removeRows(e,t),this._debounceManager.addTask("updateTop").addTask("updateRowId").addTask("virtualRender").addTask("resizeGridWrapperHeight").addTask("generateScrollBarClass").addTask("adjustSelection"),!0}removeColumns(e,t){if(e<this.headerColumns)throw new Error(`the removing column left must be greater than or equal to rowHeaderColumn! (>= ${this.headerColumns})`);if(t>=this.getColCount())throw new Error(`out of index. maximum bottom value must be ${this.getColCount()-1}`);return this._mergeManager.checkConflictingInColumns(e,t)?!1:(this.rowManager.rowLodash.forEach(n=>{for(const r of n.getCellGenerator(e,t))r.isMerged&&this._mergeManager.removeMergeCell(r.row,r.col)}),this.rowManager.removeColumns(e,t),this.colManager.removeColumns(e,t),this._emitterController.emit("onColumnChanged",{left:e,right:t,type:"removeColumns"}),this._debounceManager.addTask("updateColumnId").addTask("updateLeft").addTask("generateScrollBarClass").addTask("adjustSelection"),e<this.colManager.freezedColumns&&this._debounceManager.addTask("updateRowsStickyLeft"),!0)}_addColumn(e=this._colHeaderInfo.defaultSize){const t=D(e,this.minColWidth,this.maxColWidth),n=this.colManager.addColumn(t);return this.rowManager.addColumn(r=>this.createIRGridCell(r.rowId,n.columnId)),this._emitterController.emit("onColumnChanged",{left:n.columnId,right:n.columnId,type:"addColumn"}),n.columnId}addColumn(e){return this._debounceManager.addTask("generateScrollBarClass"),this._addColumn(e)}insertRow(e,t){return this.insertRows(e,1,t)}insertRows(e,t=1,n=this._rowHeaderInfo.defaultSize){const r=this.getRowCount(),i=D(e,this.headerRows,r);if(!this._mergeManager.checkCanInsertRow(i))return!1;const s=D(n,this.minRowHeight,this.maxRowHeight);if(i===r){for(let u=0;u<t;u++)this.addRow(s);return!0}const a=L.range(t).map(u=>this.createIRGridRow(i+u,0,s));return this.rowManager.insertRows(i,a),this._debounceManager.addTask("updateTop").addTask("updateRowId").addTask("virtualRender").addTask("generateScrollBarClass").addTask("adjustSelection"),!0}insertColumn(e,t){return this.insertColumns(e,1,t)}insertColumns(e,t=1,n=this._colHeaderInfo.defaultSize){const r=this.getColCount(),i=D(e,this.headerColumns,r);if(!this._mergeManager.checkCanInsertColumn(e))return!1;const s=D(n,this.minColWidth,this.maxColWidth);if(i===r){for(let u=0;u<t;u++)this.addColumn(s);return!0}this.colManager.insertColumns(e,t,s),this.rowManager.insertColumns(e,t,(u,c)=>this.createIRGridCell(u,c));const a=this._debounceManager.addTask("updateColumnId").addTask("generateScrollBarClass").addTask("updateLeft").addTask("adjustSelection");return e<this.colManager.freezedColumns&&a.addTask("updateRowsStickyLeft"),!0}autoSizeColumn(e){this.autoSizeColumns(e,e)}autoSizeColumns(e,t){L.range(e,t+1).forEach(n=>{const r=Math.ceil(this.rowManager.rowLodash.map(i=>i.getCell(n)).filter(i=>i.visible&&i.mergeInfo.colSpan===1).flatMap(i=>i.innerWidth).reduce((i,s)=>Math.max(i,s),0));r!==this.getColumnWidth(n)&&this.setColumnWidth(n,D(r,this._colHeaderInfo.minSize,this._colHeaderInfo.maxSize))},!1)}autoSizeRow(e){this.autoSizeRows(e,e)}autoSizeRows(e,t){L.range(e,t+1).forEach(n=>{const r=this.rowManager.getRow(n).rowInnerHeight;r!==this.getRowHeight(n)&&this.setRowHeight(n,r)})}copyToClipboard(){if(!this.getSelection()){console.warn("No selection detected.");return}this.focus(),document.execCommand("copy")}_hasToSplitBeforePasting(e){return!this._copyOptions.rowSpan&&!this._copyOptions.colSpan?!1:e.flat().some(t=>t.rowSpan>1||t.colSpan>1)}async _createClipboardGetter(){var e,t,n,r,i;const s={"ir-grid/cell":"","text/html":"","text/plain":""};try{const l=(await An.read()).flat();try{for(var a=!0,u=zr(l),c;c=await u.next(),e=c.done,!e;a=!0){r=c.value,a=!1;const h=r;for(const f of Ar)s[f]===""&&h.types.includes(f)&&(s[f]=await Dn(await h.getType(f)))}}catch(h){t={error:h}}finally{try{!a&&!e&&(n=u.return)&&await n.call(u)}finally{if(t)throw t.error}}}catch(l){console.warn("pasteFromClipboard warning! it expects https protocol and clipboard permission.",l),s["ir-grid/cell"]=(i=Hr(Tt))!==null&&i!==void 0?i:""}return{getData(l){var h;return(h=s[l])!==null&&h!==void 0?h:""}}}async pasteFromClipboard(){const e=this.getSelection();if(!e){console.warn("no selection, it needs selection to paste");return}this.paste(e,pt(await this._createClipboardGetter()))}paste(e,t){if(t.length===0){console.warn("No clipboard data to paste");return}const n=bo(this,this._copyOptions),r=n.getPastingRange(e,t);this._hasToSplitBeforePasting(t)&&this.splitCellsByRange(r);const i=n.beforePastingList(r,t);i.length!==0&&(this.onClipboardBeforePaste(r),n.pasteTask(i),this.onClipboardAfterPaste(r),this.select(r))}hasRow(e){return e<this.getRowCount()}hasColumn(e){return e<this.getColCount()}clearCells(e){for(const t of this._generator.getSelectionGenerator(e))this.onClearCellCheck(t)&&t.clear()}setRowVisible(e,t){return this._mergeManager.checkConflictingInRows(e,e)?!1:(t===this.getRowVisible(e)||(this.rowManager.setRowVisible(e,t),this._debounceManager.addTask("updateTop").addTask("virtualRender").addTask("resizeGridWrapperHeight").addTask("generateScrollBarClass").addTask("updateSelection")),!0)}getRowVisible(e){return this.rowManager.getRow(e).visible}setColumnVisible(e,t){return this._mergeManager.checkConflictingInColumns(e,e)?!1:(t===this.getColumnVisible(e)||(this.colManager.setColumnVisible(e,t),this.rowManager.setColumnVisible(e,t),this._debounceManager.addTask("updateLeft").addTask("generateScrollBarClass").addTask("updateSelection"),e<this.colManager.freezedColumns&&this._debounceManager.addTask("updateRowsStickyLeft"),this._emitterController.emit("onColumnChanged",{left:e,right:e,type:"setVisible"})),!0)}getColumnVisible(e){return this.colManager.getColumn(e).visible}createFinder(e={}){return lr(this,e)}selectColumn(e){this.selectColumns(e,e)}selectColumns(e,t){e<this.headerColumns||this.headerRows<this.getRowCount()&&this.selectRange(this.headerRows,e,this.getRowCount()-1,t,this.cell(this.headerRows,e))}selectRow(e,t=this.activeCell){this.selectRows(e,e,t)}selectRows(e,t,n=this.activeCell){e<this.headerRows||this.selectRange(e,this.headerColumns,t,this.getColCount()-1,n!=null?n:this.cell(e,this.headerColumns))}freezeRows(e){this.rowManager.freezeRows(e),this._debounceManager.addTask("updateSelection")}freezeColumns(e){this.freezeColumn(e+1-this.headerColumns),this._debounceManager.addTask("updateSelection")}freezeColumn(e){if(e<0)throw new Error("Could not be freezing minus columns!");if(e>this.getColCount()-this.headerColumns)throw new Error("Could not be freezing after last column");this.colManager.freezeColumns(e),this._debounceManager.addTask("updateSelection").addTask("updateRowsStickyLeft")}clearUndoStack(){this.commandManager.clearCommands()}setClipboardOptions(e){Object.assign(this._copyOptions,e)}sort(e,t,n,r){const i=Math.max(n!=null?n:this.headerRows,this.headerRows),s=Math.min(r!=null?r:this.getRowCount(),this.getRowCount());this.rowManager.sort(e,t,i,s),this._debounceManager.addTask("updateTop").addTask("updateRowId").addTask("virtualRender").addTask("adjustSelection")}splitCellsByRange(e){for(const t of this._generator.getSelectionGenerator(e)){const n=t.mergeInfo.rowSpan>1||t.mergeInfo.colSpan>1?t:t.mergeMain;n&&this.splitCells(n.row,n.col)}}selectMultipleCellAddress(e){e.length>0&&this.selectCell(e[0][0],e[0][1])}selectMultipleCells(e){e.length>0&&this.selectCell(e[0].row,e[0].col)}getSelectionMode(){return"range"}getSelectedCells(){const e=this.getSelection();return e?[this.cell(e.top,e.left)]:[]}getSelectedMultipleCellAddress(){const e=this.getSelection();return e?[[e.top,e.left]]:[]}isSelectedSingleCell(){const e=this.getSelection();if(!e)return!1;const{top:t,left:n,bottom:r,right:i}=e;if(t===r&&n===i)return!0;const s=this.getRow(t).getCell(n);return r===s.bottom&&i===s.right}render(){this.rowManager.renderRows()}onSelectCell(e){}onActiveCellNull(){}onResizeContext(){}onResizeColumn(e){}onEditCellDone(e,t,n,r,i,s){}onSelectChanged(e){}onClearCell(e){}onClearCellCheck(e){return e.canClear}onColumnClick(e){}onRowClick(e){}onCreatingCell(e){}onCellRightClick(e,t){}onEditKeyDown(e,t,n,r){}onMountedRow(e){}onClipboardBeforePasteCell(e,t){return!0}onClipboardBeforePaste(e){}onClipboardAfterPasteCell(e){}onClipboardAfterPaste(e){}onAutoInsertRow(e){return!0}onAutoInsertColumn(e){return!0}onDoubleClickCell(e){}onDropOnCell(e,t,n){}onDragStartCell(e,t){return!t.dataTransfer||!e.metaInfo.object?!1:(t.dataTransfer.setData("application/json",JSON.stringify(e.metaInfo.object)),!0)}onCheckPasteCell(e,t){return e.visible&&e.onCheckReadonly()!==!0&&e.metaInfo.disabled!==!0&&e.metaInfo.clipboardEnabled!==!1&&this.onClipboardBeforePasteCell(e,t)}onUndo(e){}onRedo(e){}onNativeCopy(e){if(!e.clipboardData)throw new Error("Invalid ClipboardEvent");const t=this.getSelection();if(!t)throw new Error("Detected copy without selection");const r=this._gridRangeUtils.getCellMatrixByRange(t).map(i=>i.map(s=>({text:s.text,cellVisible:s.mergeMain===void 0,rowSpan:s.mergeInfo.rowSpan,colSpan:s.mergeInfo.colSpan,isFormatted:!1})));Mo(e.clipboardData,r),kr(Tt,JSON.stringify(r)),this.focus(),this.onCopy(),e.preventDefault()}onNativeCut(e){const t=this.getSelection();if(!t)throw new Error("Detected copy without selection");this.onNativeCopy(e),this.commandManager.doRecording("Cut",()=>{this.clearCells(t)}),e.preventDefault()}onNativePaste(e){if(!e.clipboardData)throw new Error("Invalid ClipboardEvent");const t=this.getSelection();if(!t)throw new Error("it needs selection to paste");const n=pt(e.clipboardData);this.commandManager.doRecording("Paste",()=>{this.paste(t,n)}),e.preventDefault()}doEditMode(e,t,n=!1){if(!e.element.isConnected||!e.editable)return!1;const r=new or(e);r.onEditDone=(i,s,a,u,c,l)=>{this.onEditCellDone(i,s,a,u,c,l),this.focus(),this._gridContext.gridModeState.value.mode==="edit-cell"&&this._gridContext.setIdle()},r.onEditKeyDown=(i,s,a,u)=>this.onEditKeyDown(i,s,a,u),r.onMoveLeftOnEdit=()=>this._cursorManager.selectNextSelection(0,-1,!1),r.onMoveUpOnEdit=()=>this._cursorManager.selectNextSelection(-1,0,!1),r.onMoveRightOnEdit=()=>this._cursorManager.selectNextSelection(0,1,!1),r.onMoveDownOnEdit=()=>this._cursorManager.selectNextSelection(1,0,!1),r.onTabOnEdit=(i,s)=>{s?this._cursorManager.selectBeforeActiveCell():this._cursorManager.selectNextActiveCell()},r.onEnterOnEdit=()=>{const i=this._cursorManager.getNextYBelow(e.row,e.col,1);e.row!==i&&(this.selectCell(i,e.col),this.doEditMode(this.cell(i,e.col)))};try{return this._gridContext.gridModeState.next({mode:"edit-cell",contextParam:{cell:e}}),r.runEditMode(t,n),!0}catch(i){return console.error("IRGrid.doEditMode Error!",i),!1}}onCopy(){}onContextMenu(e,t){}onDragOverCell(e,t){return!0}scrollOnColTask(e){const t=this.getColumnLeft(e),n=t+this.getColumnWidth(e),{fixedColumnWidth:r,scrollRight:i,scrollLeft:s}=this,a=s+r;i<n?this.contextElement.scrollLeft=s+(n-i):a>t&&(this.contextElement.scrollLeft=t-r)}scrollOnRowTask(e){const t=this.getRow(e),n=t.top,r=t.top+t.height,{scrollBottom:i,fixedRowHeight:s,scrollTop:a}=this,u=a+s;i<r?this.contextElement.scrollTop=a+(r-i):u>n&&(this.contextElement.scrollTop=n-s)}onCheckCellReadonly(e){return this._readonly?!0:e.metaInfo.readonly===!0}initPlugins(e){try{for(const t of e)t.mount({grid:this,table:this._tableElement,contextElement:this.contextElement,emitController:this._emitterController,wrapperElement:this._divWrapper,gridContext:this._gridContext}),this._plugins.push(t)}catch(t){console.error("Plugin init error",t)}}initTableRowCol(){L.range(this._colHeaderInfo.colCount).forEach(()=>this.addColumn(this._colHeaderInfo.defaultSize)),this._createBulkRows(this._colHeaderInfo.rowCount+this._bodyInfo.rowCount)}initColumnHeaderCell(e){e.cellType="col-header",e.onClick=()=>{this.contextElement.classList.contains("is-resizing")||this.onColumnClick(e)}}initRowHeaderCell(e){e.cellType="row-header",e.onClick=()=>{this.contextElement.classList.contains("is-resizing")||this.onRowClick(e)}}initBodyCell(e){e.cellType="body-cell",e.onClear=()=>this.onClearCell(e),e.onDblClick=()=>this.onDoubleClickCell(e)}initGridCellPadding(){const{top:e,left:t,bottom:n,right:r}=this._gridStore.cellPadding;Z(this.contextElement,{[J.gridVariants.cellTopPadding]:`${e}px`,[J.gridVariants.cellLeftPadding]:`${t}px`,[J.gridVariants.cellBottomPadding]:`${n}px`,[J.gridVariants.cellRightPadding]:`${r}px`})}getCellRenderer(e,t,n,r){if(e==="col-header")return this._colHeaderInfo.cellRenderer;if(e==="row-header")return this._rowHeaderInfo.cellRenderer;if(e==="body-cell")return this._bodyInfo.cellRenderer;throw new Error("cellType must be 'col-header' or 'row-header' or 'body-cell'")}getCellType(e,t){const n=e<this.headerRows,r=!n&&t<this.headerColumns;return n?"col-header":r?"row-header":"body-cell"}getDefaultCellFormat(e,t){const n={emitter:this._emitterController.emitter,commandManager:this,getGridStore:()=>this._gridStore};return Object.assign(n,Object.assign(Object.assign({},this._defaultColumnCellFormat.all),this._defaultColumnCellFormat[t])),e==="col-header"?Object.assign(n,this._defaultColumnCellFormat[`col_header_${t}`]):e==="row-header"?Object.assign(n,this._defaultColumnCellFormat[`row_header_${t}`]):Object.assign(n,this._defaultColumnCellFormat[`body_${t}`]),n}createIRGridCell(e,t){const n=this.getCellType(e,t),r=n.endsWith("header")?"th":"td",i=this.getDefaultCellFormat(n,t),s=this.getCellRenderer(n,e,t,i),a=new Wo({row:e,col:t,tag:r,cellRenderer:s,metaInfo:i});return a.onRightClick=(u,c)=>this.onCellRightClick(u,c),a.onCheckReadonly=()=>this.onCheckCellReadonly(a),n==="col-header"?this.initColumnHeaderCell(a):n==="row-header"?this.initRowHeaderCell(a):this.initBodyCell(a),this.onCreatingCell(a),a}createIRGridRow(e,t,n){const r=new Bo({grid:this,rowId:e,height:n,top:t,rowType:e<this.headerRows?"header":"body"});return L.range(this.getColCount()).forEach(i=>r.addCell(this.createIRGridCell(e,i))),L.range(this.getColCount()).filter(i=>this.getColumnVisible(i)===!1).forEach(i=>r.setColumnVisible(i,!1)),r.onMounted=()=>{r.freezeColumns(this._rowHeaderInfo.colCount),this.onMountedRow(r.rowId)},r.onChangedHeight=()=>{L.range(this.getColCount()).forEach(i=>{const s=r.getCell(i),a=s.mergeMain?s.mergeMain:s.mergeInfo.rowSpan>1?s:null;a&&(a.height=this._mergeManager.getMergedRowHeight(a.row,a.row+a.mergeInfo.rowSpan-1))})},r}}$([K()],V.prototype,"splitCells",null);$([K()],V.prototype,"mergeCells",null);$([K()],V.prototype,"setColumnWidth",null);$([K()],V.prototype,"setRowHeight",null);$([K()],V.prototype,"setCell",null);$([K()],V.prototype,"addRow",null);$([K()],V.prototype,"removeRows",null);$([K()],V.prototype,"removeColumns",null);$([K()],V.prototype,"addColumn",null);$([K()],V.prototype,"insertRows",null);$([K()],V.prototype,"insertColumns",null);$([K()],V.prototype,"clearCells",null);$([K()],V.prototype,"setRowVisible",null);$([K()],V.prototype,"setColumnVisible",null);fe().setStoreValue("grid.defaultFontSize","13px");fe().setStoreValue("grid.defaultFontFamily","Pretendard");const Lt=({text:o})=>O(Ot,{children:ue("header",{className:"flex flex--none justify-content--space-between py--xs px--xxl background--sapphire-pattern",children:[O("div",{className:"flex--none",children:ue("div",{className:"text-switch",children:[O("button",{type:"button",className:"text-switch__button is-active",children:"개발"}),O("button",{type:"button",className:"text-switch__button",children:"검증"}),O("button",{type:"button",className:"text-switch__button",children:"운영"})]})}),O("div",{className:"flex flex--none align-self--center text--white",children:O("h2",{children:o})}),ue("div",{className:"flex flex--none align-self--center gap-x--xl",children:[O("button",{type:"button",className:"icon-button icon-button--md",children:O("i",{className:"ir-icon ir-icon--home-fill ir-icon--white"})}),O("button",{type:"button",className:"icon-button icon-button--md",children:O("i",{className:"ir-icon ir-icon--user-outline ir-icon--white"})}),O("button",{type:"button",className:"icon-button icon-button--md",children:O("i",{className:"ir-icon ir-icon--user-management-outline ir-icon--white"})}),O("button",{type:"button",className:"icon-button icon-button--md",children:O("i",{className:"ir-icon ir-icon--preference-outline ir-icon--white"})}),O("button",{type:"button",className:"icon-button icon-button--md",children:O("i",{className:"ir-icon ir-icon--information-circle-outline ir-icon--white"})}),O("button",{type:"button",className:"icon-button icon-button--md",children:O("i",{className:"ir-icon ir-icon--logout-outline ir-icon--white"})})]})]})}),Or=`
:root {
    --ir-input-default-height: 28px;
    --tag-default-height: 28px;
}

#storybook-root {
    height: 100%;
}
`,Kr=()=>O("style",{children:Or}),kt=({children:o})=>O(Ot,{children:ue("footer",{children:[o,ue("div",{className:"flex justify-content--space-between py--xs px--sm text--tertiary text--h4 border-t--px",children:[O("span",{children:"김이노"}),O("span",{children:"Copyright 2022. INNORULES Corporation. All rights reserved."}),O("span",{children:"InnoProduct Web 5.3"})]})]})});function $r(){Ae.useEffect(()=>{document.querySelector("html").dataset.v2Theme="true"},[])}function Ht(o){Ae.useEffect(()=>{const e=[...document.querySelectorAll(o)].map(t=>new sn(t));return()=>e.forEach(t=>t.destroy())},[o])}function zt(o){Ae.useEffect(()=>{const e=[...document.querySelectorAll(o)].map(t=>new ln({div:t,checkbox:t.dataset.irDatePickerCheckbox}));return()=>e.forEach(t=>t.destroy())},[o])}function At(o){Ae.useEffect(()=>{const e=[...document.querySelectorAll(o)].map(t=>new V({contextElement:t,colHeader:{rowCount:1},rowHeader:{colCount:1}}));return()=>e.forEach(t=>t.destroy())},[o])}try{Ht.displayName="useIRSelect",Ht.__docgenInfo={description:"",displayName:"useIRSelect",props:{}}}catch{}try{zt.displayName="useIRDatePicker",zt.__docgenInfo={description:"",displayName:"useIRDatePicker",props:{}}}catch{}try{At.displayName="useIRGrid",At.__docgenInfo={description:"",displayName:"useIRGrid",props:{}}}catch{}try{Lt.displayName="PFHeader",Lt.__docgenInfo={description:"",displayName:"PFHeader",props:{text:{defaultValue:null,description:"",name:"text",required:!1,type:{name:"string"}}}}}catch{}try{kt.displayName="PFFooter",kt.__docgenInfo={description:"",displayName:"PFFooter",props:{}}}catch{}export{Kr as P,Ht as a,zt as b,At as c,Lt as d,kt as e,$r as u};
