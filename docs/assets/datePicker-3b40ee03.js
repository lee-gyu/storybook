import{g as M,e as s,d as b,i as P,_ as H,b as N,c as O,f as S,I as A}from"./timePicker.elements-3c8a0aec.js";import{k as $,D as V,b as Y,a as F,g as R,o as B,c as W,I as U}from"./index-d6235da7.js";const x="checkbox",_={checkbox:{"&":x},checkboxInput:{"&":`${x}__input`},checkboxWrapper:{"&":`${x}__wrapper`},text:{"&":`${x}__text`}},K=()=>{const i=document.createElement("div");return i.className="tooltip",{tooltipElement:i,updateText(t){i.textContent=t}}},X=(()=>{let i=null;return()=>(i||(i=K()),i)})(),j=i=>{const{refElement:t,label:p="",offset:r=8,placement:m="bottom",refMode:h="element"}=i,{tooltipElement:l,updateText:d}=X();let u=t;const c=()=>{$(u,l,{placement:m,middleware:[V(r),Y(),F({padding:5})]}).then(({x:v,y:D})=>{l.style.left=`${v}px`,l.style.top=`${D}px`})},f=v=>{u=R(v.clientX,v.clientY),c()},a=()=>{d(p),M("popover").appendChild(l),c()},e=()=>{a(),t.addEventListener("mousemove",f)},o=()=>{l.remove(),t.removeEventListener("mousemove",f)},n=h==="element"?a:e;return t.addEventListener("mouseenter",n),t.addEventListener("mouseleave",o),{destroy(){o(),t.removeEventListener("mouseenter",n),t.removeEventListener("mouseleave",o)},hide(){return o(),this},show(){return this.update(),a(),this},update(){return c(),this}}},g=i=>(i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),i),q=6,G=7,Z=32,z=0,J=({uuid:i,refElement:t,onClick:p,minDate:r,maxDate:m})=>{let h=!1,l=()=>{},d=null;g(r),g(m);const u=W({eventElements:[s.datePicker],clickOutsideFunc:()=>c.hide()}),c={get visible(){return h},update(a,e){const o=new Date,n=g(new Date(a)),v=n.getMonth();s.headerPrev.onclick=()=>{a.setDate(z),this.update(a,e)},s.headerNext.onclick=()=>{a.setDate(Z),this.update(a,e)},s.headerPrevYear.onclick=()=>{a.setFullYear(a.getFullYear()-1),this.update(a,e)},s.headerNextYear.onclick=()=>{a.setFullYear(a.getFullYear()+1),this.update(a,e)},s.todayButton.onclick=()=>{p.call(null,o),this.update(o,o)};const D=o<r||o>m;s.todayButton.disabled=D;const y=s.todayButton.parentElement;D&&y&&d==null&&(d=j({refElement:y,label:P.datePicker.disabledTodayTooltip,placement:"bottom"})),s.updateI18n(),s.headerTitle.innerText=b(n).format(P.datePicker.titleFormat),n.setDate(1),n.setDate(-(n.getDay()-1)),s.contentTableTbody.innerHTML="",H.range(q).forEach(()=>{const L=document.createElement("tr");for(let w=0;w<G;w++){const k=document.createElement("td"),T=new Date(n);k.innerText=`${n.getDate()}`,k.onclick=()=>p(T),T<r||T>m?k.classList.add("is-disabled"):n.getMonth()!==v?k.classList.add("is-diff-month"):n.getTime()===(e==null?void 0:e.getTime())&&k.classList.add("is-selected"),L.appendChild(k),n.setDate(n.getDate()+1)}s.contentTableTbody.appendChild(L)})},show(){h=!0,s.datePicker.isConnected||M("popover").appendChild(s.datePicker),s.datePicker.style.removeProperty("display"),s.datePicker.setAttribute("data-for",i),u.create(),f.create(),setTimeout(()=>{s.datePicker.classList.add(N.datePicker["is-visible"]),l(),l=B(t,s.datePicker)},0)},hide(){u.destroy(),f.destroy(),d&&(d.destroy(),d=null);const a=e=>{e.currentTarget===e.target&&(h=!1,s.datePicker.removeEventListener("transitionend",a),i===s.datePicker.getAttribute("data-for")&&(l(),s.datePicker.remove()))};s.datePicker.addEventListener("transitionend",a),s.datePicker.classList.remove(N.datePicker["is-visible"])},onESC(){this.hide()}},f=O(c);return c},E="input",C={input:{"&":E},inputNative:{"&":`${E}__native`},inputSuffix:{"&":`${E}__suffix`},inputPrefix:{"&":`${E}__prefix`}},I=(i,t)=>i instanceof Date?b(i).startOf("D"):typeof i=="string"?b(i,t):b(null);class te extends U{constructor({div:t,defaultDate:p,format:r=P.datePicker.dateFormat,checkbox:m=!1,disabled:h=!1,allowedEmptyString:l=!0,onSelect:d,onChange:u,onCheckboxClick:c,minDate:f=A.datePicker.minDate,maxDate:a=A.datePicker.maxDate}){if(super({contextElement:t}),this.selectedDate=null,this.calendarDate=new Date,p){const e=I(p,r);e.isValid()?(this.calendarDate=e.toDate(),this.selectedDate=e.toDate()):console.error(`invalid defaultDate format. it must follow ${r}`)}if(!l&&this.selectedDate==null){const e=I(new Date,r);this.calendarDate=e.toDate(),this.selectedDate=e.toDate()}if(this.format=r,this.div=t,this.input=document.createElement("input"),this.button=document.createElement("button"),this.button.appendChild(S("ir-icon--calendar")),this.div.innerHTML="",this.div.classList.add(C.input["&"]),this.input.setAttribute("type","text"),this.input.setAttribute("placeHolder",this.format),this.input.className=C.inputNative["&"],this.button.className=C.inputSuffix["&"],this.button.type="button",this._minDate=f,this._maxDate=a,d&&(this.onSelect=d),u&&(this.onChange=u),c&&(this.onCheckboxClick=c),m){const e=document.createElement("div"),o=document.createElement("label"),n=document.createElement("input");n.setAttribute("type","checkbox"),e.classList.add(_.checkbox["&"],C.inputPrefix["&"]),o.className=_.checkboxWrapper["&"],n.className=_.checkboxInput["&"],o.appendChild(n),e.appendChild(o),this.div.appendChild(e),n.checked=!h,n.onchange=()=>{this.disabled=!n.checked,this.onCheckboxClick(n.checked)},this.addCoreElement(e)}this.disabled=h,this.div.appendChild(this.input),this.div.appendChild(this.button),this.addCoreElement(this.input),this.addCoreElement(this.button),this.selectedDate&&(this.input.value=b(this.selectedDate).format(r)),this.button.addEventListener("click",()=>{this.isVisible===!1&&this.show()}),this.input.addEventListener("blur",()=>{if(this.input.value===""){l?this.setDate(null):this.setDate(this.selectedDate);return}const e=b(this.input.value,this.format,!0);!e.isValid()||e.toDate()<this.minDate||e.toDate()>this.maxDate?this.setDate(this.selectedDate):this.setDate(e.toDate())}),this.handler=J({uuid:this.uuid,refElement:this.div,minDate:this._minDate,maxDate:this._maxDate,onClick:e=>{this.setDate(e),this.onSelect(e),this.hide()}})}get textValue(){return this.input.value}get inputCheckbox(){return this.div.querySelector(".checkbox__input")}get date(){return this.selectedDate}get isVisible(){return this.handler.visible}get disabled(){return this.input.hasAttribute("disabled")}get minDate(){return this._minDate}get maxDate(){return this._maxDate}set minDate(t){this._minDate=t}set maxDate(t){this._maxDate=t}set disabled(t){t?(this.input.setAttribute("disabled",""),this.button.setAttribute("disabled","")):(this.input.removeAttribute("disabled"),this.button.removeAttribute("disabled")),this.inputCheckbox&&(this.inputCheckbox.checked=!t)}setDate(t){t?(this.selectedDate=new Date(t),this.calendarDate=new Date(t),this.input.value=b(t).format(this.format),this.updateCalendar()):(this.selectedDate=null,this.input.value=""),this.latestValue!==this.input.value&&this.onChange(this.input.value),this.latestValue=this.input.value}show(){this.isVisible||(this.handler.update(this.calendarDate,this.selectedDate),this.handler.show())}hide(){this.isVisible&&this.handler.hide()}onSelect(t){}onChange(t){}onCheckboxClick(t){}updateCalendar(){this.handler.update(this.calendarDate,this.selectedDate)}}export{te as I};
//# sourceMappingURL=datePicker-3b40ee03.js.map
