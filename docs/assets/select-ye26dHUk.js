import{A as u,M as p,G as m,O as v,E as f,Z as I,j as D,J as E,q as w,N as C}from"./index-DkI8zks2.js";import{c as S,_ as h,a as b}from"./timePicker.elements-Q0xqtR9Q.js";import{I as V,c as L,g,o as x}from"./index--oTrqKKK.js";const l={select:u,selectDropdown:p,selectDropdownList:m,selectDropdownButton:v,selectDropdownItem:f,selectDropdownIcon:I,selectInput:D,selectInputNative:E,selectInputIcon:w,selectDropdownItemSelected:C},y=()=>{const a=document.createElement("div"),e=document.createElement("ul");return a.classList.add(l.selectDropdown,b.zIndex.popover),e.className=l.selectDropdownList,a.appendChild(e),{divDropdown:a,ulItems:e}},A=(a,e)=>{const t=document.createElement("li"),i=document.createElement("button"),n=document.createElement("i"),o=document.createElement("span");return o.innerText=e,i.type="button",i.title=e,i.className=l.selectDropdownButton,t.className=l.selectDropdownItem,t.setAttribute("ir-select-value",a),n.classList.add(l.selectDropdownIcon,"ir-icon","ir-icon--check"),i.appendChild(n),i.append(o),t.append(i),{item:t,button:i,icon:n,span:o}};class O extends V{constructor(e){var t;super({contextElement:e instanceof HTMLSelectElement?e:e.contextElement}),this.floatingCleanup=()=>{},this.divSelect=document.createElement("div"),this.divInput=document.createElement("div"),this.inputValue=document.createElement("input");const i=y();this.divDropDown=i.divDropdown,this.ulItems=i.ulItems,this.items=[],this.select=this.contextElement;const n=document.createElement("i");this.inputValue.readOnly=!0,this.inputValue.type="text",this.divSelect.classList.add(l.select),this.select.classList.forEach(s=>this.divSelect.classList.add(s)),this.divInput.className=l.selectInput,this.inputValue.className=l.selectInputNative,n.classList.add(l.selectInputIcon,"ir-icon","ir-icon--chevron-down"),this.divInput.appendChild(this.inputValue),this.divInput.appendChild(n),this.divDropDown.appendChild(this.ulItems),this.divSelect.appendChild(this.divInput);const o=this.select.value;this._value="",Array.from(this.select.children).map(s=>s).forEach(s=>{const c={};for(let d=0;d<s.attributes.length;++d){const r=s.attributes.item(d);if(!r)return;c[r.name]=r.value}this.addItem(s.value,s.text,c),s.remove()}),e instanceof HTMLSelectElement?this.value=o:(e.onChange&&(this.onChange=e.onChange),this.disabled=(t=e.disabled)!==null&&t!==void 0?t:!1,e.defaultValue!==null&&(this.value=e.defaultValue||o),e.placeholder&&(this.inputValue.placeholder=e.placeholder)),this.select.insertAdjacentElement("beforebegin",this.divSelect),this.select.style.display="none",this.divInput.onclick=()=>this.toggle(),this.addCoreElement(this.divSelect),this.escController=S(this),this.outsideHandler=L({eventElements:[this.divSelect,this.divDropDown],clickOutsideFunc:()=>this.hide()})}get listItems(){return[...this.items]}get disabled(){return this.inputValue.hasAttribute("disabled")}get value(){return this._value}get text(){return this.inputValue.value}set disabled(e){e?this.inputValue.setAttribute("disabled","true"):this.inputValue.removeAttribute("disabled")}set value(e){if(this._value!==e)if(this.hasElementByValue(e))this.selectItem(e);else throw new Error(`There is no '${e}' value`)}clearItems(){this.lastClickedOption=void 0,this.items.forEach(({element:e,option:t})=>{e.remove(),t.remove()}),this.items=[],this.inputValue.value="",this.select.value="",this._value=""}removeItem(e){this.items.filter(t=>t.value===e).forEach(({element:t,option:i})=>{t.remove(),i.remove()}),this.items=this.items.filter(t=>t.value!==e)}expand(){this.disabled||(this.divDropDown.style.width=`${this.divSelect.offsetWidth}px`,this.divDropDown.isConnected||g("popover").appendChild(this.divDropDown),this.escController.create(),this.outsideHandler.create(),setTimeout(()=>{this.divSelect.classList.add("is-expanded"),this.divDropDown.classList.add("is-expanded"),this.floatingCleanup(),this.floatingCleanup=x(this.divSelect,this.divDropDown)},0))}hide(){this.floatingCleanup(),this.escController.destroy(),this.outsideHandler.destroy(),this.divSelect.classList.remove("is-expanded"),this.divDropDown.classList.remove("is-expanded"),this.divDropDown.addEventListener("transitionend",e=>{e.currentTarget===e.target&&this.divDropDown.remove()},{once:!0})}toggle(){this.divSelect.classList.contains("is-expanded")?this.hide():this.expand()}addItem(e,t,i={}){const{item:n,button:o}=A(e,t),s=document.createElement("option");return Object.entries(i).forEach(([c,d])=>s.setAttribute(c,d)),s.value=e,s.innerText=t,this.select.appendChild(s),this.items.push({text:t,value:e,element:n,option:s,attr:i}),this.ulItems.appendChild(n),n.onclick=c=>{this.lastClickedOption!==s&&(this.clearSelectedStatus(),this.changeValue({text:t,value:e,attr:i,element:n,option:s})),this.hide()},o}onChange(e,t){}setValueWithoutEvent(e){if(this._value!==e)if(this.hasElementByValue(e))this.selectItem(e,!1);else throw new Error(`There is no '${e}' value`)}hasElementByValue(e){return h(this.ulItems.querySelectorAll("[ir-select-value]")).map(t=>t).some(t=>t.getAttribute("ir-select-value")===e)}clearSelectedStatus(){h(this.items).forEach(({element:e})=>e.classList.remove(l.selectDropdownItemSelected))}selectItem(e,t=!0){this.clearSelectedStatus(),h(this.items).dropWhile(i=>i.value!==e).take(1).forEach(i=>this.changeValue(i,t))}changeValue({text:e,value:t,option:i,element:n},o=!0){this.lastClickedOption=i,n.classList.add(l.selectDropdownItemSelected),this.inputValue.value=e,this.select.value=t,this._value=t,o&&this.onChange(this.select,i)}}export{O as I};
