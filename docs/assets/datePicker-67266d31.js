import{e,d as o,i as g,_ as y,b as P,c as w,f as A}from"./timePicker.elements-9fc1c89b.js";import{o as L,c as N,I as S}from"./index-9b2db4e0.js";const k="checkbox",C={checkbox:{"&":k},checkboxInput:{"&":`${k}__input`},checkboxWrapper:{"&":`${k}__wrapper`},text:{"&":`${k}__text`}},_=n=>(n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),n),H=6,M=7,I=32,V=0,O=({uuid:n,refElement:i,onClick:p,minDate:r,maxDate:b})=>{let c=!1,d=()=>{};_(r),_(b);const m=N({eventElements:[e.datePicker],clickOutsideFunc:()=>l.hide()}),l={get visible(){return c},update:function(t,a){const s=_(new Date(t)),T=s.getMonth();e.headerPrev.onclick=()=>{t.setDate(V),this.update(t,a)},e.headerNext.onclick=()=>{t.setDate(I),this.update(t,a)},e.headerPrevYear.onclick=()=>{t.setFullYear(t.getFullYear()-1),this.update(t,a)},e.headerNextYear.onclick=()=>{t.setFullYear(t.getFullYear()+1),this.update(t,a)},e.todayButton.onclick=()=>{const h=new Date;p.call(null,h),this.update(h,h)},e.updateI18n(),e.headerTitle.innerText=o(s).format(g.datePicker.titleFormat),s.setDate(1),s.setDate(-(s.getDay()-1)),e.contentTableTbody.innerHTML="",y.range(H).forEach(()=>{const h=document.createElement("tr");for(let E=0;E<M;E++){const u=document.createElement("td"),x=new Date(s);u.innerText=`${s.getDate()}`,u.onclick=()=>p(x),x<r||x>b?u.classList.add("is-disabled"):s.getMonth()!==T?u.classList.add("is-diff-month"):s.getTime()===(a==null?void 0:a.getTime())&&u.classList.add("is-selected"),h.appendChild(u),s.setDate(s.getDate()+1)}e.contentTableTbody.appendChild(h)})},show:function(){c=!0,e.datePicker.isConnected||document.body.appendChild(e.datePicker),e.datePicker.style.removeProperty("display"),e.datePicker.setAttribute("data-for",n),m.create(),f.create(),setTimeout(()=>{e.datePicker.classList.add(P.datePicker["is-visible"]),d(),d=L(i,e.datePicker)},0)},hide:function(){m.destroy(),f.destroy();const t=a=>{a.currentTarget===a.target&&(c=!1,e.datePicker.removeEventListener("transitionend",t),n===e.datePicker.getAttribute("data-for")&&(d(),e.datePicker.remove()))};e.datePicker.addEventListener("transitionend",t),e.datePicker.classList.remove(P.datePicker["is-visible"])},onESC:()=>l.hide()},f=w(l);return l},v="input",D={input:{"&":v},inputNative:{"&":`${v}__native`},inputSuffix:{"&":`${v}__suffix`},inputPrefix:{"&":`${v}__prefix`}},Y=(n,i)=>n instanceof Date?o(n).startOf("D"):typeof n=="string"?o(n,i):o(null);class W extends S{constructor({div:i,defaultDate:p,format:r=g.datePicker.dateFormat,checkbox:b=!1,disabled:c=!1,onSelect:d,onChange:m,minDate:l=new Date(0),maxDate:f=new Date("9999-12-31")}){if(super({contextElement:i}),this.selectedDate=null,this.calendarDate=new Date,p){const t=Y(p,r);t.isValid()?(this.calendarDate=t.toDate(),this.selectedDate=t.toDate()):console.error(`invalid defaultDate format. it must follow ${r}`)}if(this.format=r,this.div=i,this.input=document.createElement("input"),this.button=document.createElement("button"),this.button.appendChild(A("ir-icon--calendar")),this.div.innerHTML="",this.div.classList.add(D.input["&"]),this.input.setAttribute("type","text"),this.input.setAttribute("placeHolder",this.format),this.input.className=D.inputNative["&"],this.button.className=D.inputSuffix["&"],this.button.type="button",this._minDate=l,this._maxDate=f,d&&(this.onSelect=d),m&&(this.onChange=m),b){const t=document.createElement("div"),a=document.createElement("label"),s=document.createElement("input");s.setAttribute("type","checkbox"),t.classList.add(C.checkbox["&"],D.inputPrefix["&"]),a.className=C.checkboxWrapper["&"],s.className=C.checkboxInput["&"],a.appendChild(s),t.appendChild(a),this.div.appendChild(t),s.checked=!c,s.onchange=()=>this.disabled=!s.checked,this.addCoreElement(t)}this.disabled=c,this.div.appendChild(this.input),this.div.appendChild(this.button),this.addCoreElement(this.input),this.addCoreElement(this.button),this.selectedDate&&(this.input.value=o(this.selectedDate).format(r)),this.button.addEventListener("click",()=>{this.isVisible===!1&&this.show()}),this.input.addEventListener("blur",()=>{const t=o(this.input.value,this.format,!0);this.setDate(t.isValid()?t.toDate():null),this.date&&(this.date<this.minDate||this.date>this.maxDate)&&this.setDate(null)}),this.handler=O({uuid:this.uuid,refElement:this.div,minDate:this._minDate,maxDate:this._maxDate,onClick:t=>{this.setDate(t),this.onSelect(t),this.hide()}})}get textValue(){return this.input.value}get inputCheckbox(){return this.div.querySelector(".checkbox__input")}get date(){return this.selectedDate}get isVisible(){return this.handler.visible}get disabled(){return this.input.hasAttribute("disabled")}get minDate(){return this._minDate}get maxDate(){return this._maxDate}set minDate(i){this._minDate=i}set maxDate(i){this._maxDate=i}set disabled(i){i?(this.input.setAttribute("disabled",""),this.button.setAttribute("disabled","")):(this.input.removeAttribute("disabled"),this.button.removeAttribute("disabled")),this.inputCheckbox&&(this.inputCheckbox.checked=!i)}setDate(i){i?(this.selectedDate=new Date(i),this.calendarDate=new Date(i),this.input.value=o(i).format(this.format),this.updateCalendar()):(this.selectedDate=null,this.input.value=""),this.latestValue!==this.input.value&&this.onChange(this.input.value),this.latestValue=this.input.value}show(){this.isVisible||(this.handler.update(this.calendarDate,this.selectedDate),this.handler.show())}hide(){this.isVisible&&this.handler.hide()}onSelect(i){}onChange(i){}updateCalendar(){this.handler.update(this.calendarDate,this.selectedDate)}}export{W as I};
//# sourceMappingURL=datePicker-67266d31.js.map
