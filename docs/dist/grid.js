import{a as An,b as On,d as zn,e as X,f as Wn}from"./chunks/chunk-6EIWT5G5.js";import{a as Bo,b as Dn}from"./chunks/chunk-HM7E4RBT.js";import{a as Pn,b as jn}from"./chunks/chunk-R7VWAK3S.js";import{a as cr}from"./chunks/chunk-SAP32CJ3.js";import{a as Fe,c as O,d as Hn,h as te}from"./chunks/chunk-HJRTLFPM.js";import{$ as Dr,A as _r,Aa as ln,B as Ir,Ba as sn,C as xr,Ca as an,D as yr,Da as dn,E as vr,Ea as cn,Fa as un,G as Er,Ga as mn,Ha as hn,I as Sr,Ia as gn,J as Mr,Ja as fn,K as Gr,Ka as We,L as Tr,La as pn,M as Lr,Ma as Cn,N as kr,Na as Rn,O as Hr,Oa as Pe,P as Ar,Pa as wn,Q as Or,Qa as bn,Ra as F,Sa as _n,Ua as xn,_ as Oe,_a as W,aa as zr,b as ur,ba as Wr,ca as Pr,cb as Gn,da as jr,e as K,ea as Fr,f as mr,fa as Br,fb as Tn,ga as Vr,ha as Nr,ia as Ur,ib as ee,ja as $r,jb as Ln,ka as Kr,kb as kn,la as Xr,m as hr,ma as Zr,n as gr,na as De,nb as je,oa as Dt,ob as he,pa as ze,qa as Yr,ra as qr,s as Ot,sa as Jr,ta as ye,u as fr,ua as Qr,v as pr,va as en,w as Cr,wa as tn,x as Rr,xa as rn,y as wr,ya as nn,z as br,za as on}from"./chunks/chunk-P5YJIQLH.js";import"./chunks/chunk-4BHHVEMS.js";import"./chunks/chunk-H64UOPIH.js";import{a as dr}from"./chunks/chunk-ZSTOGUCC.js";import{a as ie,c as xe,g as In,h as yn,j as vn,k as En,l as Sn,o as Mn}from"./chunks/chunk-5PCD5M4R.js";import"./chunks/chunk-QOX5DKB2.js";import{d as Fo,e as U}from"./chunks/chunk-QBHXWPSD.js";function Fn(o){var t=o.match(/^var\((.*)\)$/);return t?t[1]:o}function Bn(o,t){var e=o;for(var r of t){if(!(r in e))throw new Error("Path ".concat(t.join(" -> ")," does not exist in object"));e=e[r]}return e}function zt(o,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=o.constructor();for(var n in o){var i=o[n],l=[...e,n];typeof i=="string"||typeof i=="number"||i==null?r[n]=t(i,l):typeof i=="object"&&!Array.isArray(i)?r[n]=zt(i,t,l):console.warn('Skipping invalid key "'.concat(l.join("."),'". Should be a string, number, null or object. Received: "').concat(Array.isArray(i)?"Array":typeof i,'"'))}return r}function Vn(o,t,e){o.style.setProperty(Fn(t),e)}function Y(o,t,e){if(typeof e=="object"){var r=t;zt(e,(s,c)=>{s!=null&&Vn(o,Bn(r,c),String(s))})}else{var n=t;for(var i in n){var l=n[i];l!=null&&Vn(o,i,n[i])}}}function Wt(o,t,e){return Pt(o,e)&&jt(t,e)}function Z(o){let t=parseInt(o.getAttribute("data-row")||"-1"),e=parseInt(o.getAttribute("data-col")||"-1");if(t===-1||e===-1)throw new Error("Invalid cell");return{row:t,col:e}}function Pt(o,t){return o>=t.top&&o<=t.bottom}function jt(o,t){return o>=t.left&&o<=t.right}function ve(o,t,e){e?o.classList.add(t):o.classList.remove(t)}function Nn(o){let t=o.firstChild,e=0;for(;t;){let r=t.firstChild;for(;r;)r instanceof HTMLElement&&r.isConnected&&(e=Math.max(r.offsetHeight,e)),r=r.nextSibling;t=t.nextSibling}return e}function Un(o){let t=o.target,e=o.offsetX,r=o.offsetY;for(;t!==o.currentTarget;){if(!(t instanceof HTMLElement))throw new Error("invalid event target!");if(t.tagName==="TR")break;e+=t.offsetLeft,r+=t.offsetTop,t=t.parentElement}return{x:e,y:r}}var Vo=20,No=5,V=class{render(t,e,r){throw new Error("Not implemented")}getHorizontalCellPadding(t){var e,r;return((e=t.paddingLeft)!=null?e:t.getGridStore().getThemeValue("grid.paddingLeft"))+((r=t.paddingRight)!=null?r:t.getGridStore().getThemeValue("grid.paddingRight"))}getCellInnerWidth(t,e,r){var c,d;let n=ee(t,e),i=[r.icon,r.sortOrder].reduce((a,h)=>h?a+1:a,0)*(Vo+No),l=`${(c=r.text)!=null?c:""}`.split(`
`),s=i+n.calculateWidth((d=l[0])!=null?d:"");return this.getHorizontalCellPadding(r)+O(1,l.length).reduce((a,h)=>Math.max(a,n.calculateWidth(l[h])),s)}getRendererInnerWidth(t,e,r){return 0}getCellInnerHeight(t,e){var l,s;let r=e.getGridStore(),n=(l=e.paddingTop)!=null?l:r.getThemeValue("grid.paddingTop"),i=(s=e.paddingBottom)!=null?s:r.getThemeValue("grid.paddingBottom");return n+i+Nn(t)}get renderType(){return"unknown"}get editable(){return!0}};var Be=class{constructor(t,e){this._args=e,this._instance=t,this._undoContext=this._getUndoContext()}_getUndoContext(){throw new Error("Not implemented")}_execute(){throw new Error("Not implemented")}_undo(){throw new Error("Not implemented")}get canUndo(){throw new Error("Not implemented")}get canExecute(){throw new Error("Not implemented")}execute(){if(!this.canExecute)throw new Error("Can't execute command");this._execute(),this.onExecute()}undo(){if(!this.canUndo)throw new Error("Can't undo command");this._undo(),this.onUndo()}onUndo(){}onExecute(){}};var D=class extends Be{};var q=class extends D{_execute(){this._instance.setCell(...this._args)}_getUndoContext(){let[t,e,r]=this._args;return{beforeValue:Hn(this._instance.getCell(t,e),r)}}_undo(){this._instance.setCell(this._args[0],this._args[1],this._undoContext.beforeValue)}get canExecute(){return this._instance.cell(this._args[0],this._args[1])!==void 0}get canUndo(){return this._instance.cell(this._args[0],this._args[1])!==void 0}};var Ee={checkbox:kr,checkboxWrapper:Or,checkboxText:Ar,checkboxInput:Hr,horizontal_left:"justify-content--start",horizontal_center:"justify-content--center",horizontal_right:"justify-content--end"},Uo=16,Ft=6,$o=Ft*2,Ko=20,Bt=class extends V{constructor({onCheckboxClick:t}){super(),t&&(this.onCheckboxClick=t.bind(this))}onCheckboxClick(t,e,r){}render(t,e,r){let n=document.createElement("div"),i=document.createElement("label"),l=document.createElement("input");if(n.classList.add(ln,Ee.checkbox),i.classList.add(an,Ee.checkboxWrapper),l.type="checkbox",l.className=Ee.checkboxInput,i.appendChild(l),r.icon&&i.appendChild(xn(`ir-icon--${r.icon}`)),r.label){let s=document.createElement("span");s.className=`${sn} ${Ee.checkboxText}`,s.innerText=r.label,i.appendChild(s)}return r.horizontalAlign&&n.classList.add(Ee[`horizontal_${r.horizontalAlign}`]),n.appendChild(i),l.checked=r.text==="true",i.onkeydown=s=>s.preventDefault(),l.onchange=()=>{let s=l.checked,c=s?"true":"false",d=r.commandManager,a=new q(d,[t,e,{text:c}]);a.onUndo=()=>{this.onCheckboxClick(t,e,!s)},a.onExecute=()=>{this.onCheckboxClick(t,e,s)},r.commandManager.commandManager.pushCommandBlock(new X("Change checkbox",a)),r.text=c,r.emitter.emit("onCellInfoChanged",{row:t,col:e}),this.onCheckboxClick(t,e,s)},n}getCellInnerWidth(t,e,r){let n=ee(t,e),i=r.label?Ft+n.calculateWidth(r.label):0,l=r.icon?Ft+Ko:0;return Uo+$o+i+l+this.getHorizontalCellPadding(r)}get renderType(){return"checkbox"}get editable(){return!1}};function al(o){let t=new Bt(o!=null?o:{});return()=>t}var Ve={select:gr,selectInput:fr,selectInputNative:Cr,selectInputIcon:pr},Kn=new WeakMap,Xo=20,Zo=4,Xn=Xo+Zo,Yo=18,qo=150,Jo=(o,t)=>t!=null?t:"",Vt=class extends V{constructor({items:e,allowCustomText:r=!1,showErrorIfCustomText:n=!1,allowEdit:i=!1,onChange:l,customDisplayTextFunc:s=Jo,getVisibleFunc:c=()=>!0}){super();this._dropDownItemList=[];this._dropDownContext=An();this._itemWidth=null;this._isExpanded=!1;this._floatingCleanup=()=>{};this._items=e,this._itemTextSet=new Set,this._allowCustomText=r,this._allowEdit=i,i&&(this._allowCustomText=!0),this._customDisplayTextFunc=s,this._showErrorIfCustomText=n,this._getVisibleFunc=c,l&&(this.onChange=l.bind(this));for(let{value:d,text:a}of e){let{item:h,button:m}=On(d,a);this._itemTextSet.add(a),this._dropDownItemList.push({value:d,text:a,buttonElement:m,itemWrapperElement:h}),this._dropDownContext.ulItems.appendChild(h)}}getSelectedItemOrNull(e){for(let r of this._dropDownItemList)if(r.text===e)return r;return null}render(e,r,n){let{_allowCustomText:i,_allowEdit:l,_showErrorIfCustomText:s,_customDisplayTextFunc:c,_getVisibleFunc:d,_dropDownContext:{divDropdown:a},_dropDownItemList:h}=this,m=document.createElement("div"),g=document.createElement("span"),C=document.createElement("i"),I=n.text===""||n.text===null||n.text===void 0;m.classList.add(on,Ve.select,Ve.selectInput),g.classList.add(Ve.selectInputNative),C.classList.add(Ve.selectInputIcon,"ir-icon","ir-icon--chevron-down"),l&&m.classList.add("is-editable");let w=!1,T=this.getSelectedItemOrNull(n.text);T&&(g.textContent=c(T.value,T.text,!1),n.value=T.value,w=!0),w||(i?(g.textContent=c(n.value,n.text,!0),n.value=n.text):(g.textContent="",n.value="")),i&&s&&!I&&!w&&(m.dataset.error="true");let x=Tn({eventElements:[m,a],clickOutsideFunc:()=>L.hide()}),L={show:()=>{this._isExpanded=!0,u.create(),x.create(),this._beforeValue=n.value,this._beforeText=n.text;for(let f of h){let{value:b,text:y,itemWrapperElement:S,buttonElement:E}=f;d(f)===!1?S.style.display="none":S.style.display="",y===n.text?S.classList.add(Ot):S.classList.remove(Ot),E.onclick=()=>{let v=n.commandManager,M=new q(v,[e,r,{text:y,value:b}]);M.onUndo=()=>{this.onChange(e,r,this._beforeValue,this._beforeText,b,y)},M.onExecute=()=>{this.onChange(e,r,b,y,this._beforeValue,this._beforeText)},n.commandManager.commandManager.pushCommandBlock(new X("Change select menu",M)),n.text=y,n.value=b,n.emitter.emit("onCellInfoChanged",{row:e,col:r}),n.emitter.emit("updateCellStatus",{row:e,col:r}),g.textContent=c(b,y,!1),m.dataset.error&&delete m.dataset.error,this.onChange(e,r,b,y,this._beforeValue,this._beforeText),L.hide()}}let R=this.getItemWidth(n.fontSize||"13px",n.fontFamily||"Pretendard",n),_=m.offsetWidth,G=n.getGridStore().getThemeValue("grid.defaultDropdownWidth");a.style.maxWidth=`${_>G?_:G}px`,a.style.width=`${Math.max(R,_)}px`,a.setAttribute("data-row",e.toString()),a.setAttribute("data-col",r.toString()),xe("popover").appendChild(a),m.classList.add("is-expanded"),setTimeout(()=>{a.classList.add("is-expanded"),this._floatingCleanup(),this._floatingCleanup=Mn(m.parentElement,a,"bottom-start")},0)},hide:()=>{this._isExpanded=!1,u.destroy(),x.destroy(),m.classList.remove("is-expanded"),a.classList.remove("is-expanded"),setTimeout(()=>{a.getAttribute("data-row")===e.toString()&&a.getAttribute("data-col")===r.toString()&&(this._floatingCleanup(),a.remove())},qo)}},u=In(L),p=()=>{m.classList.contains("is-expanded")?L.hide():L.show()};return m.onclick=R=>{l&&R.target!==C||p()},m.appendChild(g),m.appendChild(C),m}onChange(e,r,n,i,l,s){}getCellInnerWidth(e,r,n){if(!n.text)return 0;let i=ee(e,r),l=this._itemTextSet.has(n.text),s=this._customDisplayTextFunc(n.value,n.text,!l),c=i.calculateWidth(s);return Xn+c+this.getHorizontalCellPadding(n)}getDropdownWidth(e,r,n){let i=ee(e,r),l=this._items.reduce((s,c)=>Math.max(s,i.calculateWidth(c.text)),0);return Xn+l+this.getHorizontalCellPadding(n)}getRendererInnerWidth(e,r,n){let i=Kn.get(this);if(i)return i;let l=this.getDropdownWidth(e,r,n);return Kn.set(this,l),l}getItemWidth(e,r,n){return this._itemWidth===null&&(this._itemWidth=this.getRendererInnerWidth(e,r,n)),this._itemWidth+Yo}get renderType(){return"select"}get editable(){return this._allowEdit&&!this._isExpanded}},_l=o=>{let t=new Vt(o);return()=>t};var Se=Fo(Bo(),1);var Nt={input:yr,inputNative:vr,inputSuffix:Er},Qo=28,ge=new WeakMap,Ut=class extends V{constructor({onDateClick:t,format:e=Dn.datePicker.dateFormat,minDate:r=ie().getStoreValue("datePicker.minDate"),maxDate:n=ie().getStoreValue("datePicker.maxDate"),allowedEmptyString:i=!0}){super(),this._format=e,this._minDate=r,this._maxDate=n,this._allowedEmptyString=i,t&&(this.onDateClick=t.bind(this))}onDateClick(t,e,r){}getCellInnerWidth(t,e,r){return ee(t,e).calculateWidth(r.text||this._format)+Qo+this.getHorizontalCellPadding(r)}render(t,e,r){var g;let n=document.createElement("div"),i=document.createElement("input"),l=document.createElement("button"),s=document.createElement("i"),{_minDate:c,_maxDate:d,_format:a,_allowedEmptyString:h}=this;if(i.readOnly=!0,i.maxLength=a.length,n.classList.add(Nt.input,dn),i.classList.add(Nt.inputNative),l.classList.add(Nt.inputSuffix),s.classList.add("ir-icon","ir-icon--calendar"),i.type="text",i.placeholder=a,r.text!==""){let C=(0,Se.default)(r.text,a,!0);C.isValid()||(r.text=ge.get(r)),(C.isBefore(c)||C.isAfter(d))&&(r.text=ge.get(r))}!h&&(r.text===""||r.text===void 0)&&(r.text=ge.has(r)?ge.get(r):(0,Se.default)().format(a)),i.value=r.text||"",ge.set(r,(g=r.text)!=null?g:""),l.appendChild(s),n.appendChild(i),n.appendChild(l);let m=zn({uuid:dr(),refElement:n,minDate:c,maxDate:d,onClick:C=>{let I=r.text,w=(0,Se.default)(C).format(a),T=r.commandManager,x=new q(T,[t,e,{text:w}]);x.onUndo=()=>{this.onDateClick(t,e,I!=null?I:"")},x.onExecute=()=>{this.onDateClick(t,e,w)},T.commandManager.pushCommandBlock(new X("Change datePicker",x)),i.value=w,r.text=w,ge.set(r,w),this.onDateClick(t,e,w),r.emitter.emit("onCellInfoChanged",{row:t,col:e}),m.hide()}});return l.onclick=()=>{if(!m.visible){let C=(0,Se.default)(r.text,a,!0);C.isValid()?m.update(C.toDate(),C.toDate()):m.update(new Date,null),m.show()}},n}get renderType(){return"datePicker"}},kl=o=>{let t=new Ut(o);return()=>t};var Ne={progress:Ir,progressVariants:xr},ei={min:0,max:100,defaultIntent:void 0,afterDecimalLen:2},ti=100,ri=100,$t=class extends V{constructor({min:t=0,max:e=100,defaultIntent:r,afterDecimalLen:n=2}){super(),this._min=t,this._max=e,this._defaultIntent=r,this._afterDecimalLen=n}render(t,e,r){var g;let{_min:n,_max:i,_afterDecimalLen:l,_defaultIntent:s}=this,c=document.createElement("div"),d=document.createElement("div");c.className=cn,d.className=Ne.progress;let a=(g=r.intent)!=null?g:s;a&&d.classList.add(`${Ne.progress}--${a}`);let m=(W(parseFloat(r.text||"0"),n,i)-n)/(i-n)*ti;return Y(d,{[Ne.progressVariants.progressPercent]:`${m}%`,[Ne.progressVariants.progressText]:`'${m.toFixed(l)}%'`}),c.appendChild(d),c}getCellInnerWidth(t,e,r){return ri+this.getHorizontalCellPadding(r)}get renderType(){return"progress"}get editable(){return!1}},Wl=(o=ei)=>{let t=new $t(o);return()=>t};var ni=20,oi=24,ii=24,li=29,Zn={primary:Mr,secondary:Gr,tertiary:Tr,transparent:Lr,left:"justify-content--start",center:"justify-content--center",right:"justify-content--end"},Kt=class extends V{constructor(e){super();this.args=e;e.onClick&&(this.onClick=e.onClick.bind(this)),e.iconDividerStyle?this._extraWidth=li:e.outlineStyle?this._extraWidth=ii:this._extraWidth=0}onClick(e,r,n){}render(e,r,n){var I,w,T,x,L;let{iconDividerStyle:i,outlineStyle:l,defaultColor:s,defaultIcon:c,defaultLabel:d}=this.args,a=document.createElement("div"),h=document.createElement("button");a.className=nn,h.classList.add(Qr,"button");let m=(I=n.intent)!=null?I:s;m&&h.classList.add(Zn[m]),l?a.classList.add(rn):i&&a.classList.add(tn),!this.args.iconDividerStyle&&n.horizontalAlign&&h.classList.add(Zn[n.horizontalAlign]),h.onclick=u=>this.onClick(u,e,r);let g=(w=n.icon)!=null?w:c,C=i?(T=n.text)!=null?T:"":(L=(x=n.label)!=null?x:d)!=null?L:"";if(g){let u=document.createElement("i");u.classList.add(Sr,"ir-icon",`ir-icon--${g}`),h.appendChild(u)}if(C){let u=ur("span");if(u.innerText=C,i){let p=document.createElement("div");u.classList.add("text--multi-ellipsis"),p.appendChild(u),a.insertAdjacentElement("afterbegin",p)}else u.classList.add("text--ellipsis"),h.appendChild(u)}return a.appendChild(h),a}getCellLabel(e){return this.args.iconDividerStyle?e.text||"":e.label||this.args.defaultLabel||""}getExtraWidth(e){let r=e.icon||this.args.defaultIcon;return this.args.iconDividerStyle||this.args.outlineStyle?this._extraWidth:r?ni:0}getCellInnerWidth(e,r,n){let i=ee(e,r);return this.getHorizontalCellPadding(n)+i.calculateWidth(this.getCellLabel(n))+this.getExtraWidth(n)}getCellInnerHeight(e,r){return oi}get renderType(){return"button"}get editable(){return!1}},Nl=o=>{let t=new Kt(o!=null?o:{});return()=>t};var Ue={radio:Rr,radioWrapper:_r,radioInput:wr,radioText:br},si=16,Yn=6,ai=Yn*2,Xt=class extends V{constructor({onRadioClick:e}){super();this._radioItemStack=[];e&&(this.onRadioClick=e.bind(this))}stackClickedRadio(e){let r=this._radioItemStack.pop();r&&r.data!==e.data&&(r.radio.checked=!1,r.data.text="false",r.data.emitter.emit("onCellInfoChanged",{row:e.row,col:e.col})),this._radioItemStack.push(e)}render(e,r,n){let i=document.createElement("div"),l=document.createElement("label"),s=document.createElement("input");if(i.className=`${un} ${Ue.radio}`,l.className=Ue.radioWrapper,s.type="radio",s.className=Ue.radioInput,l.appendChild(s),n.label){let c=document.createElement("span");c.className=Ue.radioText,c.innerText=n.label,l.appendChild(c)}return i.appendChild(l),s.checked=n.text==="true",s.checked===!0&&this.stackClickedRadio({radio:s,data:n,row:e,col:r}),l.onkeydown=c=>c.preventDefault(),s.onclick=()=>{let c=n.commandManager,d=new q(c,[e,r,{text:"true"}]),a=this._radioItemStack[this._radioItemStack.length-1];d.onUndo=()=>{a&&(c.setCell(a.row,a.col,{text:"true"}),this.onRadioClick(a.row,a.col))},d.onExecute=()=>{this.onRadioClick(e,r)},c.commandManager.pushCommandBlock(new X("Click radioButton",d)),this.stackClickedRadio({radio:s,data:n,row:e,col:r}),n.text="true",this.onRadioClick(e,r),n.emitter.emit("onCellInfoChanged",{row:e,col:r})},i}onRadioClick(e,r){}getCellInnerWidth(e,r,n){let i=ee(e,r),l=n.label?Yn+i.calculateWidth(n.label):0;return si+ai+l+this.getHorizontalCellPadding(n)}get renderType(){return"radio"}get editable(){return!1}},ql=({onRadioClick:o})=>{let t=new Xt({onRadioClick:o});return()=>t};function di(o){let t=document.createElement("div");if(t.className=Oe,o.sortOrder!==void 0){let e=o.sortOrder==="ASC"?"sort-ascending":"sort-descending",r=document.createElement("i");r.className=`ir-icon ir-icon--${e}`,t.appendChild(r)}if(o.icon){let e=document.createElement("i");e.classList.add("ir-icon",`ir-icon--${o.icon}`),o.iconColor&&e.style.setProperty("--ir-icon-foreground-color",o.iconColor),t.appendChild(e)}if(o.text){let e=document.createElement("span");e.innerText=o.text,t.appendChild(e)}return t}function ci(o,t,e,r){let n=document.createElement("div");if(n.className=Oe,e.icon){let i=document.createElement("button"),l=document.createElement("i");i.setAttribute("type","button"),i.classList.add("icon-button",en),i.onclick=s=>{r&&r(s,o,t)},l.classList.add("ir-icon",`ir-icon--${e.icon}`),e.iconColor&&l.style.setProperty("--ir-icon-foreground-color",e.iconColor),i.appendChild(l),n.appendChild(i)}if(e.text){let i=document.createElement("span");i.innerText=e.text,n.appendChild(i)}return n}var ce=class extends V{constructor(e={}){super();this._args=e}render(e,r,n){let i=di(n),{ellipsis:l=!0}=this._args;return l&&i.classList.add(Dr),i}get renderType(){return"default"}},Zt=class extends V{constructor({onClick:t}){super(),t&&(this.onClick=t)}render(t,e,r){return ci(t,e,r,(n,i,l)=>this.onClick(n,i,l))}onClick(t,e,r){}get renderType(){return"iconButton"}},Yt=class extends V{constructor(e,...r){super();this._prefix="";this._fixedRowCount=e,this._captionList=r}get prefix(){return this._prefix}get renderType(){return"rowNo"}get editable(){return!1}set prefix(e){this._prefix=e}render(e,r,n){let i=document.createElement("div"),l=document.createElement("div"),s=e-this._fixedRowCount;i.className=Oe;let c=s<this._captionList.length?this._captionList[s]:`${this._prefix}${1+s-this._captionList.length}`;return l.innerText=c,n.text=c,i.appendChild(l),i}},ts=()=>{let o=new ce;return()=>o};function rs({onClick:o}){let t=new Zt({onClick:o});return()=>t}function ns(o,...t){let e=new Yt(o,...t);return()=>e}var qn=new WeakMap,qt=class extends ce{constructor(t){super(),this.render=t.bind(this)}get renderType(){return"custom"}};function Jn(o){let t=qn.get(o);if(t)return t;let e=new qt(o);return qn.set(o,e),e}function Qn(o,t){function e(i,l){if(l.length===0)throw new Error("No pasting data.");let s={...i},c=l.length,d=l[0].length,a=s.top+c,h=s.left+d;for(let m=i.bottom+1;m<a;++m)(o.hasRow(m)||o.onAutoInsertRow(m))&&(s.bottom=m);for(let m=i.right+1;m<h;++m)(o.hasColumn(m)||o.onAutoInsertColumn(m))&&(s.right=m);return s}function r(i,l){if(l.length===0)throw new Error("No pasting data.");let s=l.length,c=l[0].length,d=[],a=i.bottom-i.top+1,h=i.right-i.left+1;function m(g,C){let[I,w]=[g%s,C%c];return l[I][w]}for(let{y:g,x:C}of kn(a,h)){let[I,w]=[g+i.top,C+i.left];if(!o.hasRow(I)&&o.onAutoInsertRow(I)&&o.addRow(),!o.hasColumn(w)&&o.onAutoInsertColumn(w)&&o.addColumn(),!o.hasRow(I)||!o.hasColumn(w))continue;let T=o.cell(I,w),x=m(g,C);x.cellVisible&&o.onCheckPasteCell(T,x.text)&&d.push({cell:T,cellMetaInfo:{text:x.text,cellVisible:x.cellVisible,rowSpan:t.rowSpan?x.rowSpan:1,colSpan:t.colSpan?x.colSpan:1,isFormatted:!1}})}return d}function n(i){for(let{cell:l,cellMetaInfo:s}of i){let{rowSpan:c,colSpan:d,cellVisible:a}=s;if(!a)continue;let{row:h,col:m}=l;if(c>1||d>1){let C={top:h,left:m,bottom:h+c-1,right:m+d-1};o.mergeCells(C.top,C.left,C.bottom,C.right)}o.setCell(h,m,{text:s.text}),o.onClipboardAfterPasteCell(l)}}return{getPastingRange:e,beforePastingList:r,pasteTask:n}}function eo(o){return JSON.stringify(o)}function to(o){return JSON.parse(o)}function ro(o){let t=new Document,e=t.createElement("table");return o.forEach(r=>{let n=t.createElement("tr");r.filter(i=>i.cellVisible).forEach(i=>{let l=t.createElement("td");l.textContent=i.text,l.setAttribute("rowSpan",`${i.rowSpan}`),l.setAttribute("colSpan",`${i.colSpan}`),n.appendChild(l)}),e.appendChild(n)}),t.appendChild(e),t.documentElement.outerHTML}function no(o){let r=new DOMParser().parseFromString(o,"text/html").querySelectorAll("tr");if(r.length===0)return console.warn("No tr element in clipboard data"),[];let n=Array(r.length).fill(void 0).map(()=>[]);function i(c,d,a,h){for(let m=c;m<c+a;++m)for(let g=d;g<d+h;++g)n[m][g]={text:"",rowSpan:1,colSpan:1,cellVisible:!1,isFormatted:!1}}function l(c){let d=c;for(;n[s][d]!==void 0;)++d;return d}let s=0;for(let c of r){let d=c.querySelectorAll("td"),a=l(0);for(let h of d)(h.rowSpan>1||h.colSpan>1)&&i(s,a,h.rowSpan,h.colSpan),n[s][a]={text:oo(h),rowSpan:h.rowSpan,colSpan:h.colSpan,cellVisible:!0,isFormatted:h.hasAttribute("class")},a=l(a);++s}return n}function oo(o){let t=[],e=o.firstChild;for(;e;)e.nodeType===Node.TEXT_NODE&&e.nodeValue?t.push(ui(e.nodeValue)):e.nodeType===Node.ELEMENT_NODE&&e instanceof HTMLElement&&(e.nodeName==="BR"?t.push(`
`):e.textContent&&t.push(oo(e))),e=e.nextSibling;return t.join("")}function ui(o){let t=[],e=!1;for(let r of o)switch(r){case`
`:case"\r":e=!0;continue;default:if(e&&r===" ")continue;e=!1,t.push(r);break}return t.join("")}function io(o){if(o.length===0)return!0;let t=o[0].length;return o.every(e=>e.length===t)}var lo="	",so=`
`;function ao(o){if(!io(o))throw new Error("Wrong text matrix dimension");return o.map(t=>t.map(({text:e})=>e).join(lo)).join(so)}function co(o){if(o.length===0)return[];let t=[],e=[],r=[];function n(){r.push({text:e.join(""),rowSpan:1,colSpan:1,cellVisible:!0,isFormatted:!1}),e.length=0}function i(){var l;n(),(t.length===0||r.length===((l=t[0])==null?void 0:l.length))&&t.push([...r]),r.length=0}for(let l of o)l!=="\r"&&(l===lo?n():l===so?i():e.push(l));return(e.length>0||r.length>0)&&i(),t}var $e=[{format:"ir-grid/cell",parseFunc:to,payloadFunc:eo},{format:"text/html",parseFunc:no,payloadFunc:ro},{format:"text/plain",parseFunc:co,payloadFunc:ao}];function uo(o,t){$e.forEach(({format:e,payloadFunc:r})=>o.setData(e,r(t)))}function mo(o){return o.isFormatted&&o.text.startsWith("#")}function mi(o){return o.some(t=>t.some(e=>mo(e)))}function hi(o,t){var e,r;for(let n=0;n<o.length;++n){let i=o[n].length;for(let l=0;l<i;++l)(r=(e=t[n])==null?void 0:e[l])!=null&&r.text&&mo(o[n][l])&&(o[n][l].text=t[n][l].text)}return o}function Jt(o){for(let{format:t,parseFunc:e}of $e){let r=o.getData(t);if(r!==""){let n=e(r);if(!mi(n))return n;let i=o.getData($e[2].format);return hi(n,$e[2].parseFunc(i))}}return console.warn("No relevant data format in clipboard!"),[]}var Ke=class extends he{constructor(){super([])}};var Xe=class extends he{constructor(){super({mode:"idle",contextParam:{}})}get isIdle(){return this.value.mode==="idle"}};var J=class{constructor(t,e){this._rowManager=t,this._colManager=e}*getSelectionGenerator({top:t,left:e,bottom:r,right:n}){n=Math.min(n,this._colManager.getColCount()-1),r=Math.min(r,this._rowManager.getRowCount()-1);for(let i=t;i<=r;i++)for(let l=e;l<=n;l++)yield this._rowManager.cell(i,l)}*getSelectionHeaderIterator({top:t,left:e,bottom:r,right:n}){n=Math.min(n,this._colManager.getColCount()-1),r=Math.min(r,this._rowManager.getRowCount()-1);for(let i=0;i<this._rowManager.headerRows;++i)for(let l=e;l<=n;++l)yield this._rowManager.cell(i,l);for(let i=t;i<=r;++i)for(let l=0;l<this._colManager.headerColumns;++l)yield this._rowManager.cell(i,l)}getCanClearCellCount(t){let e=0;for(let r of this.getSelectionGenerator(t))r.canClear&&e++;return e}};var re=class{constructor(t){this._grid=t,this._generator=new J(t,t)}adjustRange(t){let[e,r]=[this._grid.headerRows,this._grid.getRowCount()-1],[n,i]=[this._grid.headerColumns,this._grid.getColCount()-1],l={top:W(t.top,e,r),left:W(t.left,n,i),bottom:W(t.bottom,e,r),right:W(t.right,n,i)};return l.top>r||l.bottom<e||l.left>i||l.right<n?null:l}extendRange(t){let e=this._generator,r={...t},n=[...e.getSelectionGenerator(t)];for(;n.length;){let i=n.pop();if(!i.isMerged&&!i.mergeMain)continue;let l=i.mergeMain?i.mergeMain.mergeArea:i.mergeArea;if(l.top<r.top){let s=e.getSelectionGenerator({top:l.top,left:r.left,bottom:r.top-1,right:r.right});for(let c of s)n.push(c);r.top=l.top}if(l.left<r.left){let s=e.getSelectionGenerator({top:r.top,left:l.left,bottom:r.bottom,right:r.left-1});for(let c of s)n.push(c);r.left=l.left}if(r.bottom<l.bottom){let s=e.getSelectionGenerator({top:r.bottom+1,left:r.left,bottom:l.bottom,right:r.right});for(let c of s)n.push(c);r.bottom=l.bottom}if(r.right<l.right){let s=e.getSelectionGenerator({top:r.top,left:r.right+1,bottom:r.bottom,right:l.right});for(let c of s)n.push(c);r.right=l.right}}return r}getTextMatrixByRange(t){let e=[];for(let r=t.top;r<=t.bottom;++r)e.push(O(t.left,t.right+1).map(n=>this._grid.cell(r,n).text));return e}getCellMatrixByRange(t){let e=[];for(let r=t.top;r<=t.bottom;++r)e.push(O(t.left,t.right+1).map(n=>this._grid.cell(r,n)));return e}getCellListByColumn(t,e){let n=this._grid.getRowCount()-1;return[...this._generator.getSelectionGenerator({top:0,left:t,bottom:n,right:e})]}getColumnListByColumn(t,e){return O(t,e+1).map(r=>this._grid.getColumn(r))}};var Ze=class extends he{constructor(t){super(null,e=>{let r=new re(t);return e.pipe(je(n=>{if(!n||t.getRowCount()===t.headerRows&&t.getColCount()===t.headerColumns)return null;let{activeCell:i,range:l}=n;return i.element.isConnected&&i.row>=l.top&&i.row<=l.bottom&&i.col>=l.left&&i.col<=l.right?n:{activeCell:t.cell(l.top,l.left),range:n.range}}),je(n=>{if(!n)return null;let i=r.adjustRange(n.range);return i?{activeCell:n.activeCell,range:i}:null}),je(n=>n?{activeCell:n.activeCell,range:r.extendRange(n.range)}:null))})}};var Ye=class{constructor(t){this._selectionState=new Ze(t),this._gridModeState=new Xe,this._headerCellListState=new Ke}setIdle(){this.setMode({mode:"idle",contextParam:{}})}setMode(t){this.gridModeState.next(t)}get isIdle(){return this._gridModeState.isIdle}get selectionRangeState(){return this._selectionState}get gridModeState(){return this._gridModeState}get activateHeaderCellState(){return this._headerCellListState}};var gi=[F.zLevel0,F.zLevel1,F.zLevel2,F.zLevel3,F.zLevel4,F.zLevel5,F.zLevel6,F.zLevel7,F.zLevel8,F.zLevel9],Q={lv9:9,lv8:8,lv7:7,lv6:6,lv5:5,lv4:4,lv3:3},qe=class{constructor({row:t,col:e,tag:r,metaInfo:n,cellRenderer:i}){this._row=-1;this._col=-1;this._rowSpan=1;this._colSpan=1;this._element=null;this._cellType="body-cell";this._visible=!0;this._lastEditSelection={start:0,end:0};this._metaInfo={...n},this._tag=r,this._cellRenderer=i,this._row=t,this._col=e}get isFreezed(){return this.element.classList.contains(De)||this.element.tagName==="TH"}get renderType(){return this._getRenderInstance().renderType}get dropDisabled(){return this._metaInfo.dropDisabled}get isHeaderCell(){return this.element.tagName==="TH"}get isMerged(){return this._rowSpan>1||this._colSpan>1}get isSelected(){return this.element.classList.contains("is-selected")}get innerHeight(){return this._getRenderInstance().getCellInnerHeight(this.element,this._metaInfo)}get fontSize(){var t;return(t=this._metaInfo.fontSize)!=null?t:ie().getStoreValue("grid.defaultFontSize")}get fontFamily(){var t;return(t=this._metaInfo.fontFamily)!=null?t:ie().getStoreValue("grid.defaultFontFamily")}get mergeArea(){return{top:this.row,left:this.col,bottom:this.row+this._rowSpan-1,right:this.col+this._colSpan-1}}get innerWidth(){return this._getRenderInstance().getCellInnerWidth(this.fontSize,this.fontFamily,this._metaInfo)}get rendererInnerWidth(){return this._getRenderInstance().getRendererInnerWidth(this.fontSize,this.fontFamily,this._metaInfo)}get mergeInfo(){return{rowSpan:this._rowSpan,colSpan:this._colSpan}}get mergeMain(){return this._mergeMain}get row(){return this._row}get col(){return this._col}get bottom(){return this.row+this.mergeInfo.rowSpan-1}get right(){return this.col+this.mergeInfo.colSpan-1}get visible(){return this._visible}get cellRenderer(){return this._cellRenderer}get canClear(){let{disabled:t,readonly:e,text:r}=this.metaInfo;return t!==!0&&e!==!0&&this.renderType==="default"&&r!==""}get text(){let{text:t}=this._metaInfo;return t==null?"":t}get cellType(){return this._cellType}get value(){return this._metaInfo.value}get cellAddress(){return`${this.row},${this.col}`}get object(){return this._metaInfo.object}get metaInfo(){return this._metaInfo}initElement(){let t=document.createElement(this._tag);return t.rowSpan=this._rowSpan,t.colSpan=this._colSpan,t.classList.add(Br,this._tag==="th"?Vr:Fr),t.setAttribute("data-row",this._row.toString()),t.setAttribute("data-col",this._col.toString()),t.setAttribute("data-type",this._cellType),t.onclick=()=>this.onClick(this),t.onmouseup=e=>{e.button===2&&this.onRightClick(this,e)},t.ondblclick=e=>{te(e.target)&&e.target.tagName!=="I"&&e.target.tagName!=="TEXTAREA"&&this.onDblClick(this)},t}get element(){return this._element===null&&(this._element=this.initElement()),this._element}get editable(){return!(this._metaInfo.editable===!1||this._metaInfo.disabled||this.onCheckReadonly()||this._getRenderInstance().editable===!1)}get lastSelectionStart(){return this._lastEditSelection.start}get lastSelectionEnd(){return this._lastEditSelection.end}get cellInfo(){return this._metaInfo}get zIndexVariant(){return this.element.style.getPropertyValue("--grid-sticky-cell-z-index")}set visible(t){t&&!this.mergeMain?(this._visible=!0,this.element.style.removeProperty("display"),this.render()):(this._visible=!1,this.element.style.display="none")}set isDragOver(t){t?this.element.classList.add("is-dragging"):this.element.classList.remove("is-dragging")}set text(t){this.cellInfo={text:t}}set cellInfo(t){Object.assign(this._metaInfo,t),this.render(),this._metaInfo.emitter.emit("onCellInfoChanged",{row:this.row,col:this.col})}set cellType(t){this._cellType=t}set height(t){t?Y(this.element,{[F.cellHeight]:`${t}px`}):Y(this.element,{[F.cellHeight]:""})}set mergeInfo({rowSpan:t=1,colSpan:e=1}){t===1&&(this.height=null),this.element.rowSpan=t,this.element.colSpan=e,this._rowSpan=t,this._colSpan=e,this.render()}set mergeMain(t){this._mergeMain=t,this.visible=t===void 0}set row(t){this._row=t,this._element&&this.element.setAttribute("data-row",t.toString())}set col(t){this._col=t,this._element&&this.element.setAttribute("data-col",t.toString())}set cellRenderer(t){this._cellRenderer=t,this.render()}select(){this.isSelected||(this.element.classList.add("is-selected"),this.onSelect(this))}updateCellMetaInfo(t,e){Object.assign(this._metaInfo,t),e&&Object.assign(this._metaInfo,{text:e}),this.render()}release(){this.element.classList.remove("is-selected"),this.deactivate()}setLastSelection(t,e){this._lastEditSelection={start:t,end:e}}activate(){this._mergeMain?this._mergeMain.element.classList.add("is-active"):this.element.classList.add("is-active")}deactivate(){this.syncClassRemoveWithMergeMain("is-active")}updateReadonlyStatus(){ve(this.element,"is-readonly",this.onCheckReadonly())}setStickyLeft(t){this.element.style.left=`${t}px`}removeStickyLeft(){this.element.style.removeProperty("left")}setStickyTop(t){this.element.style.top=`${t}px`}removeStickyTop(){this.element.style.removeProperty("top")}setStickyZIndex(t,e,r){this.element.style.removeProperty("--grid-sticky-cell-z-index"),this.removeStickyCls(),this.removeStickyTop(),this.removeStickyLeft(),t!==null&&(Y(this.element,{[F.stickyCellZId]:gi[t]}),this.addStickyCls(),t>=Q.lv5&&this.setStickyTop(e),(t===Q.lv9||t===Q.lv7||t===Q.lv6||t===Q.lv4||t===Q.lv3)&&this.setStickyLeft(r))}updateCellStatus(){ve(this.element,"is-disabled",this._metaInfo.disabled===!0),ve(this.element,"is-asc",this._metaInfo.sortOrder==="ASC"),ve(this.element,"is-desc",this._metaInfo.sortOrder==="DESC"),this.updateReadonlyStatus(),this._metaInfo.isError?this.addMark(zr):this._metaInfo.hasMemo?this.addMark(Wr):this._mark&&this.removeMark(),this.element.style.textAlign=this._metaInfo.horizontalAlign||"",this.element.style.verticalAlign=this._metaInfo.verticalAlign||"",this.element.style.fontSize=this.fontSize,this.element.style.fontFamily=this.fontFamily,this.element.style.color=this._metaInfo.textColor||"",this.element.style.backgroundColor=this._metaInfo.backColor||""}_getRenderInstance(){if(this._cellRenderer instanceof V)return this._cellRenderer;if(typeof this._cellRenderer=="function"){let t=this._cellRenderer(this.row,this.col,this._metaInfo);if(t instanceof V)return t;if(t instanceof HTMLElement)return Jn(()=>t)}throw new Error("Invalid cell renderer")}_getRenderElement(){return this._getRenderInstance().render(this.row,this.col,this._metaInfo)}replaceElement(t){this.removeChildren(),this.element.appendChild(t)}checkInputValidation(t){return this.metaInfo.enabledPatternCheck&&this.metaInfo.allowedRegExpPattern?this.metaInfo.allowedRegExpPattern.test(t):!0}render(){this._element!==null&&this.visible&&(this.removeChildren(),this.updateCellStatus(),this.element.appendChild(this._getRenderElement()))}clear(){this.cellInfo={text:""},this.onClear(this)}addStickyCls(){this.element.classList.add(De)}removeStickyCls(){this.element.classList.remove(De)}onClick(t){}onDblClick(t){}onRightClick(t,e){}onSelect(t){}onClear(t){}onCheckReadonly(){return this._metaInfo.readonly===!0}removeChildren(){for(;this.element.lastChild;)this.element.lastChild.remove()}syncClassRemoveWithMergeMain(...t){this.mergeMain?this.mergeMain.element.classList.remove(...t):this.element.classList.remove(...t)}addMark(t){this._mark||(this._mark=document.createElement("span")),this._mark.className=t,this.element.appendChild(this._mark)}removeMark(){this._mark&&(this._mark.remove(),this._mark=void 0)}};var Je=-1,fi=["nothing","updateColumnId","updateRowId","updateTop","updateLeft","updateRowsStickyLeft","virtualRender","resizeGridWrapperHeight","generateScrollBarClass","adjustSelection","updateSelection","updateSelectionByScroll"],Qe=class{constructor(t,e,r,n,i,l){this._scheduledTaskSet=new Set;this._afterRenderCallbackList=[];this._rafHandler=Je;this._grid=t,this._gridContext=e,this._wrapperElement=r,this._tbody=n,this._contextElement=i,this._selector=l,this._gridRangeUtil=new re(t),this._emptyRow=document.createElement("tr"),this._emptyRow.className=Pr,this._emptyRow.dataset.hidden="true",Y(this._emptyRow,{[F.emptyRowHeight]:"0"}),this._tbody.appendChild(this._emptyRow),t.addGlobalEventListener(i,"scroll",s=>{this.addTask("virtualRender").addTask("updateSelectionByScroll"),s.preventDefault()})}renderTask(){let t=new Set(this._scheduledTaskSet);this._scheduledTaskSet.clear(),this._rafHandler=Je;for(let e of fi)if(!(!t.has(e)||e==="nothing"))try{this[e].call(this)}catch(r){console.error(e,r)}this._afterRenderCallbackList.forEach(e=>e()),this._afterRenderCallbackList.length=0}forceRunTasks(){this._rafHandler!==Je&&cancelAnimationFrame(this._rafHandler),this.renderTask()}addTask(t){return this._scheduledTaskSet.add(t),this._rafHandler===Je&&(this._rafHandler=requestAnimationFrame(()=>this.renderTask())),this}scheduleAddRowTasks(){this.addTask("virtualRender").addTask("resizeGridWrapperHeight").addTask("generateScrollBarClass")}getActualBodyRowsInfo(){var g,C;let t=this._grid.getRowCount()-1,e=Math.min(this._grid.getFreezedRowCount(),t),{fixedRowHeight:r}=this._grid,{scrollTop:n,clientHeight:i}=this._contextElement,l=(g=this._grid.getRowByTop(r+n+1))!=null?g:this._grid.firstRow,s=(C=this._grid.getRowByTop(n+i))!=null?C:this._grid.lastRow,c=O(0,e).asList();if(!l||!s)return{emptyRowHeight:0,viewRowList:c};let d=l.getTopRowId(),a=s.getBottomRowId(),h=this._grid.getRow(Math.max(d-2,e)),m=this._grid.getRow(Math.min(a+2,t));return{emptyRowHeight:h.top-r,viewRowList:c.concat(O(h.rowId,m.rowId+1).asList())}}getGridRow(t){var r;let e=parseInt((r=t.dataset.row)!=null?r:"",10);return e!==e?null:this._grid.getRow(e)}virtualRender(){let{emptyRowHeight:t,viewRowList:e}=this.getActualBodyRowsInfo(),r=new Set(e),n=this._grid.getFreezedRowCount(),{headerRows:i}=this._grid,l=this._tbody.lastElementChild;for(;l;){let d=this.getGridRow(l);l=l.previousElementSibling,d&&!r.has(d.rowId)&&d.unmount()}t===0?this._emptyRow.dataset.hidden="true":(this._emptyRow.dataset.hidden="false",Y(this._emptyRow,{[F.emptyRowHeight]:`${t}px`}));let s=null,c=!1;for(let d of e){let a=this._grid.getRow(d);if(d<n?!a.isFreezed&&a.freeze(d<i):c===!1&&(s===null?this._tbody.insertAdjacentElement("afterbegin",this._emptyRow):s.insertAdjacentElement("afterend",this._emptyRow),c=!0,s=this._emptyRow),a.isMounted){s=a.element;continue}s===null?a.mount(this._tbody,"afterbegin"):a.mount(s,"afterend"),s=a.element}}updateRowsStickyLeft(){for(let t=0;t<this._grid.getRowCount();t++)this._grid.getRow(t).updateStickyStatus()}updateSelection(){this._selector.update()}updateLeft(){let t=this._grid.getColCount(),e=0,r=0;for(;e<t;){let n=this._grid.getColumn(e);n.left=r,n.visible&&(r=n.right),++e}}updateTop(){let t=this._grid.getRowCount(),e=0,r=0;for(;e<t;){let n=this._grid.getRow(e);n.top=r,n.visible&&(r=n.bottom),++e}}updateColumnId(){let t=this._grid.getColCount(),e=0;for(;e<t;){let r=this._grid.getColumn(e);r.columnId=e,++e}this._grid.render()}updateRowId(){let t=this._grid.getRowCount(),e=this._grid.getFreezedRowCount(),r=0;for(;r<t;){let n=this._grid.getRow(r);n.rowId=r,n.isFreezed&&r>=e?n.unfreeze():!n.isFreezed&&r<e&&n.freeze(),n.render(),++r}}adjustSelection(){let t=this._gridContext.selectionRangeState.value;if(!t)return this._grid.releaseCells();let e=this._gridRangeUtil.adjustRange(t.range);if(!e)return this._grid.releaseCells();this._grid.select(this._gridRangeUtil.extendRange(e))}updateSelectionByScroll(){this._selector.updateScroll()}resizeGridWrapperHeight(){this._wrapperElement.style.height=`${this._grid.height}px`}generateScrollBarClass(){this._grid.generateScrollBarClass()}addAfterRenderTask(t){this._afterRenderCallbackList.push(t)}get isScheduled(){return this._scheduledTaskSet.size>0}};var et=class{constructor({grid:t,rowId:e,height:r,top:n,rowType:i}){this._rowElement=null;this._top=-1;this._maxCellHeight=0;this._stickyColumns=0;this._height=0;this._visible=!0;this._isCalledOnMounted=!1;this._grid=t,this._cells=[],this._rowType=i,this._rowId=e,this._maxCellHeight=r,this._isMounted=!1,this._height=r,this._top=n}get rowInnerHeight(){return this._cells.filter(t=>t.visible&&t.mergeInfo.rowSpan===1).reduce((t,e)=>Math.max(t,e.innerHeight),0)}get isFreezed(){return this.element.classList.contains(ze)}get isMounted(){return this._isMounted}get rowId(){return this._rowId}get isHeaderRow(){return this.element.classList.contains(Dt)}get cellCounts(){return this._cells.length}get rowType(){return this._rowType}initRowElement(){let t=document.createElement("tr");Y(t,{[F.cellHeight]:`${this._height}px`}),t.setAttribute("data-top",this._top.toString()),t.dataset.row=this._rowId.toString(),this._rowElement=t;for(let e of this._cells)t.appendChild(e.element),e.setStickyZIndex(this.getFreezedCellType(e.col),this._top,this._grid.getColumnLeft(e.col)),this.isMounted&&e.render();return t}get element(){return this._rowElement===null&&(this._rowElement=this.initRowElement()),this._rowElement}get textColor(){return this.element.style.color}get height(){return this._height}get heightWithBorder(){return this._height+1}get bottom(){return this.visible?this._top+this.heightWithBorder:this._top}get bottomByCellHeight(){return this._top+this._maxCellHeight}get stickyColumns(){return this._stickyColumns}get top(){return this._top}get visible(){return this._visible}set rowId(t){this._rowElement&&(this._rowElement.dataset.row=t.toString()),this._rowId=t,this._cells.forEach(e=>e.row=t),this.render()}set textColor(t){this.element.style.color=t}set height(t){this._height=t,Y(this.element,{[F.cellHeight]:`${t}px`}),this.onChangedHeight(this,t)}set top(t){this._top=t,this.element.setAttribute("data-top",t.toString()),this.updateStickyStatus()}set visible(t){t?(this._visible=!0,this.element.style.removeProperty("display"),this.render()):(this._visible=!1,this.element.style.display="none")}unmount(){this._isMounted=!1,this._rowElement&&this.element.remove()}updateMaxCellHeight(){let t=this.height;this._maxCellHeight=this._cells.reduce((e,r)=>{var n;return Math.max(e,(n=r.height)!=null?n:t)},t)}getEndOfColumnId(t){let{col:e,mergeInfo:r,mergeMain:n}=this._cells[t];return n?n.right:e+r.colSpan-1}getStartOfColumnId(t){let{mergeMain:e}=this._cells[t];return e?e.col:t}getMaxCellWidth(t,e){return O(t,e).reduce((r,n)=>{let i=this._cells[n];return i.visible&&i.mergeInfo.colSpan===1?Math.max(r,i.innerWidth):r},0)}renderColumns(t,e){if(this._rowElement!==null)for(let r=t;r<=e;r++)this._cells[r].render()}removeCells(t,e){O(t,e+1).forEach(n=>this._cells[n].element.remove());let r=1+e-t;this._cells.splice(t,r),O(t,this._cells.length).forEach(n=>{this._cells[n].col-=r,this._cells[n].render()})}getTopRowId(){let t=this._rowId;for(let e of this._cells)e.mergeMain&&(t=Math.min(t,e.mergeMain.row));return t}getBottomRowId(){let t=this._rowId;for(let e of this._cells)e.mergeMain?t=Math.max(t,e.mergeMain.bottom):e.mergeInfo.rowSpan>1&&(t=Math.max(t,e.bottom));return t}getFreezedCellType(t){let e=t<this._grid.getFreezedColumnCount();return this.isHeaderRow?e?Q.lv9:Q.lv8:this.isFreezed?e?t<this._grid.headerColumns?Q.lv7:Q.lv6:Q.lv5:e?t<this._grid.headerColumns?Q.lv4:Q.lv3:null}addCell(t){this._cells.push(t),this._rowElement&&(this._rowElement.appendChild(t.element),t.setStickyZIndex(this.getFreezedCellType(t.col),this._top,this._grid.getColumnLeft(t.col)),t.render())}insertCells(t,e){if(this._cells.length<e)throw new Error(`Out of length at the row. the length is ${this._cells.length} and you tried inserting with ${e}`);let r=this._cells[e].element;O(e,this._cells.length).forEach(n=>{this._cells[n].col+=t.length,this._cells[n].render()}),this._cells.splice(e,0,...t),t.forEach(n=>{n.setStickyZIndex(this.getFreezedCellType(n.col),this._top,this._grid.getColumnLeft(n.col)),r.insertAdjacentElement("beforebegin",n.element),this.isMounted&&n.render()})}reorderCells(){this._cells.forEach((e,r)=>void(e.col=r));let t=this._rowElement;t&&(mr(t),this._cells.forEach(e=>void t.appendChild(e.element)))}exchangeCells([t,e],[r,n]){if(e<t)throw new Error("sourceStart should be less than sourceEnd!");if(n<r)throw new Error("targetStart should be less than targetEnd!");if(t<=n&&e>=r)throw new Error(`Ranges overlap! source: ${t},${e}, target: ${r},${n}`);let[i,l,s,c]=t<r?[t,e,r,n]:[r,n,t,e];this._cells=[...this._cells.slice(0,i),...this._cells.slice(s,c+1),...this._cells.slice(l+1,s),...this._cells.slice(i,l+1),...this._cells.slice(c+1)],this.reorderCells()}moveCells([t,e],r){if(e<t)throw new Error("sourceStart should be less than sourceEnd!");if(t<=r&&e>=r)throw new Error(`Ranges overlap! source: ${t},${e}, target: ${r}`);let n=this._cells.splice(t,e-t+1),i=t<r?r-n.length:r;this._cells.splice(i,0,...n),this.reorderCells()}render(){this.visible&&this._cells.forEach(t=>t.render())}getCell(t){let e=this._cells[t];if(!e)throw new Error(`Not found cell ${this._rowId}, ${t}`);return e}setRowInfo(t){let{textData:e,cellMetaInfo:r}=t;this._cells.forEach((n,i)=>n.updateCellMetaInfo(r,e==null?void 0:e[i]))}*getCellGenerator(t=0,e=this._cells.length-1){for(let r=t;r<=e;++r)yield this._cells[r]}setColumnVisible(t,e){this._cells[t].visible=e}getColumnVisible(t){return this._cells[t].visible}setAutoHeight(t,e){let r=Math.ceil(this.rowInnerHeight),n=W(isNaN(r)?0:r,t,e);return this.height!==n?(this.height=n,!0):!1}mount(t,e){this.isMounted||(t.insertAdjacentElement(e,this.element),this.render(),this._isMounted=!0,this._isCalledOnMounted||(this._isCalledOnMounted=!0,this.onMounted(this)))}freeze(t=!1){t&&this.element.classList.add(Dt),this.element.classList.add(ze),this.updateStickyStatus()}isBetweenTop(t){return t>=this.top&&t<=this.bottom}updateStickyStatus(){this._cells.reduce((t,e,r)=>(e.setStickyZIndex(this.getFreezedCellType(r),this._top,t),t+(this._grid.getColumnVisible(r)?this._grid.getColumnWidth(r)+1:0)),0)}updateCellMetaInfo(t){this._cells.forEach(e=>e.cellInfo=t)}freezeColumns(t){this._stickyColumns=t,this.updateStickyStatus()}unfreeze(){if(this.isHeaderRow)throw new Error("Can not freeze header row!");this.element.classList.remove(ze),this.updateStickyStatus()}onMounted(t){}onChangedHeight(t,e){}},tt=class{constructor(t,e){this._rowList=[];this._visibleRowList=[];this._headerRows=t,this._freezedRows=e,this._rowsHeight=0,this._headerRowsHeight=0,this._freezedRowsHeight=0}getRow(t){let e=this._rowList[t];if(!e)throw new Error(`Not found row ${t}`);return e}addRow(t){this._rowList.push(t),this._visibleRowList.push(t),this.updateRowHeight(t,"add"),t.rowId<this.freezedRows&&this.updateFixedHeight()}getMaxCellWidth(t,e){return this._rowList.reduce((r,n)=>Math.max(r,n.getMaxCellWidth(t,e)),0)}clearRows(){O(this.headerRows,this._rowList.length).forEach(t=>this._rowList[t].unmount()),this._rowList.length=this.headerRows,this._rowsHeight=this.headerRowsHeight,this._freezedRowsHeight=this.headerRowsHeight,this.updateVisibleRowList()}addColumn(t){this._rowList.forEach(e=>e.addCell(t(e)))}setColumnVisible(t,e){this._rowList.forEach(r=>r.getCell(t).visible=e)}insertColumns(t,e,r){this._rowList.forEach(n=>{let i=O(e).map(l=>r(n.rowId,t+l));n.insertCells(i,t)})}removeRows(t,e){let r=this._rowList.splice(t,e-t+1);r.length!==0&&(r.forEach(n=>{this.updateRowHeight(n,"remove"),n.unmount()}),this.updateVisibleRowList(),this.updateFixedHeight())}removeColumns(t,e){this._rowList.forEach(r=>r.removeCells(t,e))}insertRows(t,e){let r=this._rowList[t].top;this._rowList.splice(t,0,...e),this.updateVisibleRowList();for(let n=0;n<e.length;n++){let i=e[n];i.top=r,this.updateRowHeight(i,"add"),r=i.bottom}this.updateFixedHeight()}moveRows([t,e],r){if(e<t)throw new Error("sourceStart should be less than sourceEnd!");if(t<=r&&e>=r)throw new Error(`Ranges overlap! source: ${t},${e}, target: ${r}`);let n=this._rowList.splice(t,e-t+1);n.forEach(l=>l.unmount());let i=t<r?r-n.length:r;this._rowList.splice(i,0,...n),this.updateVisibleRowList()}getAdjustTargetRow(t){return t>=this.length?this.length:t<this.freezedRows?this.freezedRows:this.getStartOfRowId(t)}exchangeRows([t,e],[r,n]){if(e<t)throw new Error("sourceStart should be less than sourceEnd!");if(n<r)throw new Error("targetStart should be less than targetEnd!");if(t<=n&&e>=r)throw new Error(`Ranges overlap! source: ${t},${e}, targetRow: ${r},${n}`);let[i,l,s,c]=t<r?[t,e,r,n]:[r,n,t,e],d=this._rowList.slice(i,l+1),a=this._rowList.slice(s,c+1);d.forEach(h=>h.unmount()),a.forEach(h=>h.unmount()),this._rowList=[...this._rowList.slice(0,i),...a,...this._rowList.slice(l+1,s),...d,...this._rowList.slice(c+1)],this.updateVisibleRowList()}isHeaderRowId(t){return t<this.headerRows}isInvalidRowId(t){return t<0||t>=this._rowList.length}addFixedHeight(t,e,r=1){e<this.headerRows&&(this._headerRowsHeight+=t.heightWithBorder*r),e<this.freezedRows&&(this._freezedRowsHeight+=t.heightWithBorder*r)}updateFixedHeight(){this._headerRowsHeight=0,this._freezedRowsHeight=0;let t=0,e=Math.min(this.length,this.freezedRows);for(let r of this._rowList)if(r.visible&&(this.addFixedHeight(r,t),++t),t>=e)break}updateCellReadonlyStatus(){this._rowList.forEach(t=>{let e=t.cellCounts;for(let r=0;r<e;r++)t.getCell(r).updateReadonlyStatus()})}setRowHeight(t,e){let r=this.getRow(t),n=r.height-e;n!==0&&(r.height=e,this.changeRowHeight(r,n))}setRowVisible(t,e){let r=this.getRow(t);e!==r.visible&&(r.visible=e,this.updateRowHeight(r,e?"show":"hide"),this.updateVisibleRowList(),this.updateFixedHeight())}updateVisibleRowList(){this._visibleRowList=this._rowList.filter(t=>t.visible)}changeRowHeight(t,e){this._rowsHeight-=e,t.rowId<this.headerRows&&(this._headerRowsHeight-=e),t.rowId<this.freezedRows&&(this._freezedRowsHeight-=e)}updateRowHeight(t,e){if(e==="remove"&&!t.visible)return;let r=t.height+1,n=e==="add"||e==="show"?r:-r;this._rowsHeight+=n}sort(t,e,r,n){let i=this._rowList.slice(0,r),l=this._rowList.slice(r,n),s=this._rowList.slice(n);l.forEach(c=>c.unmount()),l.sort((c,d)=>e==="ASC"?t(c,d):-t(c,d)),this._rowList=[...i,...l,...s],this.updateVisibleRowList()}unfreezeAllRows(){let t=this.headerRows+1,e=this._rowList[t];for(;e&&e.isFreezed;)e.unfreeze(),e=this._rowList[++t]}freezeRowsByCount(t){let e=this.headerRows;for(let r=0;r<t;r++){let n=this._rowList[e];if(!n)break;n.freeze(),e++}}freezeRows(t){this._freezedRows=t,this.unfreezeAllRows(),this.freezeRowsByCount(t),this.updateFixedHeight()}renderRows(){this._visibleRowList.forEach(t=>t.render())}getTopByRowId(t){return this.getRow(t).top}getBottomByRowId(t){return this.getRow(t).bottom}getNextRowId(){return this._rowList.length}getCell(t,e){return this.getRow(t).getCell(e)}cell(t,e){return this.getCell(t,e)}getRowHeight(t){return this.getRow(t).height}getRowVisible(t){return this.getRow(t).visible}getRowCount(){return this._rowList.length}runFuncEachRow(t,e,r){let n=e!=null?e:0,i=r!=null?r:this.length;for(let l=n;l<i;l++)t(this._rowList[l])}getStartOfRowId(t){let e=this.getRow(t);for(;e;){let r=e.getTopRowId();if(r!==e.rowId)e=this.getRow(r);else return e.rowId}throw new Error(`wrong searching row id from '${t}'`)}getEndOfRowId(t){let e=this.getRow(t);for(;e;){let r=e.getBottomRowId();if(r!==e.rowId)e=this.getRow(r);else return e.rowId}throw new Error(`wrong searching row id from '${t}'`)}getEndOfColumnId(t){let e=this.reduceRows({initValue:t,func:(r,n)=>Math.max(r,n.getEndOfColumnId(t))});return e===t?e:this.getEndOfColumnId(e)}getStartOfColumnId(t){let e=this.reduceRows({initValue:t,func:(r,n)=>Math.min(r,n.getStartOfColumnId(t))});return e===t?e:this.getStartOfColumnId(e)}reduceRows(t){let{top:e=0,bottom:r=this._rowList.length}=t,n=t.initValue;for(let i=e;i<r;i++)n=t.func(n,this._rowList[i]);return n}getRowByTop(t){let e=this.visibleRowList,r=0,n=e.length-1;for(;r<=n;){let i=r+Math.floor((n-r)/2),l=e[i];if(l.isBetweenTop(t))return l;t<l.top?n=i-1:r=i+1}return null}get visibleRowList(){return this._visibleRowList}get freezedRowsHeight(){return this._freezedRowsHeight}get headerRowsHeight(){return this._headerRowsHeight}get rowsHeight(){return this._rowsHeight}get length(){return this._rowList.length}get headerRows(){return this._headerRows}get freezedRows(){return this._headerRows+this._freezedRows}get bodyFreezedRows(){return this._freezedRows}get firstRow(){return this._rowList[0]}get lastRow(){return this._rowList[this._rowList.length-1]}};var rt=class{constructor({columnId:t,width:e,left:r}){this._left=0;this._columnId=0;this._width=0;this._visible=!0;this._colElement=document.createElement("col"),this.columnId=t,this.width=e,this.left=r}get columnId(){return this._columnId}get left(){return this._left}get width(){return this._width}get widthWithBorder(){return this._width+1}get colElement(){return this._colElement}get visible(){return this._visible}get right(){return this.visible?this.left+this.widthWithBorder:this.left}set visible(t){this._visible=t,t?this._colElement.style.removeProperty("display"):this._colElement.style.display="none"}set columnId(t){this._columnId=t,this._colElement.dataset.column=t.toString()}set left(t){this._left=t,this._colElement.dataset.left=t.toString()}set width(t){this._width=t,this._colElement.style.width=`${this.widthWithBorder}px`,this._colElement.dataset.width=t.toString()}remove(){this._colElement.remove()}isBetweenLeft(t){return t>=this.left&&t<=this.right}},nt=class{constructor(t,e){this._columnsList=[];this._visibleColumnsList=[];this._columnsWidth=0;this._rowHeaderColumnsWidth=0;this._freezedColumnsWidth=0;this._colGroup=document.createElement("colgroup"),this._rowHeaderColumns=t,this._freezedColumns=e}addColumn(t){let e=new rt({columnId:this._columnsList.length,width:t,left:this._columnsWidth});return this._colGroup.appendChild(e.colElement),this._columnsList.push(e),this._visibleColumnsList.push(e),this.updateColumnWidth(e,"add"),this.addFixedWidth(e),e}isHeaderColumnId(t){return t<this.headerColumns}isInvalidColumnId(t){return t<0||t>=this._columnsList.length}updateVisibleColumnList(){this._visibleColumnsList=this._columnsList.filter(t=>t.visible)}updateColumnWidth(t,e){if(e==="remove"&&!t.visible)return;let r=e==="add"||e==="show"?t.widthWithBorder:-t.widthWithBorder;this._columnsWidth+=r}removeColumns(t,e){this._columnsList.splice(t,e-t+1).forEach(n=>{this.updateColumnWidth(n,"remove"),n.remove()}),this.updateVisibleColumnList(),this.updateFixedWidth()}freezeColumns(t){this._freezedColumns=t,this.updateFixedWidth()}changeColumnWidth(t,e){this._columnsWidth-=e,t.columnId<this.headerColumns&&(this._rowHeaderColumnsWidth-=e),t.columnId<this.freezedColumns&&(this._freezedColumnsWidth-=e)}insertColumns(t,e,r){let n=this.getColumn(t),i=n.left,l=O(e).map(s=>new rt({columnId:t+s,width:r,left:i+(r+1)*s}));this._columnsList.splice(t,0,...l),l.forEach(s=>{n.colElement.insertAdjacentElement("beforebegin",s.colElement),this.updateColumnWidth(s,"add")}),this.updateVisibleColumnList(),this.updateFixedWidth()}addFixedWidth(t,e=1){t.columnId<this.headerColumns&&(this._rowHeaderColumnsWidth+=t.widthWithBorder*e),t.columnId<this.freezedColumns&&(this._freezedColumnsWidth+=t.widthWithBorder*e)}updateFixedWidth(){this._rowHeaderColumnsWidth=0,this._freezedColumnsWidth=0;let t=0,e=Math.min(this.freezedColumns,this._columnsList.length);for(;t<e;){let r=this.getColumn(t);r.visible&&this.addFixedWidth(r),++t}}setColumnWidth(t,e){let r=this.getColumn(t),n=r.width-e;n!==0&&(r.width=e,this.changeColumnWidth(r,n))}setColumnVisible(t,e){let r=this.getColumn(t);r.visible!==e&&(r.visible=e,this.updateColumnWidth(r,e?"show":"hide"),this.updateVisibleColumnList(),this.addFixedWidth(r,e?1:-1))}getColumnLeft(t){return this.getColumn(t).left}getColumnRight(t){return this.getColumn(t).right}getColumnWidth(t){return this.getColumn(t).width}getColumnVisible(t){return this.getColumn(t).visible}getColCount(){return this._columnsList.length}getColumn(t){let e=this._columnsList[t];if(!e)throw new Error("No column");return e}updateColumnsLeftFrom(t){O(t,this._columnsList.length).reduce((e,r)=>{let n=this._columnsList[r];return n.left=e,n.visible?e+n.width+1:e},this.getColumn(t).left)}get colgroup(){return this._colGroup}get visibleColumnList(){return this._visibleColumnsList}get columnsWidth(){return this._columnsWidth}get rowHeaderColumnsWidth(){return this._rowHeaderColumnsWidth}get length(){return this._columnsList.length}get fixedColumnsWidth(){return this._freezedColumnsWidth}get headerColumns(){return this._rowHeaderColumns}get freezedColumns(){return this._rowHeaderColumns+this._freezedColumns}get bodyFreezedColumns(){return this._freezedColumns}};function pi(o){return o.top===o.bottom&&o.left===o.right}function Ci(o){return o.top>o.bottom||o.left>o.right}function ho(o,t){let e=[],r=new J(o,t),n=({top:a,left:h,bottom:m,right:g})=>e.some(({mergeArea:C})=>h<=C.right&&g>=C.left&&a<=C.bottom&&m>=C.top)===!1,i=(a,h)=>{let m=0;for(let g=a;g<=h;++g)o.getRowVisible(g)&&++m;return m},l=(a,h)=>{let m=0;for(let g=a;g<=h;++g)t.getColumnVisible(g)&&++m;return m},s=({top:a,left:h,bottom:m,right:g})=>{for(let C=a;C<=m;++C)if(o.getRowVisible(C)===!1)return!0;for(let C=h;C<=g;++C)if(t.getColumnVisible(C)===!1)return!0;return!1},c=(a,h)=>{let m=o.getCell(a,h),g=e.indexOf(m);return g<0?null:e[g]},d=a=>new Set([...r.getSelectionGenerator(a)].map(h=>h.zIndexVariant)).size>1;return{isValidatedMerging:n,getMergedRowHeight(a,h){let m=(h-a)*1,g=0;for(let C=a;C<=h;++C)o.getRowVisible(C)&&(g+=o.getRowHeight(C));return g+m},mergeCells(a){if(Ci(a))throw new Error("Invalid range");if(n(a)===!1)throw new Error("Could not merging with Conflicted cells!");if(s(a))throw new Error("Could not merging with hidden cells!");if(pi(a))throw new Error("Could not merging with single cell!");if(d(a))throw new Error("Could not merging with different z-index!");let h=o.getCell(a.top,a.left);h.height=this.getMergedRowHeight(a.top,a.bottom),h.mergeInfo={rowSpan:i(a.top,a.bottom),colSpan:l(a.left,a.right)},e.push(h),o.getRow(a.top).updateMaxCellHeight();for(let g of r.getSelectionGenerator(a))(g.row!==a.top||g.col!==a.left)&&(g.mergeMain=h,g.metaInfo.text="")},splitCells(a,h){let m=c(a,h);if(!m)throw new Error("Could not split on a not merged cell!");for(let g of r.getSelectionGenerator(m.mergeArea))g.mergeMain=void 0,g.mergeInfo={rowSpan:1,colSpan:1};this.removeMergeCell(a,h),o.getRow(a).updateMaxCellHeight()},isMerged(a,h){return!n({top:a,left:h,bottom:a,right:h})},*getMergedCellGenerator(a){for(let h of r.getSelectionGenerator(a))(h.mergeInfo.rowSpan>1||h.mergeInfo.colSpan>1)&&(yield h)},removeMergeCell(a,h){let m=c(a,h);if(!m)throw new Error("Could not split on a not merged cell!");e.splice(e.indexOf(m),1)},checkConflictingInRows(a,h){for(let{mergeArea:m}of e)if(m.top<a&&m.bottom>=a&&m.bottom<=h||m.bottom>h&&m.top>=a&&m.top<=h||m.top<a&&m.bottom>h)return!0;return!1},checkConflictingInColumns(a,h){for(let{mergeArea:m}of e)if(m.left<a&&m.right>=a&&m.right<=h||m.right>h&&m.left>=a&&m.left<=h||m.left<a&&m.right>h)return!0;return!1},checkCanInsertRow(a){for(let{mergeArea:h}of e)if(h.top<a&&h.bottom>=a)return!1;return!0},checkCanInsertColumn(a){for(let{mergeArea:h}of e)if(h.left<a&&h.right>=a)return!1;return!0}}}var ot=class{constructor(t){let e=ie();this._gridThemeConfig={"grid.paddingTop":e.getStoreValue("grid.paddingTop"),"grid.paddingBottom":e.getStoreValue("grid.paddingBottom"),"grid.paddingLeft":e.getStoreValue("grid.paddingLeft"),"grid.paddingRight":e.getStoreValue("grid.paddingRight"),"grid.defaultRowHeight":e.getStoreValue("grid.defaultRowHeight"),"grid.defaultColumnWidth":e.getStoreValue("grid.defaultColumnWidth"),"grid.defaultRowMinSize":e.getStoreValue("grid.defaultRowMinSize"),"grid.defaultRowMaxSize":e.getStoreValue("grid.defaultRowMaxSize"),"grid.defaultColumnMinSize":e.getStoreValue("grid.defaultColumnMinSize"),"grid.defaultColumnMaxSize":e.getStoreValue("grid.defaultColumnMaxSize"),"grid.defaultDropdownWidth":e.getStoreValue("grid.defaultDropdownWidth"),"grid.defaultFontFamily":e.getStoreValue("grid.defaultFontFamily"),"grid.defaultFontSize":e.getStoreValue("grid.defaultFontSize")},this._rowManager=new tt(t.headerRowCount,t.freezedRowCount),this._columnManager=new nt(t.headerColumnCount,t.freezedColumnCount),this._mergeHandler=ho(this._rowManager,this._columnManager)}getThemeValue(t){return this._gridThemeConfig[t]}get mergeHandler(){return this._mergeHandler}get rowManager(){return this._rowManager}get columnManager(){return this._columnManager}};var fe=class extends D{_execute(){this._instance.setColumnWidth(...this._args)}_getUndoContext(){return{latestWidth:this._instance.getColumnWidth(this._args[0])}}_undo(){this._instance.setColumnWidth(this._args[0],this._undoContext.latestWidth)}get canExecute(){return this._args[0]<this._instance.getColCount()}get canUndo(){return this._args[0]<this._instance.getColCount()}};var pe=class extends D{_execute(){this._instance.setRowHeight(...this._args)}_getUndoContext(){return{latestHeight:this._instance.getRowHeight(this._args[0])}}_undo(){this._instance.setRowHeight(this._args[0],this._undoContext.latestHeight)}get canExecute(){return this._args[0]<this._instance.getRowCount()}get canUndo(){return this._args[0]<this._instance.getRowCount()}};var P=class{constructor(){this._mountRollbackStack=[];this._isMounted=!1}_mountTask(t){throw new Error("unmount method not implemented.")}mount(t){if(this.isMounted)throw new Error("Already mounted plugin!");try{this._mountTask(t),this._isMounted=!0}catch(e){console.error("Plugin mount error!",e),this.unmount()}}unmount(){if(!this.isMounted)throw new Error("Already unmounted plugin!");try{for(let t of this._mountRollbackStack)t();this._mountRollbackStack.length=0,this._isMounted=!1}catch(t){console.error("Plugin unmount error!",t)}}get isMounted(){return this._isMounted}};var Ri=12,wi=4,bi={"col-resizing":We,"row-resizing":Pe},go={"col-resizing":pn,"row-resizing":Cn},fo=o=>o.mergeInfo?o.col+o.mergeInfo.colSpan-1:o.col,po=o=>o.mergeInfo?o.row+o.mergeInfo.rowSpan-1:o.row,_i=500,Co=4,Me=class extends P{constructor(t){super(),this._options=t}_mountTask({grid:t,wrapperElement:e,gridContext:r,contextElement:n}){let{enabledColResizer:i,enabledRowResizer:l}=this._options,s=(h,m,g)=>{t.commandManager.pushCommandBlock(new X(h,new fe(t,[m,g])))},c=(h,m,g)=>{t.commandManager.pushCommandBlock(new X(h,new pe(t,[m,g])))};(function(){let m=document.createElement("div"),g=!1,C=null,I=0,w=()=>{n.classList.remove(We),n.classList.remove(Pe),n.classList.remove("is-resizing"),C&&n.removeEventListener("mousedown",C)},T=(u,p)=>{C&&n.removeEventListener("mousedown",C),n.classList.remove(We),n.classList.remove(Pe),n.classList.add(bi[p]),n.classList.add("is-resizing");let R=0,_=0,G=0,f=0,b=0,y=()=>u.col<t.getFreezedColumnCount()?t.scrollLeft+f:f,S=()=>u.row<t.getFreezedRowCount()?t.scrollTop+f:f;C=A=>{let H=new Date().getTime();if(r.setMode({mode:p,contextParam:{}}),H-I<=_i){p==="col-resizing"?t.commandManager.doRecording("Autosize column",()=>{t.autoSizeColumn(u.col)}):t.commandManager.doRecording("Autosize row",()=>{t.autoSizeRow(u.row)}),I=0;return}g=!0,I=H,u.element.classList.add(go[p]),p==="col-resizing"?(m.className=fn,b=t.getColumnWidth(fo(u)),R=A.pageX,_=R-b+t.minColWidth,G=R-b+t.maxColWidth,f=t.getColumnLeft(u.col)+t.getCellWidth(u),m.style.top="0px",m.style.width="0px",m.style.height=`${t.height}px`,m.style.left=`${y()}px`):(m.className=Rn,b=t.getRowHeight(po(u)),R=A.pageY,_=R-b+t.minRowHeight,G=R-b+t.maxRowHeight,f=t.getRow(u.row).top+t.getCellHeight(u),m.style.top=`${S()}px`,m.style.width=`${t.width}px`,m.style.height="0px",m.style.left="0px"),e.appendChild(m),t.addGlobalEventListener(document,"keydown",k),t.addGlobalEventListener(document,"mouseup",v),t.addGlobalEventListener(document,"mousemove",E)};let E=A=>{if(p==="col-resizing"){let H=W(A.pageX,_,G)-R;m.style.left=`${y()+H}px`}else{let H=W(A.pageY,_,G)-R;m.style.top=`${S()+H}px`}},v=A=>{if(p==="col-resizing"){let N=W(A.pageX,_,G)-R;if(Math.abs(N)>Co){let j=fo(u),z=b+N;s("Resize column",j,z),t.setColumnWidth(j,z),I=0}}else{let N=W(A.pageY,_,G)-R;if(Math.abs(N)>Co){let j=po(u),z=b+N;c("Resize row",j,z),t.setRowHeight(j,z),I=0}}M(),r.setIdle();let H=d(A);if(!H)return;let de=a(A,H);de!==null&&T(H,de)};function M(){g=!1,m.remove(),w(),u.element.classList.remove(go[p]),document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",v),document.removeEventListener("keydown",k)}let k=A=>{A.key==="Escape"&&M()};t.addGlobalEventListener(n,"mousedown",C)},x=u=>{if(g)return;let p=d(u);if(p===null){w();return}let R=a(u,p);R===null?w():T(p,R)},L=u=>{w()};t.addGlobalEventListener(n,"mousemove",x),t.addGlobalEventListener(n,"mouseout",L)})();let d=h=>{let m=K("th","tr",h.target);if(!m)return null;let[g,C]=[parseInt(m.getAttribute("data-row")||"-1"),parseInt(m.getAttribute("data-col")||"-1")];return t.cell(g,C)},a=(h,m)=>m.cellType==="body-cell"?null:i&&Math.abs(t.getCellWidth(m)-h.offsetX)<=Ri?"col-resizing":l&&Math.abs(t.getCellHeight(m)-h.offsetY)<=wi?"row-resizing":null}get pluginKey(){return"resizer"}};function Va(o){return new Me(o)}var Ii=15,it=120,Ge=class extends P{_mountTask({grid:t,gridContext:e,contextElement:r}){let n=null,i=null,l,s=(g,C)=>{let I=[g.row,g.bottom,C.row,C.bottom],w=[g.col,g.right,C.col,C.right],T={top:Math.min(...I),left:Math.min(...w),bottom:Math.max(...I),right:Math.max(...w)};Fe(T,t.getSelection())||(t.select(T,n),this.onChangedSelection(T))};t.addGlobalEventListener(r,"mousedown",g=>{if(!te(g.target)||g.button!==0||g.target instanceof HTMLTextAreaElement||K(".button","tr",g.target))return;let C=K("td","tr",g.target);if(!C)return;let I=Z(C),w=t.activeCell;g.shiftKey&&w?(n=w,s(w,t.cell(I.row,I.col))):(n=t.cell(I.row,I.col),t.selectRange(n.row,n.col,n.bottom,n.right,n),this.onChangedSelection({top:n.row,left:n.col,bottom:n.bottom,right:n.right})),i=n,e.setMode({mode:"selecting-mouse",contextParam:{}})});function c(g,C){let I=C.closest("td");if(!I)return;let w=Z(I);i=t.cell(w.row,w.col),s(g,i)}function d(g,C){let{offsetX:I,offsetY:w,target:T}=g;if(!te(T))return null;let x=I+T.scrollLeft,L=w+T.scrollTop,u=x>t.width?t.width:x,p=L>t.height?t.height:L,R=t.findCellOrNull(p,u);R&&(i=R,s(C,R))}function a(g){var R,_,G,f;let C=g.clientWidth+g.scrollLeft,I=g.clientHeight+g.scrollTop,w=g.scrollTop+t.headerHeight,T=g.scrollLeft+t.headerWidth,x=I>t.height?t.height:I,L=C>t.width?t.width:C,u=t.findCellOrNull(w,T),p=t.findCellOrNull(x,L);return{top:(R=u==null?void 0:u.row)!=null?R:0,bottom:(_=p==null?void 0:p.row)!=null?_:0,left:(G=u==null?void 0:u.col)!=null?G:0,right:(f=p==null?void 0:p.col)!=null?f:0}}function h(g,C,I,w){l=window.setTimeout(()=>{if(!n)return;let L=T(),u=x(),{top:p,bottom:R,left:_,right:G}=a(g),f={top:g.scrollTop,left:g.scrollLeft,targetRow:I,targetCol:w};L&&(C.startsWith("t")?(f.top-=t.getRowHeight(p),f.targetRow=p):(f.top+=t.getRowHeight(R),f.targetRow=R)),u&&(C.endsWith("l")?(f.left-=t.getColumnWidth(_),f.targetCol=_):(f.left+=t.getColumnWidth(G),f.targetCol=G)),(L||u)&&(g.scrollTo({top:f.top,left:f.left}),s(n,t.cell(f.targetRow,f.targetCol)),h(g,C,f.targetRow,f.targetCol))},Ii);function T(){return C.startsWith("t")?g.scrollTop>0:C.startsWith("b")?g.scrollHeight-(g.scrollTop+g.clientHeight)>0:!1}function x(){return C.endsWith("l")?g.scrollLeft>0:C.endsWith("r")?g.scrollWidth-(g.scrollLeft+g.clientWidth)>0:!1}}function m(){l&&(clearTimeout(l),l=void 0)}t.addGlobalEventListener(r,"mousemove",g=>{n&&te(g.target)&&(g.target===r?d(g,n):c(n,g.target))}),t.addGlobalEventListener(document,"mouseup",()=>{n&&(m(),n=null,i=null,e.setIdle(),r.focus())}),t.addGlobalEventListener(r,"mouseleave",({currentTarget:g,clientY:C,clientX:I})=>{if(!n||!i||!te(g))return;let{top:w,bottom:T,left:x,right:L}=g.getBoundingClientRect();if(w<C&&T>C&&x<I&&L>I)return;h(g,`${u()}${p()}`,i.row,i.col);function u(){return C-w<=it?"t":T-C<=it?"b":""}function p(){return I-x<=it?"l":L-I<=it?"r":""}}),t.addGlobalEventListener(r,"mouseenter",g=>{n&&te(g.currentTarget)&&m()}),t.onDoubleClickCell=g=>e.isIdle&&t.doEditMode(g),t.onColumnClick=g=>t.selectColumn(g.col),t.onRowClick=g=>t.selectRow(g.row)}get pluginKey(){return"cell-selector"}onChangedSelection(t){}};function Ya(){return new Ge}var Ce=class extends D{_getUndoContext(){let[t]=this._args,e=[],r=new J(this._instance,this._instance);for(let n of r.getSelectionGenerator(t))n.canClear&&e.push({row:n.row,col:n.col,text:n.text});return{textSnapshot:e}}_undo(){let{textSnapshot:t}=this._undoContext;t.forEach(({row:e,col:r,text:n})=>{this._instance.setCell(e,r,{text:n}),this._instance.onEditCellDone(this._instance.cell(e,r),!0,"","",0,0)})}_execute(){let[t]=this._args;this._instance.clearCells(t)}get canUndo(){return!0}get canExecute(){return!0}};function lt(o,t){let e=(f,b,y)=>{var M;let S=o.headerRows,E=y,v=f;for(;E!==0;){let k=o.cell(v,b),H=((M=k.mergeMain)!=null?M:k).row-1;if(H<S)break;o.getRowVisible(H)&&++E,v=H}return v},r=(f,b,y)=>{var M;let S=o.getRowCount()-1,E=y,v=f;for(;E!==0;){let k=o.cell(v,b),H=((M=k.mergeMain)!=null?M:k).bottom+1;if(H>S)break;o.getRowVisible(H)&&--E,v=H}return v},n=(f,b,y)=>{var M;let S=o.headerColumns,E=y,v=b;for(;E!==0;){let k=o.cell(f,v),H=((M=k.mergeMain)!=null?M:k).col-1;if(H<S)break;o.getColumnVisible(H)&&++E,v=H}return v},i=(f,b,y)=>{var M;let S=o.getColCount()-1,E=y,v=b;for(;E!==0;){let k=o.cell(f,v),H=((M=k.mergeMain)!=null?M:k).right+1;if(H>S)break;o.getColumnVisible(H)&&--E,v=H}return v},l=()=>{let f=o.headerColumns;for(;!o.getColumnVisible(f);)++f;return f},s=()=>{let f=o.getColCount()-1;for(;!o.getColumnVisible(f);)--f;return f},c=()=>{let f=o.headerRows;for(;!o.getRowVisible(f);)++f;return f},d=()=>{let f=o.getRowCount()-1;for(;!o.getRowVisible(f);)--f;return f},a=f=>{if(o.getRowCount()-1===f)return f;let y=f+1;for(;!o.getRowVisible(y);)++y;return y},h=f=>{let b=o.headerRows;if(f===b)return f;let y=f-1;for(;!o.getRowVisible(y);)++y;return y},m=()=>{var E;let{activeCell:f}=o;if(!f){console.warn("No active cell warning.");return}let b=d(),y=s(),S=(E=f.mergeMain)!=null?E:f;if(S.right===y){if(f.row===b)return;let v=l(),M=a(f.row);t?o.selectRow(M,o.cell(M,v)):o.selectCell(M,v),o.scrollInView(M,v)}else{let v=i(f.row,S.right,1);t?o.selectRow(f.row,o.cell(f.row,v)):o.selectCell(f.row,v),o.scrollOnCol(v)}},g=()=>{var E;let{activeCell:f}=o;if(!f){console.warn("No active cell warning.");return}let b=c(),y=l(),S=(E=f.mergeMain)!=null?E:f;if(S.col===y){if(f.row===b)return;let v=s(),M=h(f.row);t?o.selectRow(M,o.cell(M,v)):o.selectCell(M,v),o.scrollInView(M,v)}else{let v=n(f.row,S.col,-1);t?o.selectRow(f.row,o.cell(f.row,v)):o.selectCell(f.row,v),o.scrollOnCol(v)}},C=(f,b,y)=>{var v;let S=-1,E=-1;for(let M=b;M<=y;M++){let k=o.cell(f,M),A=(v=k.mergeMain)!=null?v:k,{rowSpan:H}=A.mergeInfo;H>S&&(S=H,E=M)}return E},I=(f,b,y)=>{var E;let S=-1;for(let v=b;v<=y;v++){let M=o.cell(f,v),k=(E=M.mergeMain)!=null?E:M,{bottom:A}=k;A>S&&(S=A)}return S},w=(f,b,y)=>{var E;let S=999999999;for(let v=b;v<=y;v++){let M=o.cell(f,v),k=(E=M.mergeMain)!=null?E:M;S>k.row&&(S=k.row)}return S},T=(f,b,y)=>{var v;let S=-1,E=-1;for(let M=b;M<=y;M++){let k=o.cell(M,f),A=(v=k.mergeMain)!=null?v:k,{colSpan:H}=A.mergeInfo;H>S&&(S=H,E=M)}return E},x=(f,b,y)=>{var E;let S=-1;for(let v=b;v<=y;v++){let M=o.cell(v,f),k=(E=M.mergeMain)!=null?E:M,{right:A}=k;A>S&&(S=A)}return S},L=(f,b,y)=>{var E;let S=999999999;for(let v=b;v<=y;v++){let M=o.cell(v,f),k=(E=M.mergeMain)!=null?E:M;S>k.col&&(S=k.col)}return S};return{getNextYAbove:e,getNextYBelow:r,getNextXLeft:n,getNextXRight:i,selectNextActiveCell:m,selectBeforeActiveCell:g,selectNextSelection:(f,b,y)=>{var de;let S=o.getSelection(),{activeCell:E}=o;if(S==null||E==null){console.warn("No selection warning");return}let v=(de=E.mergeMain)!=null?de:E;if(y&&t)return;if(!y){if(f!==0){let N=f<0?e(v.row,E.col,f):r(v.bottom,E.col,f);t?o.selectRow(N,o.cell(N,E.col)):o.selectCell(N,E.col),o.scrollOnRow(N)}else{let N=b<0?n(E.row,v.col,b):i(E.row,v.right,b);t?o.selectRow(E.row,o.cell(E.row,N)):o.selectCell(E.row,N),o.scrollOnCol(N)}return}let{top:M,bottom:k,left:A,right:H}=S;if(f!==0)if(f<0)if(I(E.row,A,H)===k){let j=C(M,A,H),z=e(M,j,f);o.selectRange(z,A,k,H,E),o.scrollOnRow(z)}else{let j=C(k,A,H),z=e(k,j,f);o.selectRange(M,A,z,H,E),o.scrollOnRow(z)}else if(w(E.row,A,H)===M){let j=C(k,A,H),z=r(k,j,f);o.selectRange(M,A,z,H,E),o.scrollOnRow(z)}else{let j=C(M,A,H),z=r(M,j,f);o.selectRange(z,A,k,H,E),o.scrollOnRow(z)}else if(b<0)if(x(E.col,M,k)===H){let j=T(A,M,k),z=n(j,A,b);o.selectRange(M,z,k,H,E),o.scrollOnCol(z)}else{let j=T(H,M,k),z=n(j,H,b);o.selectRange(M,A,k,z,E),o.scrollOnCol(z)}else if(L(E.col,M,k)===A){let j=T(H,M,k),z=i(j,H,b);o.selectRange(M,A,k,z,E),o.scrollOnCol(z)}else{let j=T(A,M,k),z=i(j,A,b);o.selectRange(M,z,k,H,E),o.scrollOnCol(z)}},selectMoveToLastColumn:f=>{let b=o.getSelection(),{activeCell:y}=o;if(b==null||y==null){console.warn("No selection warning");return}let S=s();f&&t||(f?o.selectRange(b.top,y.col,b.bottom,S,y):t?o.selectRow(y.row,o.cell(y.row,S)):o.selectCell(y.row,S),o.scrollOnCol(S))},selectMoveToFirstColumn:f=>{let b=o.getSelection(),{activeCell:y}=o;if(b==null||y==null){console.warn("No selection warning");return}let S=l();f&&t||(f?o.selectRange(b.top,S,b.bottom,y.col,y):t?o.selectRow(y.row,o.cell(y.row,S)):o.selectCell(y.row,S),o.scrollOnCol(S))},selectMoveToLastRow:f=>{let b=o.getSelection(),{activeCell:y}=o;if(b==null||y==null){console.warn("No selection warning");return}let S=d();f&&t||(f?o.selectRange(y.row,b.left,S,b.right,y):o.selectCell(S,y.col),o.scrollOnRow(S))},selectMoveToFirstRow:f=>{let b=o.getSelection(),{activeCell:y}=o;if(b==null||y==null){console.warn("No selection warning");return}let S=c();f&&t||(f?o.selectRange(S,b.left,y.bottom,b.right,y):o.selectCell(S,y.col),o.scrollOnRow(S))}}}var st=class{constructor(){this.keyMap={}}addKeyAction(t,e){this.keyMap[t]||(this.keyMap[t]=[]),this.keyMap[t].push(e)}hasKeyAction(t){return this.keyMap[t]&&this.keyMap[t].length>0}startKeyAction(t){if(this.hasKeyAction(t.key)){if(this.onStartKeyActionHook(t),this.keyMap[t.key])for(let e of this.keyMap[t.key])try{if(e(t)===!1)break}catch(r){console.error(r);break}this.onEndKeyActionHook(t)}}onStartKeyActionHook(t){}onEndKeyActionHook(t){}};var Ro=10,Te=class extends P{constructor({keyMiddleware:t=[],rowSelection:e=!1}){super(),this._keyMiddleware=t,this._rowSelection=e}_mountTask({grid:t,gridContext:e,contextElement:r,gridStore:n,wrapperElement:i}){let l=new st;l.onEndKeyActionHook=u=>{u.key.match(/^[\S]$/)||u.preventDefault()};let s=(u=!1)=>{var R,_;if(!e.isIdle)return;let p=(_=(R=t.activeCell)==null?void 0:R.mergeMain)!=null?_:t.activeCell;p&&t.doEditMode(p,u)};this._keyMiddleware.forEach(([u,p])=>l.addKeyAction(u,p));let c=new J(n.rowManager,n.columnManager),{selectNextActiveCell:d,selectNextSelection:a,selectBeforeActiveCell:h,selectMoveToFirstRow:m,selectMoveToFirstColumn:g,selectMoveToLastColumn:C,selectMoveToLastRow:I}=lt(t,this._rowSelection),w=u=>p=>{p.target instanceof HTMLElement&&p.target.closest(`.${ye}`)||u(p)};t.addGlobalEventListener(r,"focus",()=>{let u=document.createRange();u.setStart(r,0),u.setEnd(r,0);let p=window.getSelection();p&&(p.removeAllRanges(),p.addRange(u))}),t.addGlobalEventListener(r,"copy",w(u=>t.onNativeCopy(u))),t.addGlobalEventListener(r,"cut",w(u=>t.onNativeCut(u))),t.addGlobalEventListener(r,"paste",w(u=>t.onNativePaste(u))),l.addKeyAction("Tab",u=>(u.shiftKey?h():d(),!0)),l.addKeyAction("ArrowRight",u=>(u.ctrlKey?C(u.shiftKey):a(0,1,u.shiftKey),!0)),l.addKeyAction("ArrowUp",u=>(u.ctrlKey?m(u.shiftKey):a(-1,0,u.shiftKey),!0)),l.addKeyAction("ArrowLeft",u=>(u.ctrlKey?g(u.shiftKey):a(0,-1,u.shiftKey),!0)),l.addKeyAction("ArrowDown",u=>(u.ctrlKey?I(u.shiftKey):a(1,0,u.shiftKey),!0)),l.addKeyAction("Home",u=>(g(u.shiftKey),!0)),l.addKeyAction("End",u=>(C(u.shiftKey),!0)),l.addKeyAction("PageUp",u=>(a(-Ro,0,u.shiftKey),!0)),l.addKeyAction("PageDown",u=>(a(Ro,0,u.shiftKey),!0)),l.addKeyAction("Enter",u=>(a(1,0,!1),!0)),l.addKeyAction("a",T),l.addKeyAction("A",T),l.addKeyAction("z",x),l.addKeyAction("Z",x),l.addKeyAction("y",L),l.addKeyAction("Y",L);function T(u){return u.ctrlKey?(t.selectAll(),u.preventDefault(),!1):!0}function x(u){return u.ctrlKey?(t.undo(),u.preventDefault(),!1):!0}function L(u){return u.ctrlKey?(t.redo(),u.preventDefault(),!1):!0}l.addKeyAction("F2",u=>(s(),!0)),l.addKeyAction("Delete",u=>{let p=t.getSelection();if(!p||c.getCanClearCellCount(p)===0)return!0;let R=new Ce(t,[p]);return t.commandManager.pushCommandBlock(new X("Clear cells",R)),t.clearCells(p),!0}),l.addKeyAction(" ",u=>{var R;let p=t.getSelection();if(!p)return!0;for(let _ of c.getSelectionGenerator(p))_.onCheckReadonly()||_.metaInfo.disabled||(_.renderType==="checkbox"||_.renderType==="radio")&&(t.getRow(_.row).isMounted?(R=_.element.querySelector("input"))==null||R.click():_.text=_.text==="true"?"false":"true");return!0}),t.addGlobalEventListener(r,"keydown",u=>{if(!(u.target instanceof HTMLElement&&u.target.closest(`.${ye}`))){if(!e.isIdle){u.preventDefault();return}if(!u.ctrlKey&&u.key.match(/^[\S]$/)){s(!0);return}l.startKeyAction(u)}})}get pluginKey(){return"default-key"}};function md(o){return new Te(o!=null?o:{})}var Qt=class extends P{_mountTask({grid:t,table:e}){let r=null;e.addEventListener("mousedown",n=>{if(n.button!==0)return;let i=K("td","tr",n.target);if(!i||(i==null?void 0:i.tagName)==="TH")return;let l=Z(i);r=t.cell(l.row,l.col),t.selectRow(r.row,r)}),t.addGlobalEventListener(document,"mouseup",()=>r=null)}get pluginKey(){return"row-selection"}};function Rd(){return new Qt}var er=-1,xi=/^\d+px$/;function yi(o){for(let t of o)if(typeof t=="string"){if(xi.test(t)===!1)throw new Error(`invalid column weight: ${t}`)}else if(typeof t=="number"){if(t<=0)throw new Error(`weight must be positive: ${t}`)}else throw new Error("weight type is allowed string or number")}function vi(o){let t=0;for(let e of o)typeof e=="string"&&(t+=wo(e));return t}function wo(o){return parseInt(o.substring(0,o.length-2),10)}var tr=class extends P{constructor({columnWeight:e}){super();this._columnWeightList=[];yi(e),this._fixedColumnWidth=vi(e),this._columnWeightList=e}_mountTask({grid:e,contextElement:r,emitController:n}){let i=er,l=()=>{let{clientWidth:d}=r;if(d===0){e.logger.warn("IRGrid.ColumnFillPlugin","clientWidth is 0, it's probably set to 'display: none'");return}let a=e.getColCount()-1,h=d-a-this._fixedColumnWidth,m=O(e.getColCount()).reduce((I,w)=>{if(!e.getColumnVisible(w))return I;let T=this._columnWeightList[w];return T===void 0?I+1:typeof T=="number"?I+T:I},0),g=0;O(a).forEach(I=>{var T;if(!e.getColumnVisible(I))return;let w=(T=this._columnWeightList[I])!=null?T:1;if(typeof w=="string"&&w.endsWith("px")){let x=wo(w);e.setColumnWidth(I,x)}else if(typeof w=="number"){let x=w/m;e.setColumnWidth(I,Math.floor(x*h))}g+=e.getColumnWidth(I)});let C=c();C&&e.setColumnWidth(C,h-g+this._fixedColumnWidth)},s=()=>{i!==er&&cancelAnimationFrame(i),i=requestAnimationFrame(()=>{try{n.lockEmit("onColumnChanged"),l()}catch(d){console.error(d)}finally{n.unlockEmit("onColumnChanged"),i=er}})};n.emitter.on("onWrapperResized",()=>{s()}),n.emitter.on("onColumnChanged",({left:d,right:a,type:h})=>{s()}),s();function c(){for(let d=e.getColCount()-1;d>=0;d--)if(e.getColumnVisible(d))return d;return null}}get pluginKey(){return"column-fill"}};function xd(o){return new tr(o!=null?o:{columnWeight:[]})}var rr=class extends P{constructor({onCellInfoChanged:t}){super(),this._onCellInfoChanged=t}_mountTask({emitController:t}){this.turnOn=()=>{t.emitter.on("onCellInfoChanged",this._onCellInfoChanged)},this.turnOn=()=>{t.emitter.off("onCellInfoChanged",this._onCellInfoChanged)}}turnOn(){console.error("Must execute mount() first")}turnOff(){console.error("Must execute mount() first")}get pluginKey(){return"cell-observer"}};function Sd(o){return new rr(o)}var Le=class extends P{constructor(){super()}_mountTask({grid:t,gridContext:e,table:r}){let n={latestDragOverCell:null},i=()=>{e.setIdle(),r.classList.remove("is-dragging"),l()},l=()=>{n.latestDragOverCell&&(n.latestDragOverCell.isDragOver=!1)},s=d=>{l(),n.latestDragOverCell=d,d.isDragOver=!0},c=()=>r.classList.contains("is-dragging");r.addEventListener("mouseup",()=>c()&&i()),r.addEventListener("dragenter",()=>{e.setMode({mode:"dragging",contextParam:{}}),r.classList.add("is-dragging")}),r.addEventListener("dragover",d=>{if(!d.dataTransfer||!r.classList.contains("is-dragging"))return;let a=t.findCellOrNull(d.offsetY,d.offsetX);if(!a||d.dataTransfer.types.includes("ir-grid/disabled-cell-drop"))return null;if(a.dropDisabled!==!1&&(a.metaInfo.disabled===!0||a.onCheckReadonly()===!0||a.dropDisabled===!0))return l(),null;t.onDragOverCell(a,d)===!0&&(a!==n.latestDragOverCell&&s(a),d.preventDefault())}),r.addEventListener("dragleave",d=>{d.target===r?i():l()}),r.addEventListener("drop",d=>{try{n.latestDragOverCell&&t.onDropOnCell(n.latestDragOverCell.row,n.latestDragOverCell.col,d)}finally{i()}})}get pluginKey(){return"cell-drop"}};function Ld(){return new Le}var bo=10,nr=class extends P{_mountTask({grid:t,table:e}){let r={cell:null},n=()=>{r.cell=null,e.draggable=!1},i=l=>{e.draggable=!0,r.cell=l};e.addEventListener("mousedown",l=>{if(l.button!==0)return;let s=K("td","tr",l.target);if(!s){n();return}let c=Z(s),d=t.cell(c.row,c.col);t.selectCell(c.row,c.col),d.metaInfo.draggable===!0&&d.metaInfo.object?i(d):n()}),e.addEventListener("dragend",()=>n()),e.addEventListener("dragstart",l=>{if(!l.dataTransfer||!r.cell||!t.onDragStartCell(r.cell,l)){l.preventDefault();return}l.dataTransfer.setDragImage(r.cell.element,bo,bo)})}get pluginKey(){return"single-cell-drag"}};function zd(){return new nr}var _o=10,Io=class extends P{constructor(e={}){super();this.args=e}_mountTask({grid:e,table:r,gridContext:n,contextElement:i,gridStore:l}){let{enabledRow:s=!0,enabledColumn:c=!0}=this.args,{mergeHandler:d,rowManager:a}=l,h=null,m=null;r.addEventListener("mousedown",g),r.addEventListener("dragstart",C),r.addEventListener("dragover",I),r.addEventListener("drop",w),r.addEventListener("dragleave",T),r.addEventListener("dragend",x),r.addEventListener("mouseup",x),this._mountRollbackStack.push(()=>{r.removeEventListener("mousedown",g),r.removeEventListener("dragstart",C),r.removeEventListener("dragover",I),r.removeEventListener("drop",w),r.removeEventListener("dragleave",T),r.removeEventListener("dragend",x),r.removeEventListener("mouseup",x)});function g(R){if(R.button!==0||i.classList.contains("is-resizing"))return;let _=K("th","tr",R.target);if(!_)return;let G=Z(_),f=e.cell(G.row,G.col);if(f.cellType==="body-cell"||E(f))return;L({direction:f.cellType,source:b(),cell:f});function b(){let{row:v,col:M}=f;return f.cellType==="row-header"?[a.getStartOfRowId(v),a.getEndOfRowId(v)]:[a.getStartOfColumnId(M),a.getEndOfColumnId(M)]}function y(v){return!s||v.row<e.getFreezedRowCount()}function S(v){return!c||v.col<e.getFreezedColumnCount()}function E(v){return v.cellType==="row-header"&&y(v)||v.cellType==="col-header"&&S(v)}}function C(R){if(!R.dataTransfer||!h){R.preventDefault();return}n.setMode({mode:"dragging",contextParam:{}}),r.classList.add("is-dragging"),R.dataTransfer.effectAllowed="move",R.dataTransfer.setData("ir-grid/disabled-cell-drop",""),R.dataTransfer.setData("ir-grid/exchange-by-header-dragging",""),R.dataTransfer.setDragImage(h.cell.element,_o,_o)}function I(R){if(!h||!R.dataTransfer||!R.dataTransfer.types.includes("ir-grid/exchange-by-header-dragging"))return;let _=e.findCellOrNull(R.offsetY,R.offsetX);if(!_||!_.isHeaderCell||h.direction==="row-header"&&G(_,h)||h.direction==="col-header"&&f(_,h)){u(),m=_;return}_!==m&&p(_,h.direction),R.preventDefault();function G(b,y){return b.row===y.cell.row||b.row<e.getFreezedRowCount()||d.checkConflictingInRows(b.row,b.row)}function f(b,y){return b.col===y.cell.col||b.col<e.getFreezedColumnCount()||d.checkConflictingInColumns(b.col,b.col)}}function w(){let R=h,_=m;!R||!_||(u(),R.direction==="row-header"&&(e.commandManager.doRecording("Exchange Rows",()=>{e.exchangeRows(R.source,[_.row,_.row])}),e.forceLayoutTask(),e.selectRow(R.cell.row)),R.direction==="col-header"&&(e.commandManager.doRecording("Exchange Columns",()=>{e.exchangeColumns(R.source,[_.col,_.col])}),e.forceLayoutTask(),e.selectColumn(R.cell.col)))}function T(){u(),m=null}function x(){r.classList.remove("is-dragging"),u(),h=null,r.draggable=!1,m=null,n.setIdle()}function L({direction:R,source:_,cell:G}){r.draggable=!0,h={direction:R,source:_,cell:G}}function u(){if(!m||!h)return;let{direction:R}=h,_=R==="row-header"?e.headerColumns:e.headerRows;for(let G=0;G<_;G++)R==="row-header"?e.cell(m.row,G).element.classList.remove("is-dragging"):e.cell(G,m.col).element.classList.remove("is-dragging")}function p(R,_){u(),m=R;let G=_==="row-header"?e.headerColumns:e.headerRows;for(let f=0;f<G;f++)_==="row-header"?e.cell(R.row,f).element.classList.add("is-dragging"):e.cell(f,R.col).element.classList.add("is-dragging")}}get pluginKey(){return"exchange-by-header-cell"}};var yo=8,Ei={normal:gn,error:hn},xo=(o,t,e,r)=>{o.isConnected===!1||o.offsetParent===null||Sn(o,t,{placement:e,strategy:"fixed",middleware:[yn({mainAxis:yo,crossAxis:r!=null?r:0}),En(),vn({padding:5})]}).then(({x:n,y:i,placement:l})=>{t.style.left=`${n}px`,t.style.top=`${i}px`,t.dataset.placement=l})},Si=o=>{var t,e;return(e=(t=o.cellInfo.tooltip)!=null?t:o.cellInfo.text)!=null?e:""},Mi=o=>{var t;return(t=o.cellInfo.memo)!=null?t:""},at=class extends P{constructor(e){super();this.options=e;this.context=null;this._tooltipElement=document.createElement("div"),this._memoElement=document.createElement("div"),this._tooltipElement.className=hr}hideMemo(){this._memoElement.remove()}hideTooltip(){this._tooltipElement.remove()}createContext(e){var I,w,T,x,L,u;let{memoInterval:r,tooltipInterval:n,hideTooltipWhenHasMemo:i}=this.options,{hasMemo:l,memoIntent:s="normal",tooltipDisabled:c=!1}=e.cellInfo,d=(T=(w=(I=this.options).getTooltipText)==null?void 0:w.call(I,e))!=null?T:Si(e),a=(u=(L=(x=this.options).getMemoText)==null?void 0:L.call(x,e))!=null?u:Mi(e),h=()=>{this._tooltipElement.textContent=d,xe("popover").appendChild(this._tooltipElement),xo(e.element,this._tooltipElement,"bottom")},m=()=>{this._memoElement.textContent=a!=null?a:"",this._memoElement.className=`${mn} ${Ei[s]}`,xe("popover").appendChild(this._memoElement),xo(e.element,this._memoElement,"right-start",yo)},g=!(l&&i)&&c===!1&&d?window.setTimeout(()=>h(),n):-1,C=l&&a?window.setTimeout(()=>m(),r):-1;return{targetCell:e,tooltipTimeoutHandler:g,memoTimeoutHandler:C,cleanup:()=>{clearTimeout(g),clearTimeout(C),this.hideTooltip(),this.hideMemo(),this.context=null}}}_mountTask({grid:e,gridContext:r,contextElement:n}){let i=l=>{var a,h,m;if(!te(l.target))return;let s=K("td,th","tr",l.target);if(!s){(a=this.context)==null||a.cleanup();return}let c=Z(s),d=e.cell(c.row,c.col);((h=this.context)==null?void 0:h.targetCell)!==d&&((m=this.context)==null||m.cleanup(),this.context=this.createContext(d))};e.addGlobalEventListener(n,"mouseleave",()=>{var l;return(l=this.context)==null?void 0:l.cleanup()}),r.gridModeState.addSubscription((l,{mode:s})=>{var c;n.removeEventListener("mousemove",i),(c=this.context)==null||c.cleanup(),(s==="idle"||s==="edit-cell")&&e.addGlobalEventListener(n,"mousemove",i)}),e.addGlobalEventListener(n,"scroll",()=>{var l;return(l=this.context)==null?void 0:l.cleanup()})}get pluginKey(){return"popover"}};var vo=10,Eo=class extends P{_mountTask({grid:t,table:e,gridContext:r,contextElement:n,wrapperElement:i,gridStore:l}){let{rowManager:s}=l,c=document.createElement("div");c.className=bn;let d=null,a=-1;e.addEventListener("mousedown",h),e.addEventListener("dragstart",m),e.addEventListener("dragover",g),e.addEventListener("drop",C),e.addEventListener("dragleave",I),e.addEventListener("dragend",w),e.addEventListener("mouseup",w),this._mountRollbackStack.push(()=>{e.removeEventListener("mousedown",h),e.removeEventListener("dragstart",m),e.removeEventListener("dragover",g),e.removeEventListener("drop",C),e.removeEventListener("dragleave",I),e.removeEventListener("dragend",w),e.removeEventListener("mouseup",w)});function h(u){if(u.button!==0||n.classList.contains("is-resizing"))return;let p=K("th","tr",u.target);if(!p)return;let R=Z(p),_=t.cell(R.row,R.col);if(G(_))return;T({source:[s.getStartOfRowId(_.row),s.getEndOfRowId(_.row)],cell:_});function G(f){return f.cellType!=="row-header"||f.row<t.getFreezedRowCount()||f.row<t.headerRows}}function m(u){let{offsetY:p,offsetX:R}=u,_=t.findCellOrNull(p,R);if((_==null?void 0:_.cellType)==="row-header"){if(!u.dataTransfer||!d){u.preventDefault();return}r.setMode({mode:"dragging",contextParam:{}}),e.classList.add("is-dragging"),u.dataTransfer.effectAllowed="move",u.dataTransfer.setData("ir-grid/disabled-cell-drop",""),u.dataTransfer.setData("ir-grid/move-rows-dragging",""),u.dataTransfer.setDragImage(d.cell.element,vo,vo)}}function g(u){let{dataTransfer:p,offsetY:R,offsetX:_}=u;if(!d||!p||!p.types.includes("ir-grid/move-rows-dragging"))return;let G=t.findCellOrNull(R,_);if(!G)return;let f=b(G.row);if(G.cellType!=="row-header"||y(f,d)){x(),a=-1;return}f!==a&&L(f),u.preventDefault();function b(S){let E=t.getRow(S),v=R-E.top<E.height/2;return E.rowId+(v?0:1)}function y(S,E){let[v,M]=E.source;return S>=v&&S<=M||S<t.headerRows}}function C(){let u=d,p=a;!u||p<0||(x(),t.commandManager.doRecording("Move Rows",()=>{t.moveRows(u.source,p)}),t.forceLayoutTask(),t.selectRow(u.cell.row))}function I(){x(),a=-1}function w(){e.classList.remove("is-dragging"),x(),d=null,e.draggable=!1,a=-1,r.setIdle()}function T({source:u,cell:p}){e.draggable=!0,d={source:u,cell:p}}function x(){a<0||!d||c.remove()}function L(u){x(),a=u;let p=Math.min(a,s.length-1),R=t.getRow(p),_={top:R.top,height:16},G=_.height/2;u===s.length&&(_.top+=R.height,_.height=G+1),c.style.top=`${_.top-G}px`,c.style.width=`${t.headerWidth}px`,c.style.height=`${_.height}px`,i.append(c)}}get pluginKey(){return"move-row"}};var So=10,Mo=class extends P{_mountTask({grid:t,table:e,gridContext:r,contextElement:n,wrapperElement:i,gridStore:l}){let{rowManager:s,columnManager:c}=l,d=document.createElement("div");d.className=wn;let a=null,h=-1;e.addEventListener("mousedown",m),e.addEventListener("dragstart",g),e.addEventListener("dragover",C),e.addEventListener("drop",I),e.addEventListener("dragleave",w),e.addEventListener("dragend",T),e.addEventListener("mouseup",T),this._mountRollbackStack.push(()=>{e.removeEventListener("mousedown",m),e.removeEventListener("dragstart",g),e.removeEventListener("dragover",C),e.removeEventListener("drop",I),e.removeEventListener("dragleave",w),e.removeEventListener("dragend",T),e.removeEventListener("mouseup",T)});function m(p){if(p.button!==0||n.classList.contains("is-resizing"))return;let R=K("th","tr",p.target);if(!R)return;let _=Z(R),G=t.cell(_.row,_.col);if(f(G))return;x({source:[s.getStartOfColumnId(G.col),s.getEndOfColumnId(G.col)],cell:G});function f(b){return b.cellType!=="col-header"||b.col<t.getFreezedColumnCount()||b.col<t.headerColumns}}function g(p){let{offsetY:R,offsetX:_}=p,G=t.findCellOrNull(R,_);if((G==null?void 0:G.cellType)==="col-header"){if(!p.dataTransfer||!a){p.preventDefault();return}r.setMode({mode:"dragging",contextParam:{}}),e.classList.add("is-dragging"),p.dataTransfer.effectAllowed="move",p.dataTransfer.setData("ir-grid/disabled-cell-drop",""),p.dataTransfer.setData("ir-grid/move-columns-dragging",""),p.dataTransfer.setDragImage(a.cell.element,So,So)}}function C(p){let{dataTransfer:R,offsetY:_,offsetX:G}=p;if(!a||!R||!R.types.includes("ir-grid/move-columns-dragging"))return;let f=t.findCellOrNull(_,G);if(!f)return;let b=y(f.col);if(f.cellType!=="col-header"||S(b,a)){L(),h=-1;return}b!==h&&u(b),p.preventDefault();function y(E){let v=t.getColumn(E),M=G-v.left<v.width/2;return v.columnId+(M?0:1)}function S(E,v){let[M,k]=v.source;return E>=M&&E<=k||E<t.headerColumns}}function I(){let p=a,R=h;!p||R<0||(L(),t.commandManager.doRecording("Move Columns",()=>{t.moveColumns(p.source,R)}),t.forceLayoutTask(),t.selectColumn(p.cell.col))}function w(){L(),h=-1}function T(){e.classList.remove("is-dragging"),L(),a=null,e.draggable=!1,h=-1,r.setIdle()}function x({source:p,cell:R}){e.draggable=!0,a={source:p,cell:R}}function L(){h<0||!a||d.remove()}function u(p){L(),h=p;let R=Math.min(h,c.length-1),_=t.getColumn(R),G={left:_.left,width:12},f=G.width/2;p===c.length&&(G.left+=_.width,G.width=f+1),d.style.left=`${G.left-f}px`,d.style.height=`${t.headerHeight}px`,d.style.width=`${G.width}px`,i.append(d)}}get pluginKey(){return"move-column"}};var dt=class{constructor(t){this._cell=t}createTextAreaWrapper(t=!1){var c;let e=document.createElement("div"),r=document.createElement("textarea"),n=(c=this._cell.metaInfo.text)!=null?c:"";r.className=ye,r.value=n,this._cell.metaInfo.maxLength?r.maxLength=this._cell.metaInfo.maxLength:r.maxLength=1e4,t&&(r.value="");let i=(d,a,h)=>{if(r.removeEventListener("blur",l),e.remove(),a&&this._cell.checkInputValidation(d)){let m=new q(this._cell.metaInfo.commandManager,[this._cell.row,this._cell.col,{text:d}]);m.onUndo=()=>{this.onEditDone(this._cell,a,n,h,r.selectionStart,r.selectionEnd)},m.onExecute=()=>{this.onEditDone(this._cell,a,n,h,r.selectionStart,r.selectionEnd)},this._cell.metaInfo.commandManager.commandManager.pushCommandBlock(new X(`Edit cell (${this._cell.row}, ${this._cell.col}) `,m)),this._cell.cellInfo={text:d}}this._cell.render(),this._cell.setLastSelection(r.selectionStart,r.selectionEnd),this.onEditDone(this._cell,a,n,h,r.selectionStart,r.selectionEnd)},l=d=>{i(r.value,n!==r.value,"")},s=d=>d.key==="ArrowLeft"&&r.selectionStart===0&&r.selectionEnd===0?(this.onMoveLeftOnEdit(d.ctrlKey,d.shiftKey),!0):d.key==="ArrowUp"&&r.selectionStart===0&&r.selectionEnd===0?(this.onMoveUpOnEdit(d.ctrlKey,d.shiftKey),!0):d.key==="ArrowRight"&&r.selectionStart===r.textLength&&r.selectionEnd===r.textLength?(this.onMoveRightOnEdit(d.ctrlKey,d.shiftKey),!0):d.key==="ArrowDown"&&r.selectionStart===r.textLength&&r.selectionEnd===r.textLength?(this.onMoveDownOnEdit(d.ctrlKey,d.shiftKey),!0):d.key==="Tab"?(this.onTabOnEdit(d.ctrlKey,d.shiftKey),d.preventDefault(),!0):!1;return r.onkeydown=d=>{if(s(d)){i(r.value,n!==r.value,d.key),d.preventDefault();return}if(d.key==="Escape")i(r.value,!1,d.key);else if(d.key==="Enter"){if(!d.altKey){d.preventDefault(),i(r.value,n!==r.value,d.key),this.onEnterOnEdit(d.ctrlKey,d.shiftKey);return}r.readOnly=!0;let a=r.value.substring(0,r.selectionStart);r.value=[r.value.substring(0,r.selectionStart),`
`,r.value.substring(r.selectionEnd)].join(""),r.readOnly=!1,r.selectionEnd=a.length+1}else this.onEditKeyDown(d,this._cell.row,this._cell.col,this._cell.metaInfo)},r.addEventListener("blur",l),e.appendChild(r),{textareaWrapper:e,textarea:r}}runEditMode(t=!1){let{textareaWrapper:e,textarea:r}=this.createTextAreaWrapper(t);this._cell.replaceElement(e),r.focus()}onMoveLeftOnEdit(t,e){}onMoveRightOnEdit(t,e){}onMoveUpOnEdit(t,e){}onMoveDownOnEdit(t,e){}onTabOnEdit(t,e){}onEnterOnEdit(t,e){}onEdit(){}onError(){}onEditDone(t,e,r,n,i,l){}onEditKeyDown(t,e,r,n){}};var oe=new WeakMap,se=new WeakMap,ne=new WeakMap;var mt=Symbol("anyProducer"),Go=Promise.resolve(),ht=Symbol("listenerAdded"),gt=Symbol("listenerRemoved"),ft=!1,or=!1,pt=o=>typeof o=="string"||typeof o=="symbol"||typeof o=="number";function Re(o){if(!pt(o))throw new TypeError("`eventName` must be a string, symbol, or number")}function ct(o){if(typeof o!="function")throw new TypeError("listener must be a function")}function we(o,t){let e=se.get(o);if(e.has(t))return e.get(t)}function ke(o,t){let e=pt(t)?t:mt,r=ne.get(o);if(r.has(e))return r.get(e)}function Gi(o,t,e){let r=ne.get(o);if(r.has(t))for(let n of r.get(t))n.enqueue(e);if(r.has(mt)){let n=Promise.all([t,e]);for(let i of r.get(mt))i.enqueue(n)}}function To(o,t){t=Array.isArray(t)?t:[t];let e=!1,r=()=>{},n=[],i={enqueue(l){n.push(l),r()},finish(){e=!0,r()}};for(let l of t){let s=ke(o,l);s||(s=new Set,ne.get(o).set(l,s)),s.add(i)}return{async next(){return n?n.length===0?e?(n=void 0,this.next()):(await new Promise(l=>{r=l}),this.next()):{done:!1,value:await n.shift()}:{done:!0}},async return(l){n=void 0;for(let s of t){let c=ke(o,s);c&&(c.delete(i),c.size===0&&ne.get(o).delete(s))}return r(),arguments.length>0?{done:!0,value:await l}:{done:!0}},[Symbol.asyncIterator](){return this}}}function Lo(o){if(o===void 0)return ko;if(!Array.isArray(o))throw new TypeError("`methodNames` must be an array of strings");for(let t of o)if(!ko.includes(t))throw typeof t!="string"?new TypeError("`methodNames` element must be a string"):new Error(`${t} is not Emittery method`);return o}var be=o=>o===ht||o===gt;function ut(o,t,e){if(be(t))try{ft=!0,o.emit(t,e)}finally{ft=!1}}var ae=class o{static mixin(t,e){return e=Lo(e),r=>{if(typeof r!="function")throw new TypeError("`target` must be function");for(let l of e)if(r.prototype[l]!==void 0)throw new Error(`The property \`${l}\` already exists on \`target\``);function n(){return Object.defineProperty(this,t,{enumerable:!1,value:new o}),this[t]}Object.defineProperty(r.prototype,t,{enumerable:!1,get:n});let i=l=>function(...s){return this[t][l](...s)};for(let l of e)Object.defineProperty(r.prototype,l,{enumerable:!1,value:i(l)});return r}}static get isDebugEnabled(){var e,r;if(typeof((e=globalThis.process)==null?void 0:e.env)!="object")return or;let{env:t}=(r=globalThis.process)!=null?r:{env:{}};return t.DEBUG==="emittery"||t.DEBUG==="*"||or}static set isDebugEnabled(t){or=t}constructor(t={}){var e;oe.set(this,new Set),se.set(this,new Map),ne.set(this,new Map),ne.get(this).set(mt,new Set),this.debug=(e=t.debug)!=null?e:{},this.debug.enabled===void 0&&(this.debug.enabled=!1),this.debug.logger||(this.debug.logger=(r,n,i,l)=>{try{l=JSON.stringify(l)}catch{l=`Object with the following keys failed to stringify: ${Object.keys(l).join(",")}`}(typeof i=="symbol"||typeof i=="number")&&(i=i.toString());let s=new Date,c=`${s.getHours()}:${s.getMinutes()}:${s.getSeconds()}.${s.getMilliseconds()}`;console.log(`[${c}][emittery:${r}][${n}] Event Name: ${i}
	data: ${l}`)})}logIfDebugEnabled(t,e,r){(o.isDebugEnabled||this.debug.enabled)&&this.debug.logger(t,this.debug.name,e,r)}on(t,e){ct(e),t=Array.isArray(t)?t:[t];for(let r of t){Re(r);let n=we(this,r);n||(n=new Set,se.get(this).set(r,n)),n.add(e),this.logIfDebugEnabled("subscribe",r,void 0),be(r)||ut(this,ht,{eventName:r,listener:e})}return this.off.bind(this,t,e)}off(t,e){ct(e),t=Array.isArray(t)?t:[t];for(let r of t){Re(r);let n=we(this,r);n&&(n.delete(e),n.size===0&&se.get(this).delete(r)),this.logIfDebugEnabled("unsubscribe",r,void 0),be(r)||ut(this,gt,{eventName:r,listener:e})}}once(t){let e,r=new Promise(n=>{e=this.on(t,i=>{e(),n(i)})});return r.off=e,r}events(t){t=Array.isArray(t)?t:[t];for(let e of t)Re(e);return To(this,t)}async emit(t,e){var s;if(Re(t),be(t)&&!ft)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emit",t,e),Gi(this,t,e);let r=(s=we(this,t))!=null?s:new Set,n=oe.get(this),i=[...r],l=be(t)?[]:[...n];await Go,await Promise.all([...i.map(async c=>{if(r.has(c))return c(e)}),...l.map(async c=>{if(n.has(c))return c(t,e)})])}async emitSerial(t,e){var s;if(Re(t),be(t)&&!ft)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emitSerial",t,e);let r=(s=we(this,t))!=null?s:new Set,n=oe.get(this),i=[...r],l=[...n];await Go;for(let c of i)r.has(c)&&await c(e);for(let c of l)n.has(c)&&await c(t,e)}onAny(t){return ct(t),this.logIfDebugEnabled("subscribeAny",void 0,void 0),oe.get(this).add(t),ut(this,ht,{listener:t}),this.offAny.bind(this,t)}anyEvent(){return To(this)}offAny(t){ct(t),this.logIfDebugEnabled("unsubscribeAny",void 0,void 0),ut(this,gt,{listener:t}),oe.get(this).delete(t)}clearListeners(t){t=Array.isArray(t)?t:[t];for(let e of t)if(this.logIfDebugEnabled("clear",e,void 0),pt(e)){let r=we(this,e);r&&r.clear();let n=ke(this,e);if(n){for(let i of n)i.finish();n.clear()}}else{oe.get(this).clear();for(let[r,n]of se.get(this).entries())n.clear(),se.get(this).delete(r);for(let[r,n]of ne.get(this).entries()){for(let i of n)i.finish();n.clear(),ne.get(this).delete(r)}}}listenerCount(t){var r,n,i,l,s,c;t=Array.isArray(t)?t:[t];let e=0;for(let d of t){if(pt(d)){e+=oe.get(this).size+((n=(r=we(this,d))==null?void 0:r.size)!=null?n:0)+((l=(i=ke(this,d))==null?void 0:i.size)!=null?l:0)+((c=(s=ke(this))==null?void 0:s.size)!=null?c:0);continue}d!==void 0&&Re(d),e+=oe.get(this).size;for(let a of se.get(this).values())e+=a.size;for(let a of ne.get(this).values())e+=a.size}return e}bindMethods(t,e){if(typeof t!="object"||t===null)throw new TypeError("`target` must be an object");e=Lo(e);for(let r of e){if(t[r]!==void 0)throw new Error(`The property \`${r}\` already exists on \`target\``);Object.defineProperty(t,r,{enumerable:!1,value:this[r].bind(this)})}}},ko=Object.getOwnPropertyNames(ae.prototype).filter(o=>o!=="constructor");Object.defineProperty(ae,"listenerAdded",{value:ht,writable:!1,enumerable:!0,configurable:!1});Object.defineProperty(ae,"listenerRemoved",{value:gt,writable:!1,enumerable:!0,configurable:!1});var Ho=o=>{let t=new ae({debug:{name:o.uuid}}),e=new Set;return t.on("updateCellStatus",r=>o.cell(r.row,r.col).updateCellStatus()),{get emitter(){return t},emit(...r){e.has(r[0])||t.emit(...r)},lockEmit(r){e.add(r)},unlockEmit(r){e.delete(r)}}};function Ao(o,t){let e={text:"",ignoreCase:!0,matchAll:!1,area:"all",direction:"top-bottom"},r=!1,n=0,i=0,l={setRow(m){n=m},setCol(m){i=m}},s=()=>e.hasHeaderRows?0:o.headerRows,c=()=>e.hasHeaderColumns?0:o.headerColumns;function*d(){l.setRow(s()),l.setCol(c());let m=o.getSelection();for(r=!1;;){switch(e.area){case"all":yield o.cell(n,i);break;case"selected-col":if(!m)throw new Error("No selection in finding");jt(i,m)&&(yield o.cell(n,i));break;case"selected-row":if(!m)throw new Error("No selection in finding");Pt(n,m)&&(yield o.cell(n,i));break;case"selection":if(!m)throw new Error("No selection in finding");Wt(n,i,m)&&(yield o.cell(n,i));break;case"custom":if(!e.customRange)throw new Error("Please call with customRange in 'custom' finding.");Wt(n,i,e.customRange)&&(yield o.cell(n,i));break;default:break}if(e.direction==="top-bottom"){if(++n,n>=o.getRowCount()&&(++i,n=s()),i>=o.getColCount())if(r)r=!1,n=s(),i=c();else break}else if(++i,i>=o.getColCount()&&(++n,i=c()),n>=o.getRowCount())if(r)r=!1,n=s(),i=c();else break}}function a(m){let g=e.text.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),C=e.matchAll?`^${g}$`:g,I=e.ignoreCase?"i":"",w=new RegExp(C,I);return t.onCellCheck?t.onCellCheck(w,m):w.test(m.text)}let h=d();return{resetCursor(){h=d()},findNext(m){for(Fe(e,m)||(h=d()),Object.assign(e,m);;){let g=h.next();if(!g.done&&a(g.value))return r=!0,g.value;if(g.done)break}return null},getAllMatchedCell(m){let g=[];m&&Object.assign(e,m);for(let C of d())a(C)&&g.push(C);return g},setCursor(m,g){if(m<0||g<0)throw new Error("row or col must be greater than or equal to 0");l.setRow(m),l.setCol(g)}}}var Ti=4,Ct="is-hidden";function Li(o,t){return o.top>t.bottom||t.top>o.bottom||o.left>t.right||t.left>o.right?null:{top:Math.max(o.top,t.top),left:Math.max(o.left,t.left),bottom:Math.min(o.bottom,t.bottom),right:Math.min(o.right,t.right)}}var ki=Yr,Hi=[Ur,Xr,Kr,Zr],Ai=["top","left","bottom","right"];function Oi(o){let t=document.createElement("div"),e=[document.createElement("div"),document.createElement("div"),document.createElement("div"),document.createElement("div")],r=[document.createElement("div"),document.createElement("div"),document.createElement("div"),document.createElement("div")],[n,i,l,s]=r,c=[n,l],d=[i,s];t.classList.add(Nr,Ct),r.forEach((x,L)=>x.className=`${$r} border-line__${Ai[L]}`),e.forEach(x=>t.appendChild(x)),r.forEach(x=>t.appendChild(x));function a(x){let{top:L,left:u,bottom:p,right:R}=g(x),_=x.top<o.getFreezedRowCount()?o.scrollTop:0,G=x.left<o.getFreezedColumnCount()?o.scrollLeft:0;return{top:L+_,left:u+G,width:R-u,height:p-L}}function h(x){x.classList.add(Ct),delete x.dataset.y,delete x.dataset.x,delete x.dataset.width,delete x.dataset.height,delete x.dataset.visible}function m(x,L){let u=e[x],p=a(L);u.className=`${ki} ${Hi[x]}`,u.dataset.top=L.top.toString(),u.dataset.left=L.left.toString(),u.dataset.bottom=L.bottom.toString(),u.dataset.right=L.right.toString(),u.dataset.y=p.top.toString(),u.dataset.x=p.left.toString(),u.dataset.width=p.width.toString(),u.dataset.height=p.height.toString(),u.dataset.visible="true",u.style.top=`${p.top}px`,u.style.left=`${p.left}px`,u.style.width=`${p.width}px`,u.style.height=`${p.height}px`}function g(x){return{top:o.getRow(x.top).top-1,left:o.getColumn(x.left).left-1,bottom:o.getRow(x.bottom).bottom,right:o.getColumn(x.right).right}}function C(x){let{left:L,right:u}=x,p=o.getFreezedColumnCount();return O(L,u+1).reduce((R,_)=>{let G=o.getColumn(_);return G.visible?R+(_>=p?G.widthWithBorder:0):R},0)}function I(x){let{top:L,bottom:u}=x,p=o.getFreezedRowCount();return O(L,u+1).reduce((R,_)=>{let G=o.getRow(_);return G.visible?R+(_>=p?G.heightWithBorder:0):R},0)}function w(x,L,u,p){if(x<=p)return Math.min(L,u);let R=x-p;return u>R?Math.max(0,u-R):0}function T(x){let{top:L,left:u,bottom:p,right:R}=g(x),{fixedRowHeight:_,fixedColumnWidth:G,scrollTop:f,scrollLeft:b}=o,y=_+f,S=G+b,E=L<_,v=p<=_,M=u<G,k=R<=G,A=L>=y,H=p>=y,de=u>=S,N=R>=S,j=C(x),z=I(x),ir=w(u,j,b,G),lr=w(L,z,f,_),Ht=R-u-ir,At=p-L-lr,sr=L+(E?f:lr),ar=u+(M?b:ir),He=ar<0?1:0,Ae=sr<0?1:0;(function(){c.forEach(Ie=>{Ie.style.left=`${ar+He}px`,Ie.style.width=`${Ht-He}px`})})(),function(){d.forEach(Ie=>{Ie.style.top=`${sr+Ae}px`,Ie.style.height=`${At-Ae}px`})}(),function(){if(Ht<=1){n.style.display="none";return}n.style.removeProperty("display"),E?n.style.top=`${L+f+Ae}px`:A?n.style.top=`${L+Ae}px`:n.style.display="none"}(),function(){if(Ht<=1){l.style.display="none";return}l.style.removeProperty("display"),v?l.style.top=`${p+f-1}px`:H?l.style.top=`${p-1}px`:l.style.display="none"}(),function(){if(At<=1){i.style.display="none";return}i.style.removeProperty("display"),M?i.style.left=`${u+b+He}px`:de?i.style.left=`${u+He}px`:i.style.display="none"}(),function(){if(At<=1){s.style.display="none";return}s.style.removeProperty("display"),k?s.style.left=`${R+b-1}px`:N?s.style.left=`${R-1}px`:s.style.display="none"}()}return{get selectionRoot(){return t},updateArea(x){let L=o.headerRows,u=o.getFreezedRowCount(),p=o.headerColumns,R=o.getFreezedColumnCount(),_=o.getRowCount()-1,G=o.getColCount()-1,b=[{top:L,left:p,bottom:u-1,right:R-1},{top:L,left:R,bottom:u-1,right:G},{top:u,left:p,bottom:_,right:R-1},{top:u,left:R,bottom:_,right:G}].map(y=>Li(x,y));for(let y=0;y<Ti;y++){let S=b[y];S?m(y,S):h(e[y])}T(x)},applyGridScroll(){let x=o.getSelection();x&&this.updateArea(x)},show(){t.classList.remove(Ct)},hide(){t.classList.add(Ct)}}}var Rt=class{constructor(t,e,r){this._activatedHeaderCellList=[];this._gridContext=e,this._selectionHandler=Oi(t),r.appendChild(this._selectionHandler.selectionRoot)}updateScroll(){this._selectionHandler.applyGridScroll()}releaseRange(){this._selectionHandler.hide()}update(){let t=this._gridContext.selectionRangeState.value;if(!t){this.releaseRange();return}let{range:e}=t;this._selectionHandler.show(),this._selectionHandler.updateArea(e)}};var wt=class extends D{_execute(){return this._instance.addColumn(...this._args)}_getUndoContext(){return{addedColumn:this._instance.getColCount(),selection:this._instance.getSelection(),activeCell:this._instance.activeCell}}_undo(){this._instance.removeColumn(this._undoContext.addedColumn),this._undoContext.selection&&this._instance.select(this._undoContext.selection,this._undoContext.activeCell)}get canExecute(){return!0}get canUndo(){return this._undoContext?this._instance.getColCount()>this._undoContext.addedColumn:!1}};var bt=class extends D{_execute(){return this._instance.addRow(...this._args)}_undo(){this._instance.removeRow(this._undoContext.addedRow),this._undoContext.selection&&this._instance.select(this._undoContext.selection,this._undoContext.activeCell)}_getUndoContext(){return{addedRow:this._instance.getRowCount(),selection:this._instance.getSelection(),activeCell:this._instance.activeCell}}get canExecute(){return!0}get canUndo(){return this._undoContext?this._instance.getRowCount()>this._undoContext.addedRow:!1}};var _t=class extends D{_undo(){this._instance.setColumnVisible(this._args[0],this._undoContext.visible)}_getUndoContext(){return{visible:this._instance.getColumnVisible(this._args[0])}}_execute(){return this._instance.setColumnVisible(...this._args)}get canUndo(){return!0}get canExecute(){return!0}};function Oo(o,t){let[e,r]=o,[n,i]=t,l=r-e,s=i-n;return l===s?[t,o]:e<n?[[i-l,i],[e,e+s]]:[[n,n+l],[r-s,r]]}var It=class extends D{_execute(){this._instance.exchangeRows(this._args[0],this._args[1])}_undo(){this._instance.exchangeRows(...Oo(...this._args))}_getUndoContext(){return null}get canExecute(){return!0}get canUndo(){return!0}},xt=class extends D{_execute(){this._instance.exchangeColumns(this._args[0],this._args[1])}_undo(){this._instance.exchangeColumns(...Oo(...this._args))}_getUndoContext(){return null}get canExecute(){return!0}get canUndo(){return!0}};var yt=class extends D{_undo(){let[t,e=1]=this._args;this._instance.removeColumns(t,t+e-1),this._undoContext.selection&&this._instance.select(this._undoContext.selection,this._undoContext.activeCell)}_execute(){return this._instance.insertColumns(...this._args)}_getUndoContext(){return{selection:this._instance.getSelection(),activeCell:this._instance.activeCell}}get canUndo(){return!0}get canExecute(){return!0}};var vt=class extends D{_undo(){let[t,e=1]=this._args;this._instance.removeRows(t,t+e-1),this._undoContext.selection&&this._instance.select(this._undoContext.selection,this._undoContext.activeCell)}_execute(){return this._instance.insertRows(...this._args)}_getUndoContext(){return{selection:this._instance.getSelection(),activeCell:this._instance.activeCell}}get canUndo(){return!0}get canExecute(){return!0}};var Et=class extends D{_undo(){let[t,e]=this._args;this._instance.splitCells(t,e),this._undoContext.textSnapshot.forEach(({row:r,col:n,text:i})=>{this._instance.setText(r,n,i)})}_execute(){this._instance.mergeCells(...this._args)}_getUndoContext(){let t=new J(this._instance,this._instance),[e,r,n,i]=this._args,l=[];for(let s of t.getSelectionGenerator({top:e,left:r,bottom:n,right:i}))l.push({row:s.row,col:s.col,text:s.text});return{textSnapshot:l}}get canUndo(){return!0}get canExecute(){return!0}};function Do(o,t){let[e,r]=o,n=r-e;return e<t?[[t-n-1,t-1],e]:[[t,t+n],r+1]}var St=class extends D{_execute(){return this._instance.moveRows(this._args[0],this._args[1])}_undo(){this._instance.moveRows(...Do(this._args[0],this._undoContext.targetId))}_getUndoContext(){return{targetId:this._args[1]<this._instance.getRowCount()?this._instance.getStartOfRowId(this._args[1]):this._instance.getRowCount()}}get canExecute(){return!0}get canUndo(){return!0}},Mt=class extends D{_execute(){this._instance.moveColumns(this._args[0],this._args[1])}_undo(){this._instance.moveColumns(...Do(this._args[0],this._undoContext.targetId))}_getUndoContext(){return{targetId:this._args[1]<this._instance.getColCount()?this._instance.getStartOfColumnId(this._args[1]):this._instance.getColCount()}}get canExecute(){return!0}get canUndo(){return!0}};var Gt=class extends D{_undo(){let t=this._args[1]-this._args[0]+1;this._instance.insertColumns(this._args[0],t),this._undoContext.columnList.forEach((e,r)=>{this._instance.setColumnWidth(r+this._args[0],e.width),this._instance.setColumnVisible(r+this._args[0],e.visible)}),this._undoContext.removedCells.forEach(e=>{this._instance.cell(e.row,e.col).cellRenderer=e.cellRenderer,this._instance.setCell(e.row,e.col,e.metaInfo),(e.mergeInfo.rowSpan>1||e.mergeInfo.colSpan>1)&&this._instance.mergeCells(e.row,e.col,e.bottom,e.right)}),this._undoContext.selection&&this._instance.select(this._undoContext.selection,this._undoContext.activeCell?this._instance.cell(this._undoContext.activeCell.row,this._undoContext.activeCell.col):null)}_getUndoContext(){let t=new re(this._instance),[e,r]=this._args;return{removedCells:t.getCellListByColumn(e,r),columnList:t.getColumnListByColumn(e,r),selection:this._instance.getSelection(),activeCell:this._instance.activeCell}}_execute(){return this._instance.removeColumns(...this._args)}get canUndo(){return!0}get canExecute(){return!0}};var Tt=class extends D{_undo(){let t=this._args[1]-this._args[0]+1;this._instance.insertRows(this._args[0],t),this._instance.forceLayoutTask(),this._undoContext.removedRows.forEach(e=>{let r=this._instance.getRow(e.rowId);this._instance.setRowHeight(r.rowId,e.height),this._instance.setRowVisible(r.rowId,e.visible);for(let n=0;n<e.cellCounts;n++){let i=e.getCell(n);r.getCell(n).cellRenderer=i.cellRenderer,this._instance.setCell(r.rowId,n,i.metaInfo),(i.mergeInfo.rowSpan>1||i.mergeInfo.colSpan>1)&&this._instance.mergeCells(i.row,i.col,i.bottom,i.right)}this._undoContext.selection&&this._instance.select(this._undoContext.selection,this._undoContext.activeCell?this._instance.cell(this._undoContext.activeCell.row,this._undoContext.activeCell.col):null)})}_execute(){return this._instance.removeRows(...this._args)}_getUndoContext(){let[t,e]=this._args;return{removedRows:O(t,e+1).map(r=>this._instance.getRow(r)),selection:this._instance.getSelection(),activeCell:this._instance.activeCell}}get canUndo(){return!0}get canExecute(){return!0}};var Lt=class extends D{_undo(){this._instance.setRowVisible(this._args[0],this._undoContext.visible)}_getUndoContext(){return{visible:this._instance.getRowVisible(this._args[0])}}_execute(){return this._instance.setRowVisible(...this._args)}get canUndo(){return!0}get canExecute(){return!0}};var kt=class extends D{_undo(){let[t,e]=this._args;this._instance.mergeCells(t,e,t+this._undoContext.rowSpan-1,e+this._undoContext.colSpan-1)}_execute(){this._instance.splitCells(...this._args)}_getUndoContext(){let t=this._instance.cell(...this._args);return{rowSpan:t.mergeInfo.rowSpan,colSpan:t.mergeInfo.colSpan}}get canUndo(){return!0}get canExecute(){return!0}};var zo={addRow:bt,addColumn:wt,setCell:q,clearCells:Ce,setRowHeight:pe,setColumnWidth:fe,insertRows:vt,insertColumns:yt,setRowVisible:Lt,setColumnVisible:_t,mergeCells:Et,splitCells:kt,removeRows:Tt,removeColumns:Gt,exchangeRows:It,exchangeColumns:xt,moveRows:St,moveColumns:Mt};function Wo(o){if(!(o in zo)){console.warn(`There is no method named ${o} in IRGridCommandMap`);return}return zo[o]}function Di(o){if(o===B.name)return Wo}function zi(o,t,e,r,n){let i=Di(t);if(!i){console.warn("No component class in COMMAND_MAP.");return}let l=i(e);if(!l){console.warn("No command class in COMMAND_MAP.");return}o.pushCommand(new l(r,n))}function $(){return function(t,e,r){let n=r.value;return r.value=function(...i){let{commandManager:l}=this;return l?l.isRecording&&zi(l,this.constructor.name,e,this,i):console.warn("No commandManager in this context"),n.apply(this,i)},r}}var me={grid:jr,gridWrapper:Jr,gridTable:qr,gridVariants:F},Po={},Wi=["text/html","text/plain"],B=class extends cr{constructor(e){var h,m,g,C;super({contextElement:e.contextElement});this._gridContext=new Ye(this);this._gridRangeUtils=new re(this);this._plugins=[];this._readonly=!1;let{contextElement:r,colHeader:n,rowHeader:i,body:l,defaultColumnCellFormat:s,plugins:c}=e;if(this._multipleCellMode=(h=e.multipleCellMode)!=null?h:!1,this._cursorManager=lt(this,!1),this._commandManager=new Wn({context:this}),this._defaultColumnCellFormat={all:{editable:!0,text:""}},this._copyOptions=(m=e.copyOptions)!=null?m:{rowSpan:!0,colSpan:!0},s)for(let[I,w]of Object.entries(s))this._defaultColumnCellFormat[I]=Object.assign(this._defaultColumnCellFormat[I]||{},w);let d=()=>new ce;this._gridStore=new ot(Object.assign({freezedColumnCount:0,freezedRowCount:0,headerColumnCount:(g=i==null?void 0:i.colCount)!=null?g:0,headerRowCount:(C=n==null?void 0:n.rowCount)!=null?C:0})),this.initGridCellPadding(),this._colHeaderInfo=Object.assign({rowCount:0,colCount:5,cellRenderer:d,defaultSize:this._gridStore.getThemeValue("grid.defaultColumnWidth"),minSize:this._gridStore.getThemeValue("grid.defaultColumnMinSize"),maxSize:this._gridStore.getThemeValue("grid.defaultColumnMaxSize")},n),this._colHeaderInfo.minSize=Math.min(this._colHeaderInfo.defaultSize,this._colHeaderInfo.minSize),this._colHeaderInfo.maxSize=Math.max(this._colHeaderInfo.defaultSize,this._colHeaderInfo.maxSize),this._rowHeaderInfo=Object.assign({colCount:0,cellRenderer:d,defaultSize:this._gridStore.getThemeValue("grid.defaultRowHeight"),minSize:this._gridStore.getThemeValue("grid.defaultRowMinSize"),maxSize:this._gridStore.getThemeValue("grid.defaultRowMaxSize")},i),this._rowHeaderInfo.minSize=Math.min(this._rowHeaderInfo.defaultSize,this._rowHeaderInfo.minSize),this._rowHeaderInfo.maxSize=Math.max(this._rowHeaderInfo.defaultSize,this._rowHeaderInfo.maxSize),this._bodyInfo=Object.assign({rowCount:5,colCount:0,cellRenderer:d},l),this.contextElement.classList.add(me.grid,_n),this.contextElement.tabIndex=0,this.contextElement.role="grid",this._tableElement=document.createElement("table"),this._divWrapper=document.createElement("div");let a=document.createElement("tbody");this._divWrapper.className=me.gridWrapper,this._tableElement.classList.add(me.gridTable),this._tableElement.appendChild(this.colManager.colgroup),this._tableElement.appendChild(a),this._divWrapper.appendChild(this._tableElement),this.contextElement.appendChild(this._divWrapper),this.resizeObserver=new ResizeObserver(()=>{this._emitterController.emit("onWrapperResized",{}),this._debounceManager.addTask("virtualRender").addTask("generateScrollBarClass").addTask("updateSelection"),this.onResizeContext()}),this.resizeObserver.observe(this.contextElement),this.initPlugins(c!=null?c:[new Te({}),new Ge,new Le,new Me({enabledColResizer:!0,enabledRowResizer:!0}),new at({memoInterval:500,tooltipInterval:500,hideTooltipWhenHasMemo:!0})]),this.addCoreElement(this._divWrapper),this._emitterController=Ho(this),this._generator=new J(this.rowManager,this.colManager),this._selector=new Rt(this,this._gridContext,this._divWrapper),this._debounceManager=new Qe(this,this._gridContext,this._divWrapper,a,r,this._selector),this._gridContext.selectionRangeState.addSubscription((I,w)=>{(I==null?void 0:I.activeCell)!==(w==null?void 0:w.activeCell)&&(I==null||I.activeCell.deactivate(),w==null||w.activeCell.activate())}),this._gridContext.activateHeaderCellState.addSubscription((I,w)=>{I.forEach(T=>T.deactivate()),w.forEach(T=>T.activate())}),this._gridContext.selectionRangeState.addSubscription((I,w)=>{w?this._gridContext.activateHeaderCellState.next([...this._generator.getSelectionHeaderIterator(w.range)]):this._gridContext.activateHeaderCellState.next([])}),this._gridContext.selectionRangeState.addSubscription((I,w)=>{w?this.onSelectCell(w.activeCell):this.onActiveCellNull()}),this._gridContext.selectionRangeState.addSubscription((I,w)=>{var T;this.onSelectChanged((T=w==null?void 0:w.range)!=null?T:null)}),this._gridContext.gridModeState.addSubscription((I,w)=>{this.contextElement.dataset.mode=w.mode}),this._gridContext.gridModeState.next({mode:"idle",contextParam:{}}),this.initTableRowCol(),this.addGlobalEventListener(this.contextElement,"contextmenu",I=>{I.preventDefault();let{x:w,y:T}=Un(I);this.onContextMenu(I,this.findCellOrNull(T,w))})}get fixedRowCount(){return this._colHeaderInfo.rowCount}get canSelectMultipleCells(){return this._multipleCellMode}get firstRow(){return this.rowManager.firstRow}get lastRow(){return this.rowManager.lastRow}get rowManager(){return this._gridStore.rowManager}get mergeHandler(){return this._gridStore.mergeHandler}get colManager(){return this._gridStore.columnManager}get fixedColumnCount(){return this.colManager.freezedColumns}get width(){return this.colManager.columnsWidth}get height(){return this.rowManager.rowsHeight}get fixedRowHeight(){return this.rowManager.freezedRowsHeight}get fixedColumnWidth(){return this.colManager.fixedColumnsWidth}get scrollArea(){return{scrollTop:this.contextElement.scrollTop,scrollLeft:this.contextElement.scrollLeft,scrollHeight:this.contextElement.scrollHeight,scrollWidth:this.contextElement.scrollWidth}}get scrollTop(){return this.contextElement.scrollTop}get scrollLeft(){return this.contextElement.scrollLeft}get scrollBottom(){return this.contextElement.scrollTop+this.contextElement.clientHeight}get scrollRight(){return this.contextElement.scrollLeft+this.contextElement.clientWidth}get minColWidth(){return this._colHeaderInfo.minSize}get maxColWidth(){return this._colHeaderInfo.maxSize}get minRowHeight(){return this._rowHeaderInfo.minSize}get maxRowHeight(){return this._rowHeaderInfo.maxSize}get commandManager(){return this._commandManager}get headerRows(){return this.rowManager.headerRows}get headerColumns(){return this.colManager.headerColumns}get headerWidth(){return this.colManager.rowHeaderColumnsWidth}get headerHeight(){return this.rowManager.headerRowsHeight}get activeCell(){var e,r;return(r=(e=this._gridContext.selectionRangeState.value)==null?void 0:e.activeCell)!=null?r:null}set activeCell(e){if(e===this.activeCell)return;if(!e){this._gridContext.selectionRangeState.next(null);return}let r=this.getSelection();r?this._gridContext.selectionRangeState.next({activeCell:e,range:r}):this._gridContext.selectionRangeState.next({activeCell:e,range:{top:e.row,left:e.col,bottom:e.bottom,right:e.right}})}set readonly(e){this._readonly=e,this.rowManager.updateCellReadonlyStatus()}addPlugin(e){e.mount({grid:this,table:this._tableElement,contextElement:this.contextElement,emitController:this._emitterController,wrapperElement:this._divWrapper,gridContext:this._gridContext,gridStore:this._gridStore}),this._plugins.push(e)}getColumnByLeft(e){let r=this.colManager.visibleColumnList,n=0,i=r.length-1;for(;n<=i;){let l=n+Math.floor((i-n)/2),s=r[l];if(s.isBetweenLeft(e))return s;e<s.left?i=l-1:n=l+1}return null}setDefaultColumnCellFormat(e,r){this._defaultColumnCellFormat[e]={...r}}getRowByTop(e){return this.rowManager.getRowByTop(e)}removePlugin(e){if(!this._plugins.includes(e))throw new Error("plugin not found");e.unmount(),this._plugins.splice(this._plugins.indexOf(e),1)}getMergeArea(e,r){let n=this.cell(e,r);if(n.mergeInfo)return{rowSpan:n.mergeInfo.rowSpan,colSpan:n.mergeInfo.colSpan};throw new Error("It's not a based cell!")}isMerged(e,r){return this.mergeHandler.isMerged(e,r)}splitCells(e,r){this.forceLayoutTask(),this.mergeHandler.splitCells(e,r),this._debounceManager.addTask("virtualRender")}mergeCells(e,r,n,i){this.forceLayoutTask(),this.mergeHandler.mergeCells({top:e,left:r,bottom:n,right:i}),this._debounceManager.addTask("virtualRender");let l=this.getSelection();l&&this.selectRange(l.top,l.left,l.bottom,l.right)}undo(){this._commandManager.undo()}redo(){this._commandManager.redo()}findRowOrNull(e){let{scrollTop:r}=this,n=e<r+this.fixedRowHeight?{startIndex:0,endIndex:this.fixedRowCount,curIndex:Math.floor(this.fixedRowCount/2),scrollTop:r}:{startIndex:0,endIndex:this.rowManager.length,curIndex:Math.floor(this.rowManager.length/2),scrollTop:0},i=this.rowManager.getRow(n.curIndex);for(;!(e>=n.scrollTop+i.top&&e<=n.scrollTop+i.bottom);){if(e<n.scrollTop+i.top){if(n.endIndex===n.curIndex)return null;n.endIndex=n.curIndex}else{if(n.startIndex===n.curIndex)return null;n.startIndex=n.curIndex}n.curIndex=Math.floor((n.startIndex+n.endIndex)/2),i=this.rowManager.getRow(n.curIndex)}return i}findCellOrNull(e,r){var h;let{scrollTop:n,scrollLeft:i}=this,l=e<n+this.fixedRowHeight?e-n:e,s=r<i+this.fixedColumnWidth?r-i:r,c=this.getRowByTop(l);if(!c)return null;let d=this.getColumnByLeft(s);if(!d)return null;let a=this.cell(c.rowId,d.columnId);return(h=a.mergeMain)!=null?h:a}getBaseCell(e,r){let n=this.cell(e,r);if(n.isMerged)return{row:n.row,col:n.col};if(n.mergeMain)return{row:n.mergeMain.row,col:n.mergeMain.col};throw new Error("It's not a merged cell!")}releaseCells(){this._gridContext.selectionRangeState.next(null),this._selector.releaseRange()}clearRows(){this.rowManager.clearRows(),this._commandManager.clearCommands(),this._debounceManager.addTask("resizeGridWrapperHeight").addTask("generateScrollBarClass").addTask("adjustSelection").addTask("updateSelection")}getColumnLeft(e){return this.colManager.getColumnLeft(e)}select(e,r=this.activeCell){this._gridContext.selectionRangeState.next({range:e,activeCell:r!=null?r:this.cell(e.top,e.left)}),this._debounceManager.addTask("updateSelection")}selectRange(e,r,n,i,l=this.activeCell){this.select({top:e,left:r,bottom:n,right:i},l)}selectAll(){var e;this.selectRange(this.headerRows,this.headerColumns,this.getRowCount()-1,this.getColCount()-1,(e=this.activeCell)!=null?e:null)}getCellWidth(e){if(e.mergeInfo){let{col:r}=e;return O(e.mergeInfo.colSpan).reduce((n,i)=>this.getColumnVisible(r+i)?n+this.getColumnWidth(r+i):n,0)}return this.getColumnWidth(e.col)}getCellHeight(e){if(e.mergeInfo){let{row:r}=e;return O(e.mergeInfo.rowSpan).reduce((n,i)=>this.getRowVisible(r+i)?n+this.getRowHeight(e.row+i):n,0)}return this.getRowHeight(e.col)}getSelection(){var e,r;return(r=(e=this._gridContext.selectionRangeState.value)==null?void 0:e.range)!=null?r:null}scrollOnRow(e){this._debounceManager.isScheduled?this.afterRender(()=>this.scrollOnRowTask(e)):this.scrollOnRowTask(e)}forceLayoutTask(){this._debounceManager.forceRunTasks()}scrollOnCol(e){this._debounceManager.isScheduled?this.afterRender(()=>this.scrollOnColTask(e)):this.scrollOnColTask(e)}getPlugin(e){for(let r of this._plugins)if(r instanceof e)return r;throw new Error(`not found plugin ${e}`)}resetScroll(){this.contextElement.scrollTop=0,this.contextElement.scrollLeft=0}scrollInView(e,r){this.scrollOnRow(e),this.scrollOnCol(r)}focus(){this.contextElement.focus()}afterRender(e){this._debounceManager.addAfterRenderTask(e),this._debounceManager.addTask("nothing")}setText(e,r,n){this.setCell(e,r,{text:n})}getText(e,r){return this.cell(e,r).text}getValue(e,r){return this.cell(e,r).value}getColumnWidth(e){return this.colManager.getColumnWidth(e)}setColumnWidth(e,r){let n=W(r,this._colHeaderInfo.minSize,this._colHeaderInfo.maxSize);this.colManager.setColumnWidth(e,n),this.onResizeColumn(e),this._emitterController.emit("onColumnChanged",{left:e,right:e,type:"setWidth"}),this._debounceManager.addTask("updateLeft").addTask("generateScrollBarClass").addTask("updateSelection"),e<this.colManager.freezedColumns&&this._debounceManager.addTask("updateRowsStickyLeft")}getRowHeight(e){return this.rowManager.getRowHeight(e)}setRowHeight(e,r){let n=W(r,this.minRowHeight,this.maxRowHeight);this.rowManager.setRowHeight(e,n),this._debounceManager.addTask("virtualRender").addTask("updateTop").addTask("resizeGridWrapperHeight").addTask("generateScrollBarClass").addTask("updateSelection")}setRowTextColor(e,r){this.rowManager.getRow(e).textColor=r}getObject(e,r){return this.cell(e,r).object}setObject(e,r,n){this.cell(e,r).cellInfo={object:n}}cell(e,r){return this.rowManager.getCell(e,r)}isBased(e,r){return this.cell(e,r).mergeMain===void 0}getCell(e,r){return this.cell(e,r).metaInfo}getCellMetaInfo(e,r){return this.cell(e,r).metaInfo}setCell(e,r,n){if(typeof n.text=="number"||typeof n.text=="boolean"||typeof n.text=="bigint")n.text=`${n.text}`;else if(n.text===null)n.text="";else if(typeof n.text=="object"||Array.isArray(n.text))throw new Error("Could not set object or array in text property!");this.cell(e,r).cellInfo=n}setRowInfo(e,r){this.getRow(e).setRowInfo(r)}selectCell(e,r){this.selectRange(e,r,e,r,this.cell(e,r))}getRowCount(){return this.rowManager.length}getColCount(){return this.colManager.length}getLastRow(){return this.getRow(this.getRowCount()-1)}getFreezedRowCount(){return this.rowManager.freezedRows}getFreezedColumnCount(){return this.colManager.freezedColumns}getColumn(e){return this.colManager.getColumn(e)}getRow(e){return this.rowManager.getRow(e)}renderColumn(e){this.renderColumns(e,e)}renderColumns(e,r){this.rowManager.runFuncEachRow(n=>n.renderColumns(e,r))}_addRow(e=this._rowHeaderInfo.defaultSize){let r=W(e,this.minRowHeight,this.maxRowHeight),n=this.createIRGridRow(this.rowManager.getNextRowId(),this.height,r);return this.rowManager.addRow(n),n.rowId}_createBulkRows(e,r){for(let n=0;n<e;n++)this._addRow(r);this._debounceManager.scheduleAddRowTasks()}addRow(e){return this._debounceManager.scheduleAddRowTasks(),this._addRow(e)}removeRow(e){return this.removeRows(e,e)}removeColumn(e){return this.removeColumns(e,e)}removeRows(e,r){if(e<this.headerRows)throw new Error("Could not remove rows in header rows!");if(r>=this.getRowCount())throw new Error(`Out of index. maximum bottom values is ${this.getRowCount()-1}. If you wanna clear all rows, please call clearRows()`);if(this.mergeHandler.checkConflictingInRows(e,r))return!1;for(let n=e;n<=r;n++){let i=this.getRow(n);for(let l of i.getCellGenerator())l.isMerged&&this.mergeHandler.removeMergeCell(l.row,l.col)}return this.rowManager.removeRows(e,r),this._debounceManager.addTask("updateTop").addTask("updateRowId").addTask("virtualRender").addTask("resizeGridWrapperHeight").addTask("generateScrollBarClass").addTask("adjustSelection"),!0}removeColumns(e,r){if(e<this.headerColumns)throw new Error(`the removing column left must be greater than or equal to rowHeaderColumn! (>= ${this.headerColumns})`);if(r>=this.getColCount())throw new Error(`out of index. maximum bottom value must be ${this.getColCount()-1}`);return this.mergeHandler.checkConflictingInColumns(e,r)?!1:(this.rowManager.runFuncEachRow(n=>{for(let i of n.getCellGenerator(e,r))i.isMerged&&this.mergeHandler.removeMergeCell(i.row,i.col)}),this.rowManager.removeColumns(e,r),this.colManager.removeColumns(e,r),this._emitterController.emit("onColumnChanged",{left:e,right:r,type:"removeColumns"}),this._debounceManager.addTask("updateColumnId").addTask("updateLeft").addTask("generateScrollBarClass").addTask("adjustSelection"),e<this.colManager.freezedColumns&&this._debounceManager.addTask("updateRowsStickyLeft"),!0)}_addColumn(e=this._colHeaderInfo.defaultSize){let r=W(e,this.minColWidth,this.maxColWidth),n=this.colManager.addColumn(r);return this.rowManager.addColumn(i=>this.createIRGridCell(i.rowId,n.columnId)),this._emitterController.emit("onColumnChanged",{left:n.columnId,right:n.columnId,type:"addColumn"}),n.columnId}addColumn(e){return this._debounceManager.addTask("generateScrollBarClass"),this._addColumn(e)}insertRow(e,r){return this.insertRows(e,1,r)}insertRows(e,r=1,n=this._rowHeaderInfo.defaultSize){let i=this.getRowCount(),l=W(e,this.headerRows,i);if(!this.mergeHandler.checkCanInsertRow(l))return!1;let s=W(n,this.minRowHeight,this.maxRowHeight);if(l===i){for(let d=0;d<r;d++)this.addRow(s);return!0}let c=O(r).map(d=>this.createIRGridRow(l+d,0,s));return this.rowManager.insertRows(l,c),this._debounceManager.addTask("updateTop").addTask("updateRowId").addTask("virtualRender").addTask("generateScrollBarClass").addTask("resizeGridWrapperHeight").addTask("adjustSelection"),!0}insertColumn(e,r){return this.insertColumns(e,1,r)}insertColumns(e,r=1,n=this._colHeaderInfo.defaultSize){let i=this.getColCount(),l=W(e,this.headerColumns,i);if(!this.mergeHandler.checkCanInsertColumn(e))return!1;let s=W(n,this.minColWidth,this.maxColWidth);if(l===i){for(let d=0;d<r;d++)this.addColumn(s);return!0}this.colManager.insertColumns(e,r,s),this.rowManager.insertColumns(e,r,(d,a)=>this.createIRGridCell(d,a));let c=this._debounceManager.addTask("updateColumnId").addTask("generateScrollBarClass").addTask("updateLeft").addTask("adjustSelection");return e<this.colManager.freezedColumns&&c.addTask("updateRowsStickyLeft"),!0}autoSizeColumn(e){this.autoSizeColumns(e,e)}autoSizeColumns(e,r){O(e,r+1).forEach(n=>{let i=Math.ceil(this._gridStore.rowManager.getMaxCellWidth(n,n+1));i!==this.getColumnWidth(n)&&this.setColumnWidth(n,W(i,this._colHeaderInfo.minSize,this._colHeaderInfo.maxSize))})}autoSizeRow(e){this.autoSizeRows(e,e)}autoSizeRows(e,r){O(e,r+1).forEach(n=>{let i=this.rowManager.getRow(n).rowInnerHeight;i!==this.getRowHeight(n)&&this.setRowHeight(n,i)})}copyToClipboard(){if(!this.getSelection()){console.warn("No selection detected.");return}this.focus(),document.execCommand("copy")}_hasToSplitBeforePasting(e){return!this._copyOptions.rowSpan&&!this._copyOptions.colSpan?!1:e.flat().some(r=>r.rowSpan>1||r.colSpan>1)}async _createClipboardGetter(){var r;let e={"ir-grid/cell":"","text/html":"","text/plain":""};try{let n=(await Ln.read()).flat();for await(let i of n)for(let l of Wi)e[l]===""&&i.types.includes(l)&&(e[l]=await Gn(await i.getType(l)))}catch(n){console.warn("pasteFromClipboard warning! it expects https protocol and clipboard permission.",n),e["ir-grid/cell"]=(r=jn(Po))!=null?r:""}return{getData(n){var i;return(i=e[n])!=null?i:""}}}async pasteFromClipboard(){let e=this.getSelection();if(!e){console.warn("no selection, it needs selection to paste");return}this.paste(e,Jt(await this._createClipboardGetter()))}paste(e,r){if(r.length===0){console.warn("No clipboard data to paste");return}let n=Qn(this,this._copyOptions),i=n.getPastingRange(e,r);this._hasToSplitBeforePasting(r)&&this.splitCellsByRange(i);let l=n.beforePastingList(i,r);l.length!==0&&(this.onClipboardBeforePaste(i),n.pasteTask(l),this.onClipboardAfterPaste(i),this.select(i))}hasRow(e){return e<this.getRowCount()}hasColumn(e){return e<this.getColCount()}clearCells(e){for(let r of this._generator.getSelectionGenerator(e))this.onClearCellCheck(r)&&r.clear()}setRowVisible(e,r){return this.mergeHandler.checkConflictingInRows(e,e)?!1:(r===this.getRowVisible(e)||(this.rowManager.setRowVisible(e,r),this._debounceManager.addTask("updateTop").addTask("virtualRender").addTask("resizeGridWrapperHeight").addTask("generateScrollBarClass").addTask("updateSelection")),!0)}getRowVisible(e){return this.rowManager.getRowVisible(e)}setColumnVisible(e,r){return this.mergeHandler.checkConflictingInColumns(e,e)?!1:(r===this.getColumnVisible(e)||(this.colManager.setColumnVisible(e,r),this.rowManager.setColumnVisible(e,r),this._debounceManager.addTask("updateLeft").addTask("generateScrollBarClass").addTask("updateSelection"),e<this.colManager.freezedColumns&&this._debounceManager.addTask("updateRowsStickyLeft"),this._emitterController.emit("onColumnChanged",{left:e,right:e,type:"setVisible"})),!0)}getColumnVisible(e){return this.colManager.getColumnVisible(e)}createFinder(e={}){return Ao(this,e)}selectColumn(e){this.selectColumns(e,e)}selectColumns(e,r){e<this.headerColumns||this.headerRows<this.getRowCount()&&this.selectRange(this.headerRows,e,this.getRowCount()-1,r,this.cell(this.headerRows,e))}selectRow(e,r=this.activeCell){this.selectRows(e,e,r)}selectRows(e,r,n=this.activeCell){e<this.headerRows||this.selectRange(e,this.headerColumns,r,this.getColCount()-1,n!=null?n:this.cell(e,this.headerColumns))}freezeRows(e){this.rowManager.freezeRows(e),this._debounceManager.addTask("updateSelection")}freezeColumns(e){this.freezeColumn(e+1-this.headerColumns),this._debounceManager.addTask("updateSelection")}freezeColumn(e){if(e<0)throw new Error("Could not be freezing minus columns!");if(e>this.getColCount()-this.headerColumns)throw new Error("Could not be freezing after last column");this.colManager.freezeColumns(e),this._debounceManager.addTask("updateSelection").addTask("updateRowsStickyLeft")}clearUndoStack(){this.commandManager.clearCommands()}setClipboardOptions(e){Object.assign(this._copyOptions,e)}sort(e,r,n,i){let l=Math.max(n!=null?n:this.headerRows,this.headerRows),s=Math.min(i!=null?i:this.getRowCount(),this.getRowCount());this.rowManager.sort(e,r,l,s),this._debounceManager.addTask("updateTop").addTask("updateRowId").addTask("virtualRender").addTask("adjustSelection")}splitCellsByRange(e){for(let r of this._generator.getSelectionGenerator(e)){let n=r.mergeInfo.rowSpan>1||r.mergeInfo.colSpan>1?r:r.mergeMain;n&&this.splitCells(n.row,n.col)}}selectMultipleCellAddress(e){e.length>0&&this.selectCell(e[0][0],e[0][1])}selectMultipleCells(e){e.length>0&&this.selectCell(e[0].row,e[0].col)}getSelectionMode(){return"range"}getSelectedCells(){let e=this.getSelection();return e?[this.cell(e.top,e.left)]:[]}exchangeRow(e,r){this.exchangeRows([e,e],[r,r])}exchangeRows(e,r){if(e.some(n=>this.rowManager.isInvalidRowId(n))||r.some(n=>this.rowManager.isInvalidRowId(n)))throw new Error("The range is out of bounds for rows!");if(e.some(n=>n<this.getFreezedRowCount())||r.some(n=>n<this.getFreezedRowCount()))throw new Error("Freezed(header) row cannot be exchanged!");if(this.mergeHandler.checkConflictingInRows(...e)||this.mergeHandler.checkConflictingInRows(...r))throw new Error("Exchange is not allowed in merged cells!");this.rowManager.exchangeRows(e,r),this.onExchangedRows(e,r),this._debounceManager.addTask("updateTop").addTask("updateRowId").addTask("virtualRender").addTask("adjustSelection")}exchangeColumn(e,r){this.exchangeColumns([e,e],[r,r])}exchangeColumns(e,r){if(e.some(n=>this.colManager.isInvalidColumnId(n))||r.some(n=>this.colManager.isInvalidColumnId(n)))throw new Error("The range is out of bounds for columns!");if(e.some(n=>n<this.getFreezedColumnCount())||r.some(n=>n<this.getFreezedColumnCount()))throw new Error("Freezed(header) column cannot be exchanged!");if(this.mergeHandler.checkConflictingInColumns(...e)||this.mergeHandler.checkConflictingInColumns(...r))throw new Error("Exchange is not allowed in merged cells!");this.rowManager.runFuncEachRow(n=>n.exchangeCells(e,r)),this.onExchangedColumns(e,r),this._debounceManager.addTask("adjustSelection")}moveRow(e,r){this.moveRows([e,e],r)}moveRows(e,r){if(e.some(i=>this.rowManager.isInvalidRowId(i)))throw new Error("The range is out of bounds for rows!");if(e.some(i=>i<this.getFreezedRowCount()))throw new Error("Freezed(header) row cannot be Moved!");if(this.mergeHandler.checkConflictingInRows(...e))throw new Error("Move is not allowed in merged cells!");let n=this.rowManager.getAdjustTargetRow(r);this.rowManager.moveRows(e,n),this.onMovedRows(e,n),this._debounceManager.addTask("updateTop").addTask("updateRowId").addTask("virtualRender").addTask("adjustSelection")}moveColumn(e,r){this.moveColumns([e,e],r)}moveColumns(e,r){if(e.some(i=>this.rowManager.isInvalidRowId(i)))throw new Error("The range is out of bounds for columns!");if(e.some(i=>i<this.getFreezedRowCount()))throw new Error("Freezed(header) column cannot be Moved!");if(this.mergeHandler.checkConflictingInColumns(...e))throw new Error("Move is not allowed in merged cells!");let n=this.getAdjustTargetColumn(r);this.rowManager.runFuncEachRow(i=>i.moveCells(e,n)),this.onMovedColumns(e,n),this._debounceManager.addTask("adjustSelection")}getStartOfRowId(e){return this.rowManager.getStartOfRowId(e)}getStartOfColumnId(e){return this.rowManager.getStartOfColumnId(e)}getSelectedMultipleCellAddress(){let e=this.getSelection();return e?[[e.top,e.left]]:[]}isSelectedSingleCell(){let e=this.getSelection();if(!e)return!1;let{top:r,left:n,bottom:i,right:l}=e;if(r===i&&n===l)return!0;let s=this.getRow(r).getCell(n);return i===s.bottom&&l===s.right}render(){this.rowManager.renderRows()}onSelectCell(e){}onActiveCellNull(){}onResizeContext(){}onResizeColumn(e){}onEditCellDone(e,r,n,i,l,s){}onSelectChanged(e){}onClearCell(e){}onClearCellCheck(e){return e.canClear}onColumnClick(e){}onRowClick(e){}onCreatingCell(e){}onCellRightClick(e,r){}onEditKeyDown(e,r,n,i){}onMountedRow(e){}onClipboardBeforePasteCell(e,r){return!0}onClipboardBeforePaste(e){}onClipboardAfterPasteCell(e){}onClipboardAfterPaste(e){}onAutoInsertRow(e){return!0}onAutoInsertColumn(e){return!0}onDoubleClickCell(e){}onDropOnCell(e,r,n){}onDragStartCell(e,r){return!r.dataTransfer||!e.metaInfo.object?!1:(r.dataTransfer.setData("application/json",JSON.stringify(e.metaInfo.object)),!0)}onCheckPasteCell(e,r){return e.visible&&e.onCheckReadonly()!==!0&&e.metaInfo.disabled!==!0&&e.metaInfo.clipboardEnabled!==!1&&this.onClipboardBeforePasteCell(e,r)}onUndo(e){}onRedo(e){}onNativeCopy(e){if(!e.clipboardData)throw new Error("Invalid ClipboardEvent");let r=this.getSelection();if(!r)throw new Error("Detected copy without selection");let i=this._gridRangeUtils.getCellMatrixByRange(r).map(l=>l.map(s=>({text:this.onCopyCellText(s),cellVisible:s.mergeMain===void 0,rowSpan:s.mergeInfo.rowSpan,colSpan:s.mergeInfo.colSpan,isFormatted:!1})));uo(e.clipboardData,i),Pn(Po,JSON.stringify(i)),this.focus(),this.onCopy(),e.preventDefault()}onCopyCellText(e){return e.text}onNativeCut(e){let r=this.getSelection();if(!r)throw new Error("Detected copy without selection");this.onNativeCopy(e),this.commandManager.doRecording("Cut",()=>{this.clearCells(r)}),e.preventDefault()}onNativePaste(e){if(!e.clipboardData)throw new Error("Invalid ClipboardEvent");let r=this.getSelection();if(!r)throw new Error("it needs selection to paste");let n=Jt(e.clipboardData);this.commandManager.doRecording("Paste",()=>{this.paste(r,n)}),e.preventDefault()}onExchangedRows(e,r){}onExchangedColumns(e,r){}onMovedRows(e,r){}onMovedColumns(e,r){}doEditMode(e,r=!1){if(!e.element.isConnected||!e.editable)return!1;let n=new dt(e);n.onEditDone=(i,l,s,c,d,a)=>{this.onEditCellDone(i,l,s,c,d,a),this.focus(),this._gridContext.gridModeState.value.mode==="edit-cell"&&this._gridContext.setIdle()},n.onEditKeyDown=(i,l,s,c)=>this.onEditKeyDown(i,l,s,c),n.onMoveLeftOnEdit=()=>this._cursorManager.selectNextSelection(0,-1,!1),n.onMoveUpOnEdit=()=>this._cursorManager.selectNextSelection(-1,0,!1),n.onMoveRightOnEdit=()=>this._cursorManager.selectNextSelection(0,1,!1),n.onMoveDownOnEdit=()=>this._cursorManager.selectNextSelection(1,0,!1),n.onTabOnEdit=(i,l)=>{l?this._cursorManager.selectBeforeActiveCell():this._cursorManager.selectNextActiveCell()},n.onEnterOnEdit=()=>{let i=this._cursorManager.getNextYBelow(e.row,e.col,1);e.row!==i&&(this.selectCell(i,e.col),this.doEditMode(this.cell(i,e.col)))};try{return this._gridContext.gridModeState.next({mode:"edit-cell",contextParam:{cell:e}}),n.runEditMode(r),!0}catch(i){return console.error("IRGrid.doEditMode Error!",i),!1}}onCopy(){}onContextMenu(e,r){}onDragOverCell(e,r){return!0}getAdjustTargetColumn(e){return e>=this.colManager.length?this.colManager.length:e<this.colManager.freezedColumns?this.colManager.freezedColumns:this.rowManager.getStartOfColumnId(e)}scrollOnColTask(e){let r=W(e,0,this.getColCount()-1),n=this.getColumnLeft(r),i=n+this.getColumnWidth(r),{fixedColumnWidth:l,scrollRight:s,scrollLeft:c}=this,d=c+l;s<i?this.contextElement.scrollLeft=c+(i-s):d>n&&(this.contextElement.scrollLeft=n-l)}scrollOnRowTask(e){let r=W(e,0,this.getRowCount()-1),n=this.getRow(r),i=n.top,l=n.top+n.height,{scrollBottom:s,fixedRowHeight:c,scrollTop:d}=this,a=d+c;s<l?this.contextElement.scrollTop=d+(l-s):a>i&&(this.contextElement.scrollTop=i-c)}onCheckCellReadonly(e){return this._readonly?!0:e.metaInfo.readonly===!0}initPlugins(e){try{for(let r of e)this.addPlugin(r)}catch(r){console.error("Plugin init error",r)}}initTableRowCol(){O(this._colHeaderInfo.colCount).forEach(()=>this.addColumn(this._colHeaderInfo.defaultSize)),this._createBulkRows(this._colHeaderInfo.rowCount+this._bodyInfo.rowCount)}initColumnHeaderCell(e){e.cellType="col-header",e.onClick=()=>{this.contextElement.classList.contains("is-resizing")||this.onColumnClick(e)}}initRowHeaderCell(e){e.cellType="row-header",e.onClick=()=>{this.contextElement.classList.contains("is-resizing")||this.onRowClick(e)}}initBodyCell(e){e.cellType="body-cell",e.onClear=()=>this.onClearCell(e),e.onDblClick=()=>this.onDoubleClickCell(e)}initGridCellPadding(){Y(this.contextElement,{[me.gridVariants.cellTopPadding]:`${this._gridStore.getThemeValue("grid.paddingTop")}px`,[me.gridVariants.cellLeftPadding]:`${this._gridStore.getThemeValue("grid.paddingLeft")}px`,[me.gridVariants.cellBottomPadding]:`${this._gridStore.getThemeValue("grid.paddingBottom")}px`,[me.gridVariants.cellRightPadding]:`${this._gridStore.getThemeValue("grid.paddingRight")}px`})}getCellRenderer(e,r,n,i){if(e==="col-header")return this._colHeaderInfo.cellRenderer;if(e==="row-header")return this._rowHeaderInfo.cellRenderer;if(e==="body-cell")return this._bodyInfo.cellRenderer;throw new Error("cellType must be 'col-header' or 'row-header' or 'body-cell'")}getCellType(e,r){let n=e<this.headerRows,i=!n&&r<this.headerColumns;return n?"col-header":i?"row-header":"body-cell"}getDefaultCellFormat(e,r){let n={emitter:this._emitterController.emitter,commandManager:this,getGridStore:()=>this._gridStore};return Object.assign(n,{...this._defaultColumnCellFormat.all,...this._defaultColumnCellFormat[r]}),e==="col-header"?Object.assign(n,this._defaultColumnCellFormat[`col_header_${r}`]):e==="row-header"?Object.assign(n,this._defaultColumnCellFormat[`row_header_${r}`]):Object.assign(n,this._defaultColumnCellFormat[`body_${r}`]),n}createIRGridCell(e,r){let n=this.getCellType(e,r),i=n.endsWith("header")?"th":"td",l=this.getDefaultCellFormat(n,r),s=this.getCellRenderer(n,e,r,l),c=new qe({row:e,col:r,tag:i,cellRenderer:s,metaInfo:l});return c.onRightClick=(d,a)=>this.onCellRightClick(d,a),c.onCheckReadonly=()=>this.onCheckCellReadonly(c),n==="col-header"?this.initColumnHeaderCell(c):n==="row-header"?this.initRowHeaderCell(c):this.initBodyCell(c),this.onCreatingCell(c),c}createIRGridRow(e,r,n){let i=new et({grid:this,rowId:e,height:n,top:r,rowType:e<this.headerRows?"header":"body"});return O(this.getColCount()).forEach(l=>{i.addCell(this.createIRGridCell(e,l)),!this.getColumnVisible(l)&&i.setColumnVisible(l,!1)}),i.onMounted=()=>{i.freezeColumns(this._rowHeaderInfo.colCount),this.onMountedRow(i.rowId)},i.onChangedHeight=()=>{O(this.getColCount()).forEach(l=>{let s=i.getCell(l),c=s.mergeMain?s.mergeMain:s.mergeInfo.rowSpan>1?s:null;c&&(c.height=this.mergeHandler.getMergedRowHeight(c.row,c.row+c.mergeInfo.rowSpan-1))})},i}};U([$()],B.prototype,"splitCells",1),U([$()],B.prototype,"mergeCells",1),U([$()],B.prototype,"setColumnWidth",1),U([$()],B.prototype,"setRowHeight",1),U([$()],B.prototype,"setCell",1),U([$()],B.prototype,"addRow",1),U([$()],B.prototype,"removeRows",1),U([$()],B.prototype,"removeColumns",1),U([$()],B.prototype,"addColumn",1),U([$()],B.prototype,"insertRows",1),U([$()],B.prototype,"insertColumns",1),U([$()],B.prototype,"clearCells",1),U([$()],B.prototype,"setRowVisible",1),U([$()],B.prototype,"setColumnVisible",1),U([$()],B.prototype,"exchangeRows",1),U([$()],B.prototype,"exchangeColumns",1),U([$()],B.prototype,"moveRows",1),U([$()],B.prototype,"moveColumns",1);var jo=o=>o===""||!o?-Number.MAX_SAFE_INTEGER:parseInt(o,10),Rm=o=>{let t=new Set,e=null,r=!0;return{get enabledColumnClick(){return r},set enabledColumnClick(n){r=n},clearNumberColumns(){t.clear()},clearSortOrder(){e&&(e.cellInfo={sortOrder:void 0}),e=null},removeNumberColumns(...n){n.forEach(i=>t.delete(i))},setNumberColumns(...n){n.forEach(i=>t.add(i))},compareTo(n,i){let l=t.has(n.col)?jo(n.text):n.text,s=t.has(i.col)?jo(i.text):i.text;return l<s?-1:l>s?1:0},overrideColumnClickEvent(){console.debug(`Overrode IRGrid Column Sort Manager target-uuid::${o.uuid}`),o.onColumnClick=n=>{r&&this.toggleSortColumn(n)}},sortColumn(n,i){o.sort((l,s)=>this.compareTo(l.getCell(n),s.getCell(n)),i)},toggleSortColumn(n){if(n.cellType!=="col-header")throw new Error("Can only execute in col-header");let i=n.cellInfo.sortOrder==="ASC"?"DESC":"ASC";e!==n&&this.clearSortOrder(),e=n,n.cellInfo={sortOrder:i},this.sortColumn(n.col,i)}}};var Pi=/^[0-9]*(\.[0-9]+)?$/,ji=o=>o.text===""?!0:Pi.test(o.text),Fi=o=>(t,e)=>{let r=t.getCell(o).text,n=e.getCell(o).text,i=r===""?Number.MIN_VALUE:parseFloat(r),l=n===""?Number.MIN_VALUE:parseFloat(n);return i<l?-1:1},Bi=o=>(t,e)=>t.getCell(o).text<e.getCell(o).text?-1:1,bm=({grid:o,onNumberCheck:t=ji})=>({sortColumn(e,r,n,i){(()=>{for(let s=n;s<i;s++){let c=o.getRow(s).getCell(e);if(t(c))return!1}return!0})()?o.sort(Bi(e),r,n,i):o.sort(Fi(e),r,n,i)}});var Im=/^-?(\d{1,3}([,]\d{3})*|\d+)(\.\d+)?$/,xm=/^-?\d+(\.\d+)?$/;export{Im as ALLOW_ONLY_CURRENCY_NUMBER_PATTERN,xm as ALLOW_ONLY_NUMBER_PATTERN,Ld as CellDropPlugin,Sd as CellObserverPlugin,xd as ColumnFillPlugin,md as DefaultKeyPlugin,B as IRGrid,Kt as IRGridButtonRenderer,Le as IRGridCellDropPlugin,rr as IRGridCellObserverPlugin,V as IRGridCellRenderer,Bt as IRGridCheckboxRenderer,tr as IRGridColumnFillPlugin,Ut as IRGridDatePickerRenderer,Zt as IRGridDefaultCellIconButtonRenderer,ce as IRGridDefaultCellRenderer,Te as IRGridDefaultKeyPlugin,Io as IRGridExchangeByHeaderCellPlugin,Ge as IRGridMouseCellSelectorPlugin,Mo as IRGridMoveColumnsPlugin,Eo as IRGridMoveRowsPlugin,at as IRGridPopoverPlugin,$t as IRGridProgressRenderer,Xt as IRGridRadioCellRenderer,Me as IRGridResizerPlugin,Yt as IRGridRowNoHeaderCellRenderer,Qt as IRGridRowSelectionPlugin,Vt as IRGridSelectCellRenderer,nr as IRGridSingleCellDragPlugin,Ya as MouseCellSelectorPlugin,Va as ResizerPlugin,Rd as RowSelectionPlugin,zd as SingleCellDragPlugin,di as createCellContent,ci as createCellContentWithIconButton,Jn as createCustomRenderer,Rm as createIRGridColumnSortManager,bm as createInferenceSortHandler,Nl as renderGridButton,ts as renderGridCellDefault,rs as renderGridCellIconButton,al as renderGridCheckbox,kl as renderGridDatePicker,Wl as renderGridProgress,ql as renderGridRadio,_l as renderGridSelect,ns as renderRowNoHeaderCell};
